import{f as R,b as F,u as U,r,t as z,j as a,m as u,E as P,M as G}from"./index-b4683d61.js";import{q as H,o as J,p as V}from"./paper-7f0d6524.js";import{B as W}from"./index-5f967da4.js";import{P as f}from"./index-573a6ce5.js";import{Q as X}from"./index-68c2beeb.js";import{T as Y}from"./Table-76e623b5.js";import"./LeftOutlined-9e6e73a2.js";import"./addEventListener-a27ae3f4.js";import"./useIcons-e0af7133.js";import"./CheckOutlined-e6bc730e.js";import"./Pagination-d2c763c6.js";import"./useForceUpdate-f2aff5e0.js";import"./responsiveObserver-dc429d3b.js";import"./index-c09cc6d7.js";import"./index-10f1a096.js";import"./iconUtil-f3f90360.js";const{confirm:_}=G,me=()=>{const d=new URLSearchParams(R().search),v=F(),A=U(),[l,n]=r.useState(!1),[i,m]=r.useState({}),[p,T]=r.useState(!1),[w,D]=r.useState(0),[o,B]=r.useState(Number(d.get("id"))),[x,h]=r.useState([]),[j,g]=r.useState([]),[b,S]=r.useState([]),[k,q]=r.useState([]),[y,C]=r.useState([]),[N,O]=r.useState([]);r.useEffect(()=>{document.title="组卷",A(z("组卷"))},[]),r.useEffect(()=>{B(Number(d.get("id")))},[d.get("id")]),r.useEffect(()=>{L()},[o,p]),r.useEffect(()=>{let t=0;for(let e in i){let s=i[e];for(let c=0;c<s.length;c++)t+=s[c].score}D(t)},[i]);const L=()=>{l||(n(!0),H(o,{id:o}).then(t=>{let e=t.data.questions,s={};e.单选题&&Object.assign(s,{单选题:e.单选题}),e.多选题&&Object.assign(s,{多选题:e.多选题}),e.判断题&&Object.assign(s,{判断题:e.判断题}),e.填空题&&Object.assign(s,{填空题:e.填空题}),e.问答题&&Object.assign(s,{问答题:e.问答题}),e.题帽题&&Object.assign(s,{题帽题:e.题帽题}),m(s),n(!1)}).catch(t=>{n(!1)}))},M=[{title:"试题ID",width:120,render:(t,e)=>a.jsx("span",{children:e.id})},{title:"分数",width:150,render:(t,e)=>a.jsxs("span",{children:[e.score,"分"]})},{title:"类型",width:200,render:(t,e)=>a.jsx("span",{children:e.type_text})},{title:"难度",width:200,render:(t,e)=>a.jsx("span",{children:e.level_text})},{title:"内容",render:(t,e)=>a.jsx(X,{question:e})},{title:"操作",width:100,fixed:"right",render:(t,e)=>a.jsx(f,{type:"link",text:"删除",class:"c-red",icon:null,p:"addons.Paper.paper.questions.delete",onClick:()=>{I(e.id)},disabled:null})}],Q=()=>{let t=[...x,...j,...b,...k,...y,...N];if(t.length===0){u.error("请选择需要操作的数据");return}_({title:"操作确认",icon:a.jsx(P,{}),content:"确认删除选中的试题？",centered:!0,okText:"确认",cancelText:"取消",onOk(){l||(n(!0),J(o,{ids:t}).then(()=>{n(!1),u.success("成功"),E()}).catch(e=>{n(!1)}))},onCancel(){console.log("Cancel")}})},I=t=>{_({title:"操作确认",icon:a.jsx(P,{}),content:"确认删除此试题？",centered:!0,okText:"确认",cancelText:"取消",onOk(){l||(n(!0),V(o,t).then(()=>{n(!1),u.success("成功"),E()}).catch(e=>{n(!1)}))},onCancel(){console.log("Cancel")}})},E=()=>{m([]),h([]),g([]),S([]),q([]),C([]),O([]),T(!p)};return a.jsxs("div",{className:"meedu-main-body",children:[a.jsx(W,{title:"组卷"}),a.jsxs("div",{className:"float-left mb-30 mt-30",children:[a.jsx(f,{type:"primary",text:"新建试题",class:"",icon:null,p:"addons.Paper.paper.questions.add",onClick:()=>v("/exam/paper/questionadd?id="+o),disabled:null}),a.jsx(f,{type:"danger",text:"批量删除",class:"ml-10",icon:null,p:"addons.Paper.paper.questions.delete.batch",onClick:()=>Q(),disabled:null})]}),a.jsx("div",{className:"float-left mb-30",children:a.jsxs("h2",{children:[w,"分"]})}),a.jsx("div",{className:"float-left",children:Object.keys(i).map((t,e)=>a.jsxs("div",{className:"float-left mb-30",children:[a.jsxs("div",{className:"float-left mb-10 question-helper-text",children:[t," (共",i[t].length,"题)"]}),a.jsx(Y,{rowSelection:{type:"checkbox",selectedRowKeys:e===0?x:e===1?j:e===2?b:e===3?k:e===4?y:N,onChange:(s,c)=>{e===0?h(s):e===1?g(s):e===2?S(s):e===3?q(s):e===4?C(s):e===5&&O(s)}},loading:l,columns:M,dataSource:i[t],rowKey:s=>s.id,pagination:!1})]},e))})]})};export{me as default};
