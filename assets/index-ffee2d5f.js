import{u as F,b as K,r as a,t as M,j as e,B as p,I as O,S,D as R,e as A,E as $,m as G,M as H}from"./index-3fd54424.js";import{l as J,f as Q,g as U}from"./paper-57a0cabd.js";import{P as o}from"./index-df05a090.js";import{S as V}from"./index-ff4e3b6e.js";import{T as W}from"./Table-59a53b18.js";import"./useIcons-235bc0cd.js";import"./CheckOutlined-44e74bd9.js";import"./addEventListener-1752243f.js";import"./Pagination-a2ebdf00.js";import"./LeftOutlined-a0f8cfa6.js";import"./useForceUpdate-56773729.js";import"./responsiveObserver-a0dea2e5.js";import"./index-a56efb1a.js";import"./iconUtil-14ff0944.js";const{confirm:X}=H,me=()=>{const P=F(),r=K(),[m,n]=a.useState(!1),[b,u]=a.useState([]),[x,c]=a.useState(1),[h,f]=a.useState(20),[v,w]=a.useState(0),[d,g]=a.useState(!1),[j,y]=a.useState(""),[C,k]=a.useState([]),[N,_]=a.useState([]);a.useEffect(()=>{document.title="试卷",P(M("试卷")),E()},[]),a.useEffect(()=>{D()},[x,h,d]);const D=()=>{m||(n(!0),J({page:x,size:h,sort:"id",order:"desc",keywords:j,category_id:C}).then(s=>{u(s.data.data.data),w(s.data.data.total),n(!1)}).catch(s=>{n(!1)}))},E=()=>{Q().then(s=>{let t=s.data.categories;const l=[];for(let i=0;i<t.length;i++)l.push({label:t[i].name,value:t[i].id});_(l)})},z=()=>{c(1),f(20),u([]),y(""),k([]),g(!d)},T={current:x,pageSize:h,total:v,onChange:(s,t)=>L(s,t),showSizeChanger:!0},L=(s,t)=>{c(s),f(t)},B=[{title:"分类",width:200,render:(s,t)=>{var l;return e.jsx("span",{children:((l=t==null?void 0:t.category)==null?void 0:l.name)||"-"})}},{title:"标题",width:500,render:(s,t)=>e.jsx("span",{children:t.title})},{title:"分数",width:150,render:(s,t)=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["总分：",t.score,"分"]}),e.jsxs("div",{className:"c-red",children:["及格：",t.pass_score,"分"]})]})},{title:"时长",render:(s,t)=>e.jsxs("span",{children:[t.expired_minutes,"m"]})},{title:"操作",width:160,fixed:"right",render:(s,t)=>{const l=[{key:"1",label:e.jsx(o,{type:"link",text:"编辑",class:"c-primary",icon:null,p:"addons.Paper.paper.update",onClick:()=>{r("/exam/paper/update?id="+t.id)},disabled:null})},{key:"2",label:e.jsx(o,{type:"link",text:"删除",class:"c-red",icon:null,p:"addons.Paper.paper.delete",onClick:()=>{q(t.id)},disabled:null})}];return e.jsxs(S,{children:[e.jsx(o,{type:"link",text:"组卷",class:"c-primary",icon:null,p:"addons.Paper.paper.questions.list",onClick:()=>{r("/exam/paper/question?id="+t.id)},disabled:null}),e.jsx(o,{type:"link",text:"学员",class:"c-primary",icon:null,p:["addons.Paper.paper.userPaper","addons.Paper.paper.statistics","addons.Paper.paper.users"],onClick:()=>{r("/exam/paper/user?id="+t.id)},disabled:null}),e.jsx(R,{menu:{items:l},children:e.jsx(p,{type:"link",className:"c-primary",onClick:i=>i.preventDefault(),children:e.jsxs(S,{size:"small",align:"center",children:["更多",e.jsx(A,{})]})})})]})}}],I=()=>{c(1),u([]),g(!d)},q=s=>{s!==0&&X({title:"操作确认",icon:e.jsx($,{}),content:"确认删除此试卷？",centered:!0,okText:"确认",cancelText:"取消",onOk(){m||(n(!0),U(s).then(()=>{n(!1),G.success("删除成功"),I()}).catch(t=>{n(!1)}))},onCancel(){console.log("Cancel")}})};return e.jsxs("div",{className:"meedu-main-body",children:[e.jsxs("div",{className:"float-left j-b-flex mb-30",children:[e.jsxs("div",{className:"d-flex",children:[e.jsx(o,{type:"primary",text:"新建试卷",class:"",icon:null,p:"addons.Paper.paper.store",onClick:()=>r("/exam/paper/create"),disabled:null}),e.jsx(p,{type:"primary",className:"ml-10",onClick:()=>r("/exam/paper/category/index"),children:"分类管理"})]}),e.jsxs("div",{className:"d-flex",children:[e.jsx(O,{value:j,onChange:s=>{y(s.target.value)},allowClear:!0,style:{width:150},placeholder:"试卷关键字"}),e.jsx(V,{style:{width:150,marginLeft:10},value:C,onChange:s=>{k(s)},allowClear:!0,placeholder:"分类",options:N}),e.jsx(p,{className:"ml-10",onClick:z,children:"清空"}),e.jsx(p,{className:"ml-10",type:"primary",onClick:()=>{c(1),g(!d)},children:"筛选"})]})]}),e.jsx("div",{className:"float-left",children:e.jsx(W,{loading:m,columns:B,dataSource:b,rowKey:s=>s.id,pagination:T})})]})};export{me as default};
