import{u as g,b,r as c,t as y,j as t,B as m,m as v,i as w}from"./index-b4683d61.js";import{f as B}from"./member-43775307.js";import{r as N,u as k}from"./xlsx-b055c42d.js";import{B as S}from"./index-5f967da4.js";import{U}from"./index-9c2b15e9.js";import"./LeftOutlined-9e6e73a2.js";import"./Dragger-1df363a5.js";import"./useForceUpdate-f2aff5e0.js";import"./DeleteOutlined-8e7e99fd.js";import"./CheckOutlined-e6bc730e.js";const J=()=>{const d=g();b();const[l,r]=c.useState(!1);c.useEffect(()=>{document.title="学员批量导入",d(y("学员批量导入"))},[]);const p={accept:".xls,.xlsx,application/vnd.ms-excel",beforeUpload:e=>{if(l)return;r(!0);const i=e,s=new FileReader;return s.onload=a=>{const o=a.target.result,n=N(o,{type:"binary"}),x=n.Sheets[n.SheetNames[0]],j=k.sheet_to_json(x,{header:1});u(j)},s.readAsBinaryString(i),!1}},u=(e,i)=>{e.splice(0,2);let s=[];for(let a=0;a<e.length;a++){let o=e[a];o.length!==0&&(o.splice(4,0,0),s.push(o))}f(s)},f=e=>{B({users:e}).then(()=>{r(!1),v.success("导入成功！")}).catch(i=>{r(!1)})},h=()=>{let e=w()+"/template/学员批量导入模板.xlsx";window.open(e)};return t.jsxs("div",{className:"meedu-main-body",children:[t.jsx(S,{title:"学员批量导入"}),t.jsx("div",{className:"user-import-box",children:t.jsxs("div",{className:"float-left d-flex mb-30x",children:[t.jsx("div",{children:t.jsx(U,{...p,showUploadList:!1,children:t.jsx(m,{loading:l,type:"primary",children:"导入表格"})})}),t.jsx("div",{className:"ml-30",children:t.jsx(m,{type:"link",className:"c-primary",onClick:()=>h(),children:"下载「学员批量导入模板」"})})]})})]})};export{J as default};
