import{f as D,u as O,b as G,r as a,t as K,j as s,d as I,S as U,E as q,m as H,M as J}from"./index-3fd54424.js";import{t as Q,c as V}from"./tuangou-cc2a4f55.js";import{B as W}from"./index-c3c15456.js";import{P as _}from"./index-df05a090.js";import{T as X}from"./index-47408a6e.js";import{T as Y}from"./Table-59a53b18.js";import{T as l}from"./index-2c039b27.js";import"./LeftOutlined-a0f8cfa6.js";import"./PlusOutlined-18e71fec.js";import"./addEventListener-1752243f.js";import"./useIcons-235bc0cd.js";import"./CheckOutlined-44e74bd9.js";import"./Pagination-a2ebdf00.js";import"./useForceUpdate-56773729.js";import"./responsiveObserver-a0dea2e5.js";import"./index-ff4e3b6e.js";import"./index-a56efb1a.js";import"./iconUtil-14ff0944.js";const{confirm:Z}=J,gt=()=>{const r=new URLSearchParams(D().search),y=O(),b=G(),[c,o]=a.useState(!1),[k,p]=a.useState([]),[u,f]=a.useState(1),[d,S]=a.useState(10),[T,C]=a.useState(0),[h,v]=a.useState(!1),[n,w]=a.useState([0,0,0,0]),[x,E]=a.useState(Number(r.get("id"))),[m,P]=a.useState("-1"),[g,j]=a.useState(0),[i,N]=a.useState([{key:"-1",label:"全部"},{key:"0",label:"未支付"},{label:"组团成功",key:"1"},{label:"组团失败",key:"2"},{label:"组团中",key:"3"}]);a.useEffect(()=>{document.title="团列表",y(K("团列表"))},[]),a.useEffect(()=>{F()},[x,u,d,h,m]),a.useEffect(()=>{E(Number(r.get("id")))},[r.get("id")]),a.useEffect(()=>{if(n===null)j(0);else{let e=0;for(let t=1;t<i.length;t++)e+=n[i[t].key];j(e)}},[n,i]),a.useEffect(()=>{let e=[{label:"全部("+g+")",key:"-1"},{label:"未支付("+n[0]+")",key:"0"},{label:"组团成功("+n[1]+")",key:"1"},{label:"组团失败("+n[2]+")",key:"2"},{label:"组团中("+n[3]+")",key:"3"}];N(e)},[g,n]);const F=()=>{c||(o(!0),Q(x,{page:u,size:d,status:m}).then(e=>{p(e.data.data.data),C(e.data.data.total),w(e.data.countMap),o(!1)}).catch(e=>{o(!1)}))},L={current:u,pageSize:d,total:T,onChange:(e,t)=>M(e,t),showSizeChanger:!0},M=(e,t)=>{f(e),S(t)},R=[{title:"团长",render:(e,t)=>s.jsx("span",{children:t.create_user_name})},{title:"状态",width:200,render:(e,t)=>s.jsxs(s.Fragment,{children:[t.status===1&&s.jsx(l,{color:"success",children:t.status_text}),t.status===0&&s.jsx(l,{color:"default",children:t.status_text}),t.status===2&&s.jsx(l,{color:"error",children:t.status_text}),t.status===3&&s.jsx(l,{color:"processing",children:t.status_text})]})},{title:"模拟",width:120,render:(e,t)=>s.jsx(s.Fragment,{children:t.create_user_id===0&&s.jsx(l,{color:"processing",children:"是"})})},{title:"人数",width:120,render:(e,t)=>s.jsxs("span",{children:[t.people_num-t.over_people_num,"/",t.people_num]})},{title:"过期",width:200,render:(e,t)=>s.jsx("div",{children:I(t.expired_at)})},{title:"操作",width:160,render:(e,t)=>s.jsx(s.Fragment,{children:s.jsxs(U,{children:[s.jsx(_,{type:"link",text:"详情",class:"c-primary",icon:null,p:"addons.TuanGou.goods.item.detail",onClick:()=>{b("/tuangou/goods/detail?id="+t.goods_id+"&tid="+t.id)},disabled:null}),t.status!=1&&s.jsx(_,{type:"link",text:"改为已完成",class:"c-red",icon:null,p:"addons.TuanGou.goods.complete",onClick:()=>{z(t.id)},disabled:null})]})})}],z=e=>{e!==0&&Z({title:"警告",icon:s.jsx(q,{}),content:"确认操作？",centered:!0,okText:"确认",cancelText:"取消",onOk(){c||(o(!0),V({id:e}).then(()=>{o(!1),H.success("成功"),A()}).catch(t=>{o(!1)}))},onCancel(){console.log("Cancel")}})},A=()=>{f(1),p([]),v(!h)},B=e=>{P(e)};return s.jsxs("div",{className:"meedu-main-body",children:[s.jsx(W,{title:"团列表"}),s.jsx("div",{className:"float-left mt-30",children:s.jsx(X,{defaultActiveKey:m,items:i,onChange:B})}),s.jsx("div",{className:"float-left ",children:s.jsx(Y,{loading:c,columns:R,dataSource:k,rowKey:e=>e.id,pagination:L})})]})};export{gt as default};
