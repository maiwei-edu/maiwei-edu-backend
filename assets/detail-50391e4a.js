import{f as S,u as E,r as n,t as P,j as e,d as m,E as j,m as f,M as F}from"./index-b4683d61.js";import{d as T,s as B,b as L}from"./order-8405cf8c.js";import{B as K}from"./index-5f967da4.js";import{P as u}from"./index-573a6ce5.js";import{a as O,w as r}from"./wepay-fe568e4a.js";import{c as R}from"./card-da9446d6.js";import{T as x}from"./Table-76e623b5.js";import"./LeftOutlined-9e6e73a2.js";import"./addEventListener-a27ae3f4.js";import"./useIcons-e0af7133.js";import"./CheckOutlined-e6bc730e.js";import"./Pagination-d2c763c6.js";import"./useForceUpdate-f2aff5e0.js";import"./responsiveObserver-dc429d3b.js";import"./index-c09cc6d7.js";import"./index-10f1a096.js";import"./iconUtil-f3f90360.js";const{confirm:g}=F,te=()=>{const c=new URLSearchParams(S().search),_=E(),[l,i]=n.useState(!1),[a,N]=n.useState([]),[o,w]=n.useState({}),[h,p]=n.useState(!1),[d,v]=n.useState(Number(c.get("id")));n.useEffect(()=>{document.title="订单详情",_(P("订单详情"))},[]),n.useEffect(()=>{v(Number(c.get("id")))},[c.get("id")]),n.useEffect(()=>{y()},[d,h]);const y=()=>{l||(i(!0),T(d).then(t=>{N(t.data.order),w(t.data.user),i(!1)}).catch(t=>{i(!1)}))},b=()=>{d!==0&&g({title:"警告",icon:e.jsx(j,{}),content:"确认操作？",centered:!0,okText:"确认",cancelText:"取消",onOk(){l||(i(!0),B(d).then(()=>{i(!1),f.success("成功"),p(!h)}).catch(t=>{i(!1)}))},onCancel(){console.log("Cancel")}})},I=[{title:"ID",width:120,render:(t,s)=>e.jsx("span",{children:s.id})},{title:"支付渠道",width:300,render:(t,s)=>e.jsx("span",{children:s.paid_type_text})},{title:"支付金额",render:(t,s)=>e.jsxs("span",{children:[s.paid_total,"元"]})},{title:"渠道ID",width:120,render:(t,s)=>e.jsx("span",{children:s.paid_type_id})}],D=[{title:"ID",width:120,render:(t,s)=>e.jsx("span",{children:s.id})},{title:"商品ID",width:120,render:(t,s)=>e.jsx("span",{children:s.goods_id})},{title:"商品",render:(t,s)=>e.jsx("span",{children:s.goods_name})},{title:"价格",width:200,render:(t,s)=>e.jsxs("span",{children:[s.goods_charge,"元"]})}],C=[{title:"ID",width:120,render:(t,s)=>e.jsx("span",{children:s.id})},{title:"退款单号",width:300,render:(t,s)=>e.jsx("span",{children:s.refund_no})},{title:"支付渠道",render:(t,s)=>e.jsxs(e.Fragment,{children:[s.payment==="alipay"&&e.jsx("img",{src:O,width:"30",height:"30"}),s.payment==="wechat"&&e.jsx("img",{src:r,width:"30",height:"30"}),s.payment==="wechat_h5"&&e.jsx("img",{src:r,width:"30",height:"30"}),s.payment==="wechat-jsapi"&&e.jsx("img",{src:r,width:"30",height:"30"}),s.payment==="wechatApp"&&e.jsx("img",{src:r,width:"30",height:"30"}),s.payment==="handPay"&&e.jsx("img",{src:R,width:"30",height:"30"}),s.payment===""&&e.jsx("span",{children:"-"})]})},{title:"退款类型",width:120,render:(t,s)=>e.jsxs(e.Fragment,{children:[s.is_local===1&&e.jsx("span",{children:"线下退款"}),s.is_local!==1&&e.jsx("span",{children:"原渠道退回"})]})},{title:"退款金额",width:150,render:(t,s)=>e.jsxs("span",{children:["¥",s.amount/100]})},{title:"状态",width:220,render:(t,s)=>e.jsxs(e.Fragment,{children:[s.status===5&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"c-green mb-10",children:"· 退款成功"}),e.jsx("br",{}),e.jsx("span",{className:"c-gray",children:m(s.success_at)})]}),s.status===13&&e.jsx("span",{className:"c-red",children:"· 退款已关闭"}),s.status===1&&e.jsx("span",{className:"c-yellow",children:"· 待处理"}),s.status===9&&e.jsx("span",{children:"· 退款异常"})]})},{title:"提交时间",width:200,dataIndex:"created_at",render:t=>e.jsx("span",{children:m(t)})},{title:"操作",width:80,render:(t,s)=>e.jsx(u,{type:"link",text:"删除",class:"c-red",icon:null,p:"order.refund.delete",onClick:()=>{k(s.id)},disabled:null})}],k=t=>{t!==0&&g({title:"操作确认",icon:e.jsx(j,{}),content:"确认删除此订单记录？",centered:!0,okText:"确认",cancelText:"取消",onOk(){l||(i(!0),L(t).then(()=>{i(!1),f.success("删除成功"),p(!h)}).catch(s=>{i(!1)}))},onCancel(){console.log("Cancel")}})};return e.jsxs("div",{className:"meedu-main-body",children:[e.jsx(K,{title:"订单详情"}),o&&a.status!==9&&e.jsx("div",{className:"float-left mt-30 ",children:e.jsx(u,{type:"danger",text:"改为已支付",class:"",icon:null,p:"order.finish",onClick:()=>b(),disabled:null})}),e.jsxs("div",{className:"float-left mt-30",children:[e.jsxs("div",{className:"panel-box p-0 mb-30",children:[e.jsx("div",{className:"panel-header",children:"订单基础信息"}),e.jsx("div",{className:"panel-body",children:e.jsxs("div",{className:"float-left",children:[e.jsxs("div",{className:"float-left d-flex mb-30",children:[e.jsxs("div",{className:"flex-1",children:["UID：",o.id]}),e.jsxs("div",{className:"flex-1",children:["学员：",o.nick_name]}),e.jsxs("div",{className:"flex-1",children:["订单ID：",a.id]}),e.jsxs("div",{className:"flex-1",children:["订单编号：",a.order_id]}),e.jsxs("div",{className:"flex-1",children:["总额：￥",a.charge]})]}),e.jsxs("div",{className:"float-left d-flex",children:[e.jsxs("div",{className:"flex-1",children:["状态：",a.status_text]}),e.jsxs("div",{className:"flex-1",children:["支付渠道：",a.payment_text]}),e.jsxs("div",{className:"flex-1",children:["时间：",m(a.created_at)]}),e.jsx("div",{className:"flex-1"}),e.jsx("div",{className:"flex-1"})]})]})})]}),e.jsxs("div",{className:"panel-box p-0 mt-30",children:[e.jsx("div",{className:"panel-header",children:"订单商品"}),e.jsx("div",{className:"panel-body",children:e.jsx(x,{loading:l,columns:D,dataSource:a.goods,rowKey:t=>t.id,pagination:!1})})]}),e.jsxs("div",{className:"panel-box p-0 mt-30",children:[e.jsx("div",{className:"panel-header",children:"支付记录"}),e.jsx("div",{className:"panel-body",children:e.jsx(x,{loading:l,columns:I,dataSource:a.paid_records,rowKey:t=>t.id,pagination:!1})})]}),e.jsxs("div",{className:"panel-box p-0 mt-30",children:[e.jsx("div",{className:"panel-header",children:"退款记录"}),e.jsx("div",{className:"panel-body",children:e.jsx(x,{loading:l,columns:C,dataSource:a.refund,rowKey:t=>t.id,pagination:!1})})]})]})]})};export{te as default};
