import{r as o,j as t,M as m,d as w,m as c,E as S}from"./index-b4683d61.js";import{l as y,d as C}from"./snapshot-aa142fe1.js";import{P as b}from"./index-573a6ce5.js";import{T as k}from"./Table-76e623b5.js";import{I as E}from"./index-e35c971c.js";const{confirm:R}=m,N=e=>{const[l,s]=o.useState(!1),[u,i]=o.useState([]),[f,h]=o.useState(0),[d,x]=o.useState([]);o.useEffect(()=>{i([]),e.open&&e.vid!==0&&e.uid!==0&&r()},[e.open,e.vid,e.uid]);const r=()=>{if(l)return;s(!0);let a=[];a.push(e.vid),y({type:"vod",other_ids:a,user_id:e.uid}).then(n=>{h(n.data[e.vid].id),i(n.data[e.vid].images),s(!1)}).catch(n=>{s(!1)})},g=[{title:"拍照时间",dataIndex:"created_at",render:a=>t.jsx("span",{children:w(a)})},{title:"操作",width:250,render:(a,n)=>t.jsx(E,{src:n.thumb,width:100,height:100,preview:!0})}],j=()=>{if(d.length===0){c.error("请选择需要操作的数据");return}R({title:"操作确认",icon:t.jsx(S,{}),content:"确认删除选中的图片？",centered:!0,okText:"确认",cancelText:"取消",onOk(){l||(s(!0),C({ids:d,rid:f}).then(()=>{c.success("成功"),i([]),r(),s(!1)}).catch(a=>{s(!1)}))},onCancel(){console.log("Cancel")}})},v={selectedRowKeys:d,onChange:(a,n)=>{x(a)}};return t.jsx(t.Fragment,{children:e.open?t.jsx(m,{title:"学习照片",onCancel:()=>{e.onCancel()},open:!0,width:1e3,maskClosable:!1,footer:null,centered:!0,children:t.jsxs("div",{className:"mt-20",style:{maxHeight:520,overflowX:"hidden",overflowY:"auto",marginBottom:10},children:[t.jsx("div",{className:"float-left mb-30",children:t.jsx(b,{type:"danger",text:"批量删除",class:"",icon:null,p:"addons.Snapshot.images.delete",onClick:()=>j(),disabled:null})}),t.jsx("div",{className:"float-left ",children:t.jsx(k,{rowSelection:{type:"checkbox",...v},loading:l,columns:g,dataSource:u,rowKey:a=>a.id,pagination:!1})})]})}):null})};export{N as S};
