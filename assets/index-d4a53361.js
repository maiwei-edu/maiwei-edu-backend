import{u as B,b as F,r as a,t as G,j as e,I as z,B as f,d as j,S as D,E as I,m as L,M as O}from"./index-3fd54424.js";import{l as K,d as M}from"./tuangou-cc2a4f55.js";import{P as n}from"./index-df05a090.js";import{O as R}from"./index-cbea6645.js";import{T as y}from"./index-04a133fc.js";import{T as A}from"./Table-59a53b18.js";import"./icon-option-c9fff0bb.js";import"./addEventListener-1752243f.js";import"./useIcons-235bc0cd.js";import"./CheckOutlined-44e74bd9.js";import"./Pagination-a2ebdf00.js";import"./LeftOutlined-a0f8cfa6.js";import"./useForceUpdate-56773729.js";import"./responsiveObserver-a0dea2e5.js";import"./index-ff4e3b6e.js";import"./index-a56efb1a.js";import"./iconUtil-14ff0944.js";const{confirm:$}=O,le=()=>{const b=B(),i=F(),[r,o]=a.useState(!1),[v,c]=a.useState([]),[u,l]=a.useState(1),[m,h]=a.useState(10),[_,k]=a.useState(0),[d,p]=a.useState(!1),[g,x]=a.useState("");a.useEffect(()=>{document.title="团购活动",b(G("团购活动"))},[]),a.useEffect(()=>{C()},[u,m,d]);const C=()=>{r||(o(!0),K({page:u,size:m,keywords:g}).then(s=>{c(s.data.data.data),k(s.data.data.total),o(!1)}).catch(s=>{o(!1)}))},w=()=>{l(1),h(10),c([]),x(""),p(!d)},S={current:u,pageSize:m,total:_,onChange:(s,t)=>T(s,t),showSizeChanger:!0},T=(s,t)=>{l(s),h(t)},N=[{title:"类型",dataIndex:"goods_type_text",render:s=>e.jsx("span",{children:s})},{title:"商品名称",width:400,render:(s,t)=>e.jsxs(e.Fragment,{children:[t.goods_type==="book"&&e.jsx(y,{value:t.goods_thumb,width:90,height:120,title:t.goods_title,border:4}),t.goods_type!=="book"&&e.jsx(y,{value:t.goods_thumb,width:120,height:90,title:t.goods_title,border:4})]})},{title:"价格",width:150,render:(s,t)=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["团购价：",t.charge,"元"]}),e.jsxs("div",{className:"ori-charge",children:["原价：",t.original_charge,"元"]})]})},{title:"成团人数",width:120,render:(s,t)=>e.jsxs("div",{children:[t.people_num,"人"]})},{title:"时间",width:200,render:(s,t)=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["开始:",j(t.started_at)]}),e.jsxs("div",{children:["结束:",j(t.ended_at)]})]})},{title:"操作",width:160,render:(s,t)=>e.jsxs(D,{children:[e.jsx(n,{type:"link",text:"编辑",class:"c-primary",icon:null,p:"addons.TuanGou.goods.update",onClick:()=>{i("/tuangou/goods/update?id="+t.id)},disabled:null}),e.jsx(n,{type:"link",text:"团列表",class:"c-primary",icon:null,p:"addons.TuanGou.goods.items",onClick:()=>{i("/tuangou/goods/tuanorder?id="+t.id)},disabled:null}),e.jsx(n,{type:"link",text:"删除",class:"c-red",icon:null,p:"addons.TuanGou.goods.delete",onClick:()=>{E(t.id)},disabled:null})]})}],E=s=>{s!==0&&$({title:"操作确认",icon:e.jsx(I,{}),content:"确认删除此活动？",centered:!0,okText:"确认",cancelText:"取消",onOk(){r||(o(!0),M(s).then(()=>{o(!1),L.success("删除成功"),P()}).catch(t=>{o(!1)}))},onCancel(){console.log("Cancel")}})},P=()=>{l(1),c([]),p(!d)};return e.jsxs("div",{className:"meedu-main-body",children:[e.jsxs("div",{className:"float-left j-b-flex mb-30",children:[e.jsxs("div",{className:"d-flex",children:[e.jsx(n,{type:"primary",text:"新建团购",class:"",icon:null,p:"addons.TuanGou.goods.store",onClick:()=>i("/tuangou/goods/create"),disabled:null}),e.jsx(n,{type:"primary",text:"团购订单",class:"ml-10",icon:null,p:"addons.TuanGou.orders",onClick:()=>i("/tuangou/goods/order"),disabled:null}),e.jsx(R,{text:"团购配置",value:"/system/config?key=团购"})]}),e.jsxs("div",{className:"d-flex",children:[e.jsx(z,{value:g,onChange:s=>{x(s.target.value)},allowClear:!0,style:{width:150},placeholder:"商品名称关键字"}),e.jsx(f,{className:"ml-10",onClick:w,children:"清空"}),e.jsx(f,{className:"ml-10",type:"primary",onClick:()=>{l(1),p(!d)},children:"筛选"})]})]}),e.jsx("div",{className:"float-left",children:e.jsx(A,{loading:r,columns:N,dataSource:v,rowKey:s=>s.id,pagination:S})})]})};export{le as default};
