import{r as a,T as $,j as l,bR as q,M as S,I as p,m as M}from"./index-3fd54424.js";import{S as z}from"./index-749454db.js";import{S as B}from"./index-ff4e3b6e.js";const D=k=>{const{height:j,isFormula:b,defautValue:c,mode:d,setContent:C}=k;let s=a.useRef(null);a.useState(!1);const[w,m]=a.useState(!1),[r,v]=a.useState(""),[E,f]=a.useState(!1),[g,h]=a.useState(""),[T,x]=a.useState(!1),[i,y]=a.useState(0),[n,u]=a.useState(""),V=[{label:"单行公式",value:0},{label:"多行公式",value:1}],F=$.useMemo(()=>({toolbar:{container:d&&d==="remark"?[["bold","italic","underline","strike"],["blockquote","code-block"],[{list:"ordered"},{list:"bullet"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}]]:[["bold","italic","underline","strike"],["blockquote","code-block"],[{list:"ordered"},{list:"bullet"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{align:[]}],["formula"],["link","video","image"]],handlers:{image:()=>f(!0),video:()=>m(!0),formula:()=>x(!0)}},formula:b}),[b,d]);a.useEffect(()=>{if(r){let e="";r!=="<p><br></p>"&&(e=r),C(e)}},[r]),a.useEffect(()=>{c&&v(c)},[c]);const I=()=>{if(!/^<iframe.+<\/iframe>$/.test(g)){h("");return}const e=g.split(/<iframe.*?src="(.*?)".*?<\/iframe>/).join(" ");let t=s==null?void 0:s.current.getEditor(),o=t.selection.savedRange.index||0;t.insertEmbed(o,"video",e),t.setSelection(o+1),m(!1),h("")},R=()=>{if(!n){u(""),M.error("请输入公式");return}let e=n;i===1?e="$$"+e+"$$":e="$"+e+"$";let t=s==null?void 0:s.current.getEditor(),o=t.selection.savedRange.index||0;t.clipboard.dangerouslyPasteHTML(o,e),t.setSelection(o+e.length+1),x(!1),y(0),u("")};return l.jsxs(l.Fragment,{children:[l.jsx(q,{ref:s,className:"quill-editor-box",style:{height:j},theme:"snow",value:r,onChange:v,modules:F,placeholder:"请输入内容...",readOnly:!1}),l.jsx(z,{open:E,from:1,onCancel:()=>f(!1),onSelected:e=>{let t=s==null?void 0:s.current.getEditor(),o=t.selection.savedRange.index||0;t.insertEmbed(o,"image",e),t.setSelection(o+1),f(!1)}}),l.jsx(S,{title:"插入视频地址",centered:!0,onCancel:()=>{m(!1)},cancelText:"取 消",okText:"确 定",open:w,width:960,maskClosable:!1,onOk:()=>{I()},children:l.jsx("div",{className:"text-center",style:{marginTop:30,marginBottom:30},children:l.jsx(p,{value:g,onChange:e=>{h(e.target.value)},allowClear:!0,style:{width:"100%"},placeholder:"如：<iframe src=... ></iframe>"})})}),l.jsxs(S,{title:"插入公式",centered:!0,onCancel:()=>{x(!1)},cancelText:"取 消",okText:"确 定",open:T,width:960,maskClosable:!1,onOk:()=>{R()},children:[l.jsx("div",{style:{marginTop:30,marginBottom:15},children:l.jsx(B,{style:{width:300},value:i,onChange:e=>{y(e)},options:V})}),l.jsxs("div",{className:"text-center",style:{marginBottom:30},children:[i===0&&l.jsx(p,{value:n,onChange:e=>{u(e.target.value)},allowClear:!0,style:{width:"100%"},placeholder:"如：x^2+y^2+Dx+Ey+F=0"}),i===1&&l.jsx(p.TextArea,{value:n,onChange:e=>{u(e.target.value)},rows:4,allowClear:!0,style:{width:"100%",resize:"none"},placeholder:"如：x^2+y^2+Dx+Ey+F=0"})]})]})]})};export{D as Q};
