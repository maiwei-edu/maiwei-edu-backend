import{u as N,b as U,f as K,r as n,t as P,cx as A,l as B,j as e,g as R,I as t,B as y,cy as W,m as D}from"./index-3fd54424.js";import{B as E}from"./index-c3c15456.js";import{F as d}from"./index-0ca68444.js";import{S as b}from"./index-ff4e3b6e.js";import{S as p}from"./index-27712364.js";import"./LeftOutlined-a0f8cfa6.js";import"./row-98a37fbf.js";import"./responsiveObserver-a0dea2e5.js";import"./useIcons-235bc0cd.js";import"./CheckOutlined-44e74bd9.js";const Y=()=>{const x=N(),c=U(),[s]=d.useForm(),h=new URLSearchParams(K().search),[u,o]=n.useState(!0),[r,z]=n.useState(""),[j,f]=n.useState(""),[k,_]=n.useState(""),v=[{value:"aliyun",label:"阿里云直播"},{value:"tencent",label:"腾讯云直播"}],w=[{label:"阿里云OSS",value:"oss"},{label:"腾讯云COS",value:"cos"}];n.useEffect(()=>{document.title="直播服务配置",x(P("直播服务配置")),g()},[]),n.useEffect(()=>{r&&(f("回调地址："+r+"addons/zhibo/api/v1/aliyun/callback"),_("回调地址："+r+"addons/zhibo/api/v1/tencent/callback"))},[r]);const g=()=>{A().then(i=>{let a=i.data.直播;for(let l in a)a[l].key==="meedu.addons.zhibo.default_service"?s.setFieldsValue({"meedu.addons.zhibo.default_service":a[l].value}):a[l].key==="meedu.addons.zhibo.default_attach_service"?s.setFieldsValue({"meedu.addons.zhibo.default_attach_service":a[l].value}):a[l].key==="meedu.addons.zhibo.aliyun.play_domain"?s.setFieldsValue({"meedu.addons.zhibo.aliyun.play_domain":a[l].value}):a[l].key==="meedu.addons.zhibo.aliyun.push_domain"?s.setFieldsValue({"meedu.addons.zhibo.aliyun.push_domain":a[l].value}):a[l].key==="meedu.addons.zhibo.aliyun.access_key"?s.setFieldsValue({"meedu.addons.zhibo.aliyun.access_key":a[l].value}):a[l].key==="meedu.addons.zhibo.aliyun.access_secret"?s.setFieldsValue({"meedu.addons.zhibo.aliyun.access_secret":a[l].value}):a[l].key==="meedu.addons.zhibo.aliyun.play_key"?s.setFieldsValue({"meedu.addons.zhibo.aliyun.play_key":a[l].value}):a[l].key==="meedu.addons.zhibo.aliyun.push_key"?s.setFieldsValue({"meedu.addons.zhibo.aliyun.push_key":a[l].value}):a[l].key==="meedu.addons.zhibo.aliyun.record.callback.key"?s.setFieldsValue({"meedu.addons.zhibo.aliyun.record.callback.key":a[l].value}):a[l].key==="meedu.addons.zhibo.aliyun.record.region"?s.setFieldsValue({"meedu.addons.zhibo.aliyun.record.region":a[l].value}):a[l].key==="meedu.addons.zhibo.tencent.app_id"?s.setFieldsValue({"meedu.addons.zhibo.tencent.app_id":a[l].value}):a[l].key==="meedu.addons.zhibo.tencent.secret_id"?s.setFieldsValue({"meedu.addons.zhibo.tencent.secret_id":a[l].value}):a[l].key==="meedu.addons.zhibo.tencent.secret_key"?s.setFieldsValue({"meedu.addons.zhibo.tencent.secret_key":a[l].value}):a[l].key==="meedu.addons.zhibo.tencent.play_domain"?s.setFieldsValue({"meedu.addons.zhibo.tencent.play_domain":a[l].value}):a[l].key==="meedu.addons.zhibo.tencent.push_domain"?s.setFieldsValue({"meedu.addons.zhibo.tencent.push_domain":a[l].value}):a[l].key==="meedu.addons.zhibo.tencent.play_key"?s.setFieldsValue({"meedu.addons.zhibo.tencent.play_key":a[l].value}):a[l].key==="meedu.addons.zhibo.tencent.push_key"?s.setFieldsValue({"meedu.addons.zhibo.tencent.push_key":a[l].value}):a[l].key==="meedu.addons.zhibo.tencent.record.callback.key"?s.setFieldsValue({"meedu.addons.zhibo.tencent.record.callback.key":a[l].value}):a[l].key==="meedu.addons.zhibo.tencent.webrtc_play"?s.setFieldsValue({"meedu.addons.zhibo.tencent.webrtc_play":Number(a[l].value)}):a[l].key==="meedu.addons.zhibo.aliyun.rts_play"?s.setFieldsValue({"meedu.addons.zhibo.aliyun.rts_play":Number(a[l].value)}):a[l].key==="meedu.addons.zhibo.go-meedu.internal_url"?s.setFieldsValue({"meedu.addons.zhibo.go-meedu.internal_url":a[l].value}):a[l].key==="meedu.addons.zhibo.go-meedu.url"?s.setFieldsValue({"meedu.addons.zhibo.go-meedu.url":a[l].value}):a[l].key==="meedu.addons.zhibo.go-meedu.key"&&s.setFieldsValue({"meedu.addons.zhibo.go-meedu.key":a[l].value});let m=i.data.系统;for(let l in m)if(m[l].key==="app.url"){let S=B(m[l].value);z(S);break}o(!1)}).catch(i=>{o(!1)})},F=i=>{u||(o(!0),W({config:i}).then(a=>{o(!1),D.success("成功！"),h.get("referer")?c(String(h.get("referer")),{replace:!0}):c(-1)}).catch(a=>{o(!1)}))},C=i=>{console.log("Failed:",i)},I=i=>{i?s.setFieldsValue({"meedu.addons.zhibo.tencent.webrtc_play":1}):s.setFieldsValue({"meedu.addons.zhibo.tencent.webrtc_play":0})},V=i=>{i?s.setFieldsValue({"meedu.addons.zhibo.aliyun.rts_play":1}):s.setFieldsValue({"meedu.addons.zhibo.aliyun.rts_play":0})};return e.jsxs("div",{className:"meedu-main-body",children:[e.jsx(E,{title:"直播服务配置"})," ",u&&e.jsx("div",{style:{width:"100%",textAlign:"center",paddingTop:50,paddingBottom:30,boxSizing:"border-box"},children:e.jsx(R,{})}),!u&&e.jsx("div",{className:"float-left",children:e.jsxs(d,{form:s,name:"system-player-config",labelCol:{span:3},wrapperCol:{span:21},initialValues:{remember:!0},onFinish:F,onFinishFailed:C,autoComplete:"off",children:[e.jsx("div",{className:"from-title mt-30",children:"服务商配置"}),e.jsx(d.Item,{label:"直播服务商",name:"meedu.addons.zhibo.default_service",children:e.jsx(b,{style:{width:300},allowClear:!0,options:v})}),e.jsx(d.Item,{label:"直播课件存储服务商",name:"meedu.addons.zhibo.default_attach_service",children:e.jsx(b,{style:{width:300},allowClear:!0,options:w})}),e.jsx("div",{className:"from-title mt-30",children:"阿里云直播服务商配置"}),e.jsx(d.Item,{label:"阿里云播流域名",name:"meedu.addons.zhibo.aliyun.play_domain",children:e.jsx(t,{style:{width:300},allowClear:!0})}),e.jsx(d.Item,{label:"阿里云推流域名",name:"meedu.addons.zhibo.aliyun.push_domain",children:e.jsx(t,{style:{width:300},allowClear:!0})}),e.jsx(d.Item,{label:"阿里云AccessKeyId",name:"meedu.addons.zhibo.aliyun.access_key",children:e.jsx(t,{style:{width:300},allowClear:!0})}),e.jsx(d.Item,{label:"阿里云AccessKeySecret",name:"meedu.addons.zhibo.aliyun.access_secret",children:e.jsx(t,{style:{width:300},allowClear:!0})}),e.jsx(d.Item,{label:"阿里云PlayKey",name:"meedu.addons.zhibo.aliyun.play_key",children:e.jsx(t,{style:{width:300},allowClear:!0})}),e.jsx(d.Item,{label:"阿里云PushKey",name:"meedu.addons.zhibo.aliyun.push_key",children:e.jsx(t,{style:{width:300},allowClear:!0})}),e.jsxs(d.Item,{label:"阿里云录制回调key",name:"meedu.addons.zhibo.aliyun.record.callback.key",children:[e.jsx(d.Item,{name:"meedu.addons.zhibo.aliyun.record.callback.key",children:e.jsx(t,{style:{width:300},allowClear:!0})}),e.jsx("div",{className:"form-helper-text",children:e.jsx("span",{children:j})})]}),e.jsxs(d.Item,{label:"启用RTS播放",name:"meedu.addons.zhibo.aliyun.rts_play",children:[e.jsx(d.Item,{name:"meedu.addons.zhibo.aliyun.rts_play",valuePropName:"checked",children:e.jsx(p,{onChange:V})}),e.jsx("div",{className:"form-helper-text",children:e.jsx("span",{children:"该播放方式毫秒级延迟。"})})]}),e.jsx("div",{className:"from-title mt-30",children:"腾讯云直播服务商配置"}),e.jsx(d.Item,{label:"腾讯云AppId",name:"meedu.addons.zhibo.tencent.app_id",children:e.jsx(t,{style:{width:300},allowClear:!0})}),e.jsx(d.Item,{label:"腾讯云SecretId",name:"meedu.addons.zhibo.tencent.secret_id",children:e.jsx(t,{style:{width:300},allowClear:!0})}),e.jsx(d.Item,{label:"腾讯云SecretKey",name:"meedu.addons.zhibo.tencent.secret_key",children:e.jsx(t,{style:{width:300},allowClear:!0})}),e.jsx(d.Item,{label:"腾讯云播流域名",name:"meedu.addons.zhibo.tencent.play_domain",children:e.jsx(t,{style:{width:300},allowClear:!0})}),e.jsx(d.Item,{label:"腾讯云推流域名",name:"meedu.addons.zhibo.tencent.push_domain",children:e.jsx(t,{style:{width:300},allowClear:!0})}),e.jsx(d.Item,{label:"腾讯云PlayKey",name:"meedu.addons.zhibo.tencent.play_key",children:e.jsx(t,{style:{width:300},allowClear:!0})}),e.jsx(d.Item,{label:"腾讯云PushKey",name:"meedu.addons.zhibo.tencent.push_key",children:e.jsx(t,{style:{width:300},allowClear:!0})}),e.jsxs(d.Item,{label:"腾讯云录制回调秘钥",name:"meedu.addons.zhibo.tencent.record.callback.key",children:[e.jsx(d.Item,{name:"meedu.addons.zhibo.tencent.record.callback.key",children:e.jsx(t,{style:{width:300},allowClear:!0})}),e.jsx("div",{className:"form-helper-text",children:e.jsx("span",{children:k})})]}),e.jsxs(d.Item,{label:"腾讯云WebRtc播放",name:"meedu.addons.zhibo.tencent.webrtc_play",children:[e.jsx(d.Item,{name:"meedu.addons.zhibo.tencent.webrtc_play",valuePropName:"checked",children:e.jsx(p,{onChange:I})}),e.jsx("div",{className:"form-helper-text",children:e.jsx("span",{children:"该播放方式毫秒级延迟。"})})]}),e.jsx("div",{className:"from-title mt-30",children:"直播间聊天服务配置"}),e.jsx(d.Item,{label:"聊天服务内网地址",name:"meedu.addons.zhibo.go-meedu.internal_url",children:e.jsx(t,{style:{width:300},allowClear:!0})}),e.jsx(d.Item,{label:"聊天服务外网地址",name:"meedu.addons.zhibo.go-meedu.url",children:e.jsx(t,{style:{width:300},allowClear:!0})}),e.jsx(d.Item,{label:"聊天服务Key",name:"meedu.addons.zhibo.go-meedu.key",children:e.jsx(t,{style:{width:300},allowClear:!0})})]})}),e.jsx("div",{className:"bottom-menus",children:e.jsxs("div",{className:"bottom-menus-box",children:[e.jsx("div",{children:e.jsx(y,{loading:u,type:"primary",onClick:()=>s.submit(),children:"保存"})}),e.jsx("div",{className:"ml-24",children:e.jsx(y,{type:"default",onClick:()=>c(-1),children:"取消"})})]})})]})};export{Y as default};
