import{f as P,u as y,r as a,t as z,j as e,B as L,d as C,m as Y,h as F}from"./index-b4683d61.js";import{b as p}from"./path-6d6aef48.js";import{B as R}from"./index-5f967da4.js";import{u as T,w as H}from"./xlsx-b055c42d.js";import{T as M}from"./Table-76e623b5.js";import"./LeftOutlined-9e6e73a2.js";import"./addEventListener-a27ae3f4.js";import"./useIcons-e0af7133.js";import"./CheckOutlined-e6bc730e.js";import"./Pagination-d2c763c6.js";import"./useForceUpdate-f2aff5e0.js";import"./responsiveObserver-dc429d3b.js";import"./index-c09cc6d7.js";import"./index-10f1a096.js";import"./iconUtil-f3f90360.js";const re=()=>{const n=new URLSearchParams(P().search),f=y(),[o,r]=a.useState(!1),[x,g]=a.useState([]),[c,j]=a.useState(1),[d,S]=a.useState(10),[m,U]=a.useState(0),[_,A]=a.useState(!1),[l,w]=a.useState(Number(n.get("id")));a.useEffect(()=>{document.title="付费学员",f(z("付费学员"))},[]),a.useEffect(()=>{w(Number(n.get("id")))},[n.get("id")]),a.useEffect(()=>{N()},[l,c,d,_]);const N=()=>{o||(r(!0),p(l,{page:c,size:d}).then(t=>{g(t.data.data),r(!1)}).catch(t=>{r(!1)}))},k=[{title:"ID",width:120,render:(t,s)=>e.jsx("span",{children:s.id})},{title:"学员ID",width:120,render:(t,s)=>e.jsx("span",{children:s.user_id})},{title:"学员",width:300,render:(t,s)=>e.jsxs(e.Fragment,{children:[s.user&&e.jsxs("div",{className:"user-item d-flex",children:[e.jsx("div",{className:"avatar",children:e.jsx("img",{src:s.user.avatar,width:"40",height:"40"})}),e.jsx("div",{className:"ml-10",children:s.user.nick_name})]}),!s.user&&e.jsx("span",{className:"c-red",children:"学员不存在"})]})},{title:"价格",width:150,dataIndex:"charge",render:t=>e.jsxs("span",{children:[t,"元"]})},{title:"时间",dataIndex:"updated_at",render:t=>e.jsx("span",{children:C(t)})}],v=()=>{if(o)return;r(!0),p(l,{page:1,size:m}).then(s=>{if(s.data.total===0){Y.error("数据为空"),r(!1);return}let B="学习路径订阅学员.xlsx",h="sheet1",u=[["学员ID","学员","手机号","价格","时间"]];s.data.data.forEach(i=>{u.push([i.user_id,i.user.nick_name,i.user.mobile,i.charge===0?"-":"￥"+i.charge,i.updated_at?F(i.updated_at).format("YYYY-MM-DD HH:mm"):""])});const E=T.json_to_sheet(u),I={SheetNames:[h],Sheets:{[h]:E}};H(I,B),r(!1)}).catch(s=>{r(!1)})},b={current:c,pageSize:d,total:m,onChange:(t,s)=>D(t,s),showSizeChanger:!0},D=(t,s)=>{j(t),S(s)};return e.jsxs("div",{className:"meedu-main-body",children:[e.jsx(R,{title:"付费学员"}),e.jsx("div",{className:"float-left mt-30 mb-30",children:e.jsx(L,{type:"primary",onClick:()=>v(),children:"导出表格"})}),e.jsx("div",{className:"float-left",children:e.jsx(M,{loading:o,columns:k,dataSource:x,rowKey:t=>t.id,pagination:b})})]})};export{re as default};
