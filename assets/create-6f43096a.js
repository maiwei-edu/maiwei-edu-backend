import{u as y,b as C,f as S,r as a,t as w,j as e,S as B,B as m,I,m as p}from"./index-b4683d61.js";import{y as U}from"./course-7dc1c12e.js";import{B as E}from"./index-5f967da4.js";import{H as L}from"./index-133d6e1c.js";import{F as i}from"./index-d434f3eb.js";import{U as _}from"./index-9c2b15e9.js";import"./LeftOutlined-9e6e73a2.js";import"./InfoCircleOutlined-4d24221b.js";import"./row-4ee18533.js";import"./responsiveObserver-dc429d3b.js";import"./Dragger-1df363a5.js";import"./useForceUpdate-f2aff5e0.js";import"./DeleteOutlined-8e7e99fd.js";import"./CheckOutlined-e6bc730e.js";const O=()=>{const[o]=i.useForm(),u=y(),c=C(),n=new URLSearchParams(S().search),[l,t]=a.useState(!1),[f,h]=a.useState(Number(n.get("course_id"))),[d,x]=a.useState(""),[g,j]=a.useState(null);a.useEffect(()=>{document.title="添加课程附件",u(w("添加课程附件"))},[]),a.useEffect(()=>{h(Number(n.get("course_id")))},[n.get("course_id")]);const b=r=>{if(l)return;t(!0);const s=new FormData;s.append("file",g),s.append("name",r.name),s.append("course_id",String(f)),U(s).then(F=>{t(!1),p.success("成功！"),c(-1)}).catch(F=>{t(!1)})},N=r=>{console.log("Failed:",r)},v={accept:"image/gif,image/jpeg,image/jpg,image/png,.csv,.doc,.txt,.pdf,.md,.zip,",beforeUpload:r=>{if(l)return;t(!0);const s=r;if(s.size>1024e4){p.error("上传附件大小不能超过10MB"),t(!1);return}return x(s.name),o.setFieldsValue({name:s.name}),j(s),t(!1),!1}};return e.jsxs("div",{className:"meedu-main-body",children:[e.jsx(E,{title:"添加课程附件"}),e.jsxs("div",{className:"float-left mt-30",children:[e.jsxs(i,{form:o,name:"course-attach-create",labelCol:{span:3},wrapperCol:{span:21},initialValues:{remember:!0},onFinish:b,onFinishFailed:N,autoComplete:"off",children:[e.jsx(i.Item,{label:"排序",name:"file",rules:[{required:!0,message:"填上传附件!"}],children:e.jsxs(B,{align:"baseline",style:{height:32},children:[e.jsx(i.Item,{name:"file",rules:[{required:!0,message:"填上传附件!"}],children:e.jsxs(_,{...v,showUploadList:!1,children:[e.jsx(m,{loading:l,type:"primary",children:"上传附件"}),d&&e.jsx("span",{className:"ml-10",children:d})]})}),e.jsx("div",{className:"ml-10",children:e.jsx(L,{text:"支持zip,pdf,jpeg,jpg,gif,png,md,doc,txt,csv格式文件，上传附件大小不能超过10M"})})]})}),e.jsx(i.Item,{label:"附件名",name:"name",rules:[{required:!0,message:"请输入附件名!"}],children:e.jsx(I,{style:{width:300},placeholder:"请输入附件名",allowClear:!0})})]}),e.jsx("div",{className:"bottom-menus",children:e.jsxs("div",{className:"bottom-menus-box",children:[e.jsx("div",{children:e.jsx(m,{loading:l,type:"primary",onClick:()=>o.submit(),children:"保存"})}),e.jsx("div",{className:"ml-24",children:e.jsx(m,{type:"default",onClick:()=>c(-1),children:"取消"})})]})})]})]})};export{O as default};
