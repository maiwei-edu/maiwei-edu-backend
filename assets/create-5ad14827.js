import{u as _,b as F,r as o,t as I,cq as N,j as e,S as h,I as c,cr as x,B as j,m as f,cs as k}from"./index-b4683d61.js";import{B}from"./index-5f967da4.js";import{P as q}from"./index-573a6ce5.js";import{F as t}from"./index-d434f3eb.js";import{S as P}from"./index-c09cc6d7.js";import{S as E}from"./index-918ef875.js";import"./LeftOutlined-9e6e73a2.js";import"./row-4ee18533.js";import"./responsiveObserver-dc429d3b.js";import"./useIcons-e0af7133.js";import"./CheckOutlined-e6bc730e.js";const K=()=>{const[r]=t.useForm(),g=_(),n=F(),[u,m]=o.useState(!1),[b,w]=o.useState([]),[d,p]=o.useState("");o.useEffect(()=>{document.title="新建管理员",g(I("新建管理员")),y()},[]);const y=()=>{N().then(s=>{const a=[];let l=s.data.roles;for(let i=0;i<l.length;i++)a.push({label:l[i].display_name,value:l[i].id});w(a)})},C=s=>{if(u)return;if(x(s.password)){f.error("密码至少包含大写字母，小写字母，数字，且不少于12位");return}let a={password_confirmation:s.password};Object.assign(a,s),m(!0),k(a).then(l=>{m(!1),f.success("保存成功！"),n(-1)}).catch(l=>{m(!1)})},v=s=>{console.log("Failed:",s)},S=s=>{s?r.setFieldsValue({is_ban_login:1}):r.setFieldsValue({is_ban_login:0})};return e.jsxs("div",{className:"meedu-main-body",children:[e.jsx(B,{title:"新建管理员"}),e.jsx("div",{className:"float-left mt-30",children:e.jsxs(t,{form:r,name:"administrator-create",labelCol:{span:3},wrapperCol:{span:21},initialValues:{remember:!0},onFinish:C,onFinishFailed:v,autoComplete:"off",children:[e.jsx(t.Item,{label:"角色",children:e.jsxs(h,{align:"baseline",style:{height:32},children:[e.jsx(t.Item,{name:"role_id",children:e.jsx(P,{style:{width:300},mode:"multiple",allowClear:!0,placeholder:"请选择角色",options:b})}),e.jsx("div",{className:"ml-10",children:e.jsx(q,{type:"link",text:"角色管理",class:"c-primary",icon:null,p:"administrator_role",onClick:()=>{n("/system/adminroles")},disabled:null})})]})}),e.jsx(t.Item,{label:"姓名",name:"name",rules:[{required:!0,message:"请输入姓名!"}],children:e.jsx(c,{style:{width:300},placeholder:"请输入姓名",allowClear:!0})}),e.jsx(t.Item,{label:"邮箱",name:"email",rules:[{required:!0,message:"请输入邮箱!"}],children:e.jsx(c,{style:{width:300},placeholder:"请输入邮箱",allowClear:!0})}),e.jsx(t.Item,{label:"密码",name:"password",rules:[{required:!0,message:"请输入密码!"}],children:e.jsxs(h,{align:"baseline",style:{height:32},children:[e.jsx(t.Item,{name:"password",rules:[{required:!0,message:"请输入密码!"}],children:e.jsx(c.Password,{style:{width:300},placeholder:"请输入密码",allowClear:!0,onChange:s=>{if(s.target.value==="")p("");else{let a=x(s.target.value);p(String(a))}}})}),d!==""&&d!=="undefined"&&e.jsx("div",{className:"ml-10 c-red",children:d})]})}),e.jsx(t.Item,{label:"禁止登录",name:"is_ban_login",valuePropName:"checked",children:e.jsx(E,{onChange:S})})]})}),e.jsx("div",{className:"bottom-menus",children:e.jsxs("div",{className:"bottom-menus-box",children:[e.jsx("div",{children:e.jsx(j,{loading:u,type:"primary",onClick:()=>r.submit(),children:"保存"})}),e.jsx("div",{className:"ml-24",children:e.jsx(j,{type:"default",onClick:()=>n(-1),children:"取消"})})]})})]})};export{K as default};
