import{r as l,j as e,M as q,I as j,S as w,m as k,u as W,t as Z,w as H,E as M}from"./index-b4683d61.js";import{t as T,i as $,j as K,k as G,m as J,n as Q}from"./live-ef2dd82c.js";import{B as X}from"./index-5f967da4.js";import{P as F}from"./index-573a6ce5.js";import{H as v}from"./index-133d6e1c.js";import{U as D}from"./index-4432445b.js";import{F as r}from"./index-d434f3eb.js";import{S as E}from"./index-c09cc6d7.js";import{R as P,C as I}from"./row-4ee18533.js";import{T as Y}from"./Table-76e623b5.js";import"./LeftOutlined-9e6e73a2.js";import"./InfoCircleOutlined-4d24221b.js";import"./InboxOutlined-1c6772bb.js";import"./selected-177ec16c.js";import"./Dragger-1df363a5.js";import"./useForceUpdate-f2aff5e0.js";import"./DeleteOutlined-8e7e99fd.js";import"./CheckOutlined-e6bc730e.js";import"./useIcons-e0af7133.js";import"./Pagination-d2c763c6.js";import"./responsiveObserver-dc429d3b.js";import"./addEventListener-a27ae3f4.js";import"./index-10f1a096.js";import"./iconUtil-f3f90360.js";const ee=i=>{const[d]=r.useForm(),[u,h]=l.useState(!1),[b,p]=l.useState([]),[a,c]=l.useState("讲师"),[g,f]=l.useState("");l.useEffect(()=>{i.open&&(d.setFieldsValue({role_id:[],name:"",avatar:"",username:"",password:"",short_desc:""}),f(""),c("讲师")),S()},[i.open]);const S=()=>{T().then(o=>{let s=[];for(let m=0;m<o.data.roles.length;m++)s.push({label:o.data.roles[m].name,value:o.data.roles[m].id});p(s)})},C=o=>{u||(h(!0),$(o).then(s=>{h(!1),k.success("成功！"),i.onSuccess()}).catch(s=>{h(!1)}))},y=o=>{console.log("Failed:",o)};return e.jsx(e.Fragment,{children:i.open?e.jsx(q,{title:"添加讲师/助教",onCancel:()=>{i.onCancel()},open:!0,width:800,maskClosable:!1,onOk:()=>{d.submit()},centered:!0,children:e.jsx("div",{className:"float-left mt-30",children:e.jsxs(r,{form:d,name:"live-teacher-create-dailog",labelCol:{span:3},wrapperCol:{span:21},initialValues:{remember:!0},onFinish:C,onFinishFailed:y,autoComplete:"off",children:[e.jsx(r.Item,{label:"角色",name:"role_id",rules:[{required:!0,message:"请选择角色!"}],children:e.jsx(E,{style:{width:300},placeholder:"请选择角色",allowClear:!0,options:b,onChange:o=>{c(o===0?"讲师":"助教")}})}),e.jsx(r.Item,{label:a+"名称",name:"name",rules:[{required:!0,message:"请输入"+a+"名称!"}],children:e.jsx(j,{style:{width:300},placeholder:"请输入"+a+"名称",allowClear:!0})}),e.jsx(r.Item,{label:a+"头像",name:"avatar",rules:[{required:!0,message:"填输入排序!"}],children:e.jsxs(w,{align:"baseline",style:{height:32},children:[e.jsx(r.Item,{name:"avatar",rules:[{required:!0,message:"填输入排序!"}],children:e.jsx(D,{text:a+"头像",onSelected:o=>{d.setFieldsValue({avatar:o}),f(o)}})}),e.jsx("div",{className:"ml-10",children:e.jsx(v,{text:"长宽比1:1 推荐尺寸200x200"})})]})}),g&&e.jsxs(P,{style:{marginBottom:22},children:[e.jsx(I,{span:3}),e.jsx(I,{span:21,children:e.jsx("div",{className:"normal-thumb-box",style:{backgroundImage:`url(${g})`,width:100,height:100}})})]}),e.jsx(r.Item,{label:"登录邮箱",name:"username",rules:[{required:!0,message:"填输入"+a+"登录邮箱!"}],children:e.jsxs(w,{align:"baseline",style:{height:32},children:[e.jsx(r.Item,{name:"username",rules:[{required:!0,message:"填输入"+a+"登录邮箱!"}],children:e.jsx(j,{style:{width:300},placeholder:"填输入"+a+"登录邮箱",allowClear:!0})}),e.jsx("div",{className:"ml-10",children:e.jsx(v,{text:"用于讲师/助教客户端登录"})})]})}),e.jsx(r.Item,{label:"登录密码",name:"password",rules:[{required:!0,message:"填输入"+a+"登录密码!"}],children:e.jsxs(w,{align:"baseline",style:{height:32},children:[e.jsx(r.Item,{name:"password",rules:[{required:!0,message:"填输入"+a+"登录密码!"}],children:e.jsx(j,{style:{width:300},placeholder:"填输入"+a+"登录密码",allowClear:!0})}),e.jsx("div",{className:"ml-10",children:e.jsx(v,{text:"用于讲师/助教客户端登录"})})]})}),a==="讲师"&&e.jsx(r.Item,{label:"讲师风采",name:"short_desc",rules:[{required:!0,message:"填输入讲师风采!"}],children:e.jsx(j.TextArea,{rows:4,style:{width:600,resize:"none"},placeholder:"填写讲师/助教相关介绍，用于直播课前台展示",allowClear:!0})})]})})}):null})},se=i=>{const[d]=r.useForm(),[u,h]=l.useState(!1),[b,p]=l.useState([]),[a,c]=l.useState("讲师"),[g,f]=l.useState("");l.useEffect(()=>{i.open&&d.setFieldsValue({role_id:[],name:"",avatar:"",username:"",password:"",short_desc:""}),C(),i.id>0&&S()},[i.open,i.id]);const S=()=>{K(i.id).then(s=>{d.setFieldsValue({name:s.data.name,username:s.data.username,role_id:s.data.role_id,password:s.data.password,short_desc:s.data.short_desc,avatar:s.data.avatar}),f(s.data.avatar),s.data.role_id===0?c("讲师"):c("助教")})},C=()=>{T().then(s=>{let m=[];for(let x=0;x<s.data.roles.length;x++)m.push({label:s.data.roles[x].name,value:s.data.roles[x].id});p(m)})},y=s=>{u||(h(!0),G(i.id,s).then(m=>{h(!1),k.success("成功！"),i.onSuccess()}).catch(m=>{h(!1)}))},o=s=>{console.log("Failed:",s)};return e.jsx(e.Fragment,{children:i.open?e.jsx(q,{title:"编辑讲师/助教",onCancel:()=>{i.onCancel()},open:!0,width:800,maskClosable:!1,onOk:()=>{d.submit()},centered:!0,children:e.jsx("div",{className:"float-left mt-30",children:e.jsxs(r,{form:d,name:"live-teacher-update-dailog",labelCol:{span:3},wrapperCol:{span:21},initialValues:{remember:!0},onFinish:y,onFinishFailed:o,autoComplete:"off",children:[e.jsx(r.Item,{label:"角色",name:"role_id",rules:[{required:!0,message:"请选择角色!"}],children:e.jsx(E,{style:{width:300},placeholder:"请选择角色",allowClear:!0,options:b,onChange:s=>{c(s===0?"讲师":"助教")}})}),e.jsx(r.Item,{label:a+"名称",name:"name",rules:[{required:!0,message:"请输入"+a+"名称!"}],children:e.jsx(j,{style:{width:300},placeholder:"请输入"+a+"名称",allowClear:!0})}),e.jsx(r.Item,{label:a+"头像",name:"avatar",rules:[{required:!0,message:"填输入排序!"}],children:e.jsxs(w,{align:"baseline",style:{height:32},children:[e.jsx(r.Item,{name:"avatar",rules:[{required:!0,message:"填输入排序!"}],children:e.jsx(D,{text:a+"头像",onSelected:s=>{d.setFieldsValue({avatar:s}),f(s)}})}),e.jsx("div",{className:"ml-10",children:e.jsx(v,{text:"长宽比1:1 推荐尺寸200x200"})})]})}),g&&e.jsxs(P,{style:{marginBottom:22},children:[e.jsx(I,{span:3}),e.jsx(I,{span:21,children:e.jsx("div",{className:"normal-thumb-box",style:{backgroundImage:`url(${g})`,width:100,height:100}})})]}),e.jsx(r.Item,{label:"登录邮箱",name:"username",rules:[{required:!0,message:"填输入"+a+"登录邮箱!"}],children:e.jsxs(w,{align:"baseline",style:{height:32},children:[e.jsx(r.Item,{name:"username",rules:[{required:!0,message:"填输入"+a+"登录邮箱!"}],children:e.jsx(j,{style:{width:300},placeholder:"填输入"+a+"登录邮箱",allowClear:!0})}),e.jsx("div",{className:"ml-10",children:e.jsx(v,{text:"用于讲师/助教客户端登录"})})]})}),e.jsx(r.Item,{label:"登录密码",name:"password",rules:[{required:!0,message:"填输入"+a+"登录密码!"}],children:e.jsxs(w,{align:"baseline",style:{height:32},children:[e.jsx(r.Item,{name:"password",rules:[{required:!0,message:"填输入"+a+"登录密码!"}],children:e.jsx(j,{style:{width:300},placeholder:"填输入"+a+"登录密码",allowClear:!0})}),e.jsx("div",{className:"ml-10",children:e.jsx(v,{text:"用于讲师/助教客户端登录"})})]})}),a==="讲师"&&e.jsx(r.Item,{label:"讲师风采",name:"short_desc",rules:[{required:!0,message:"填输入讲师风采!"}],children:e.jsx(j.TextArea,{rows:4,style:{width:600,resize:"none"},placeholder:"填写讲师/助教相关介绍，用于直播课前台展示",allowClear:!0})})]})})}):null})},{confirm:ae}=q,_e=()=>{const i=W(),[d,u]=l.useState(!1),[h,b]=l.useState([]),[p,a]=l.useState(1),[c,g]=l.useState(10),[f,S]=l.useState(0),[C,y]=l.useState(!1),[o,s]=l.useState(0),[m,x]=l.useState(!1),[R,N]=l.useState(!1),[A,B]=l.useState(0);l.useEffect(()=>{document.title="讲师/助教管理",i(Z("讲师/助教管理"))},[]),l.useEffect(()=>{U()},[p,c,C]);const U=()=>{d||(u(!0),J({page:p,size:c}).then(n=>{b(n.data.data),S(n.data.total),u(!1)}).catch(n=>{u(!1)}))},V={current:p,pageSize:c,total:f,onChange:(n,t)=>z(n,t),showSizeChanger:!0},z=(n,t)=>{a(n),g(t)},L=[{title:"讲师/助教ID",width:120,render:(n,t)=>e.jsx("span",{children:t.id})},{title:"讲师/助教",width:300,render:(n,t)=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"user-item d-flex",children:[e.jsx("div",{className:"avatar",children:e.jsx("img",{src:t.avatar,width:"40",height:"40"})}),e.jsx("div",{className:"ml-10",children:t.name})]})})},{title:"角色",width:120,render:(n,t)=>e.jsxs(e.Fragment,{children:[t.role_id>0&&e.jsx("span",{className:"c-green",children:t.role_name}),t.role_id===0&&e.jsx("span",{className:"c-yellow",children:t.role_name})]})},{title:"课程",width:150,render:(n,t)=>e.jsxs("span",{children:[t.courses_count,"个"]})},{title:"账号",render:(n,t)=>e.jsx("span",{children:t.username})},{title:"密码",render:(n,t)=>e.jsxs("div",{className:"d-flex",children:[e.jsx("div",{children:t.id===o?e.jsx("span",{children:t.password}):e.jsx("span",{children:"∗∗∗∗∗∗"})}),e.jsx("div",{className:"ml-10",children:e.jsx(H,{className:"eyes-link",onClick:()=>{o===t.id?s(0):s(t.id)}})})]})},{title:"操作",width:120,fixed:"right",render:(n,t)=>e.jsxs(w,{children:[e.jsx(F,{type:"link",text:"编辑",class:"c-primary",icon:null,p:"addons.Zhibo.teacher.update",onClick:()=>{B(t.id),N(!0)},disabled:null}),e.jsx(F,{type:"link",text:"删除",class:"c-red",icon:null,p:"addons.Zhibo.teacher.delete",onClick:()=>{O(t.id)},disabled:null})]})}],_=()=>{a(1),b([]),y(!C)},O=n=>{n!==0&&ae({title:"操作确认",icon:e.jsx(M,{}),content:"确认删除此讲师/助教？",centered:!0,okText:"确认",cancelText:"取消",onOk(){d||(u(!0),Q(n).then(()=>{u(!1),k.success("删除成功"),_()}).catch(t=>{u(!1)}))},onCancel(){console.log("Cancel")}})};return e.jsxs("div",{className:"meedu-main-body",children:[e.jsx(X,{title:"讲师/助教管理"}),e.jsx(ee,{open:m,onCancel:()=>x(!1),onSuccess:()=>{_(),x(!1)}}),e.jsx(se,{id:A,open:R,onCancel:()=>N(!1),onSuccess:()=>{_(),N(!1)}}),e.jsx("div",{className:"float-left  mt-30 mb-30",children:e.jsx(F,{type:"primary",text:"添加讲师/助教",class:"",icon:null,p:"addons.Zhibo.teacher.store",onClick:()=>x(!0),disabled:null})}),e.jsx("div",{className:"float-left",children:e.jsx(Y,{loading:d,columns:L,dataSource:h,rowKey:n=>n.id,pagination:V})})]})};export{_e as default};
