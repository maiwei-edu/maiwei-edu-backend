import{a7 as X,ad as V,r,aq as q,V as H,a5 as J,aF as Q,cd as U,bm as Y,aT as Z,ce as ee,az as ne,E as L,a0 as te,a1 as oe,a2 as se,a4 as ae,u as ie,t as re,cf as le,cg as ce,j as a,B as E,ch as de,m as P,ci as me,cj as pe,M as ue}from"./index-3fd54424.js";import{T as ge}from"./index-47408a6e.js";import{T as F}from"./Table-59a53b18.js";import"./PlusOutlined-18e71fec.js";import"./addEventListener-1752243f.js";import"./useIcons-235bc0cd.js";import"./CheckOutlined-44e74bd9.js";import"./Pagination-a2ebdf00.js";import"./LeftOutlined-a0f8cfa6.js";import"./useForceUpdate-56773729.js";import"./responsiveObserver-a0dea2e5.js";import"./index-ff4e3b6e.js";import"./index-a56efb1a.js";import"./iconUtil-14ff0944.js";const k=(n,e,t,o,i)=>({backgroundColor:n,border:`${o.lineWidth}px ${o.lineType} ${e}`,[`${i}-icon`]:{color:t}}),fe=n=>{const{componentCls:e,motionDurationSlow:t,marginXS:o,marginSM:i,fontSize:c,fontSizeLG:u,lineHeight:m,borderRadiusLG:g,motionEaseInOutCirc:p,withDescriptionIconSize:h,colorText:y,colorTextHeading:x,withDescriptionPadding:C,defaultPadding:S}=n;return{[e]:Object.assign(Object.assign({},V(n)),{position:"relative",display:"flex",alignItems:"center",padding:S,wordWrap:"break-word",borderRadius:g,[`&${e}-rtl`]:{direction:"rtl"},[`${e}-content`]:{flex:1,minWidth:0},[`${e}-icon`]:{marginInlineEnd:o,lineHeight:0},"&-description":{display:"none",fontSize:c,lineHeight:m},"&-message":{color:x},[`&${e}-motion-leave`]:{overflow:"hidden",opacity:1,transition:`max-height ${t} ${p}, opacity ${t} ${p},
        padding-top ${t} ${p}, padding-bottom ${t} ${p},
        margin-bottom ${t} ${p}`},[`&${e}-motion-leave-active`]:{maxHeight:0,marginBottom:"0 !important",paddingTop:0,paddingBottom:0,opacity:0}}),[`${e}-with-description`]:{alignItems:"flex-start",padding:C,[`${e}-icon`]:{marginInlineEnd:i,fontSize:h,lineHeight:0},[`${e}-message`]:{display:"block",marginBottom:o,color:x,fontSize:u},[`${e}-description`]:{display:"block",color:y}},[`${e}-banner`]:{marginBottom:0,border:"0 !important",borderRadius:0}}},he=n=>{const{componentCls:e,colorSuccess:t,colorSuccessBorder:o,colorSuccessBg:i,colorWarning:c,colorWarningBorder:u,colorWarningBg:m,colorError:g,colorErrorBorder:p,colorErrorBg:h,colorInfo:y,colorInfoBorder:x,colorInfoBg:C}=n;return{[e]:{"&-success":k(i,o,t,n,e),"&-info":k(C,x,y,n,e),"&-warning":k(m,u,c,n,e),"&-error":Object.assign(Object.assign({},k(h,p,g,n,e)),{[`${e}-description > pre`]:{margin:0,padding:0}})}}},ye=n=>{const{componentCls:e,iconCls:t,motionDurationMid:o,marginXS:i,fontSizeIcon:c,colorIcon:u,colorIconHover:m}=n;return{[e]:{"&-action":{marginInlineStart:i},[`${e}-close-icon`]:{marginInlineStart:i,padding:0,overflow:"hidden",fontSize:c,lineHeight:`${c}px`,backgroundColor:"transparent",border:"none",outline:"none",cursor:"pointer",[`${t}-close`]:{color:u,transition:`color ${o}`,"&:hover":{color:m}}},"&-close-text":{color:u,transition:`color ${o}`,"&:hover":{color:m}}}}},xe=n=>[fe(n),he(n),ye(n)],Ce=X("Alert",n=>[xe(n)],n=>({withDescriptionIconSize:n.fontSizeHeading3,defaultPadding:`${n.paddingContentVerticalSM}px 12px`,withDescriptionPadding:`${n.paddingMD}px ${n.paddingContentHorizontalLG}px`}));var be=globalThis&&globalThis.__rest||function(n,e){var t={};for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&e.indexOf(o)<0&&(t[o]=n[o]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,o=Object.getOwnPropertySymbols(n);i<o.length;i++)e.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(n,o[i])&&(t[o[i]]=n[o[i]]);return t};const Se={success:Z,info:ee,error:ne,warning:L},$e=n=>{const{icon:e,prefixCls:t,type:o}=n,i=Se[o]||null;return e?U(e,r.createElement("span",{className:`${t}-icon`},e),()=>({className:H(`${t}-icon`,{[e.props.className]:e.props.className})})):r.createElement(i,{className:`${t}-icon`})},ve=n=>{const{isClosable:e,prefixCls:t,closeIcon:o,handleClose:i}=n,c=o===!0||o===void 0?r.createElement(Y,null):o;return e?r.createElement("button",{type:"button",onClick:i,className:`${t}-close-icon`,tabIndex:0},c):null},je=n=>{const{description:e,prefixCls:t,message:o,banner:i,className:c,rootClassName:u,style:m,onMouseEnter:g,onMouseLeave:p,onClick:h,afterClose:y,showIcon:x,closable:C,closeText:S,closeIcon:f,action:w}=n,_=be(n,["description","prefixCls","message","banner","className","rootClassName","style","onMouseEnter","onMouseLeave","onClick","afterClose","showIcon","closable","closeText","closeIcon","action"]),[N,$]=r.useState(!1),z=r.useRef(null),{getPrefixCls:O,direction:B,alert:b}=r.useContext(q),d=O("alert",t),[T,M]=Ce(d),I=v=>{var j;$(!0),(j=n.onClose)===null||j===void 0||j.call(n,v)},s=r.useMemo(()=>n.type!==void 0?n.type:i?"warning":"info",[n.type,i]),l=r.useMemo(()=>S?!0:typeof C=="boolean"?C:f!==!1&&f!==null&&f!==void 0,[S,f,C]),A=i&&x===void 0?!0:x,W=H(d,`${d}-${s}`,{[`${d}-with-description`]:!!e,[`${d}-no-icon`]:!A,[`${d}-banner`]:!!i,[`${d}-rtl`]:B==="rtl"},b==null?void 0:b.className,c,u,M),K=J(_,{aria:!0,data:!0});return T(r.createElement(Q,{visible:!N,motionName:`${d}-motion`,motionAppear:!1,motionEnter:!1,onLeaveStart:v=>({maxHeight:v.offsetHeight}),onLeaveEnd:y},v=>{let{className:j,style:G}=v;return r.createElement("div",Object.assign({ref:z,"data-show":!N,className:H(W,j),style:Object.assign(Object.assign(Object.assign({},b==null?void 0:b.style),m),G),onMouseEnter:g,onMouseLeave:p,onClick:h,role:"alert"},K),A?r.createElement($e,{description:e,icon:n.icon,prefixCls:d,type:s}):null,r.createElement("div",{className:`${d}-content`},o?r.createElement("div",{className:`${d}-message`},o):null,e?r.createElement("div",{className:`${d}-description`},e):null),w?r.createElement("div",{className:`${d}-action`},w):null,r.createElement(ve,{isClosable:l,prefixCls:d,closeIcon:S||f,handleClose:I}))}))},D=je;let Ee=function(n){te(t,n);var e=oe(t);function t(){var o;return se(this,t),o=e.apply(this,arguments),o.state={error:void 0,info:{componentStack:""}},o}return ae(t,[{key:"componentDidCatch",value:function(i,c){this.setState({error:i,info:c})}},{key:"render",value:function(){const{message:i,description:c,children:u}=this.props,{error:m,info:g}=this.state,p=g&&g.componentStack?g.componentStack:null,h=typeof i>"u"?(m||"").toString():i,y=typeof c>"u"?p:c;return m?r.createElement(D,{type:"error",message:h,description:r.createElement("pre",{style:{fontSize:"0.9em",overflowX:"auto"}},y)}):u}}]),t}(r.Component);const we=Ee,R=D;R.ErrorBoundary=we;const Ne=R,{confirm:Ie}=ue,We=()=>{const n=ie(),[e,t]=r.useState(!1),[o,i]=r.useState([]),[c,u]=r.useState([]),[m,g]=r.useState(1),[p,h]=r.useState(100),[y,x]=r.useState(0),[C,S]=r.useState(!1),[f,w]=r.useState("local");r.useEffect(()=>{document.title="功能模块",n(re("功能模块"))},[]),r.useEffect(()=>{f==="repository"?$():f==="local"&&N()},[m,p,f,C]);const _=s=>{w(s),g(1)},N=()=>{e||(t(!0),le().then(s=>{i(s.data),t(!1)}).catch(s=>{t(!1)}))},$=()=>{e||(t(!0),ce({page:m,size:p}).then(s=>{u(s.data.data),x(s.data.total),t(!1)}).catch(s=>{t(!1)}))},z=[{title:"插件",render:(s,l)=>a.jsx("span",{children:l.name})},{title:"版本",width:200,dataIndex:"version",render:s=>a.jsx("span",{children:s})},{title:"操作",key:"action",fixed:"right",width:100,render:(s,l)=>a.jsxs(a.Fragment,{children:[l.is_buy&&a.jsxs(a.Fragment,{children:[!l.is_install&&a.jsx(E,{type:"link",size:"small",className:"b-n-link c-primary",onClick:()=>{T(l)},children:"安装"}),l.is_upgrade&&a.jsx(E,{type:"link",size:"small",className:"b-n-link c-primary",onClick:()=>{M(l)},children:"升级"})]}),!l.is_buy&&a.jsx("span",{className:"c-red",children:"无权限安装"})]})}],O=[{title:"插件",render:(s,l)=>a.jsx("span",{children:l.name})},{title:"本地版本",width:200,dataIndex:"version",render:s=>a.jsx("span",{children:s})},{title:"状态",width:150,dataIndex:"version",render:(s,l)=>a.jsx(a.Fragment,{children:l.enabled&&a.jsxs("span",{className:"status-success",children:[a.jsx("span",{className:"status-success-icon"}),a.jsx("span",{style:{color:"#66dd7b"},className:"ml-5",children:"运行中"})]})})},{title:"操作",key:"action",fixed:"right",width:100,render:(s,l)=>a.jsxs(a.Fragment,{children:[l.enabled&&a.jsxs(a.Fragment,{children:[a.jsx(E,{type:"link",size:"small",className:"b-n-link c-red",onClick:()=>{I(l,0)},children:"停用"}),l.index_url&&a.jsx(E,{type:"link",size:"small",className:"b-n-link c-primary ml-10",onClick:()=>{window.open(l.index_url)},children:"配置"})]}),!l.enabled&&a.jsx(E,{type:"link",size:"small",className:"b-n-link c-primary",onClick:()=>{I(l,1)},children:"启用"})]})}],B={current:m,pageSize:p,total:y,onChange:(s,l)=>b(s,l),showSizeChanger:!0},b=(s,l)=>{g(s),h(l)},d=[{key:"local",label:"本地已安装",children:a.jsx("div",{className:"float-left",children:a.jsx(F,{loading:e,columns:O,dataSource:o,rowKey:s=>s.sign,pagination:!1},"local")})},{key:"repository",label:"功能模块",children:a.jsx("div",{className:"float-left",children:a.jsx(F,{loading:e,columns:z,dataSource:c,rowKey:s=>s.id,pagination:B},"repository")})}],T=s=>{e||(t(!0),de({addons_id:s.id,addons_sign:s.sign}).then(()=>{t(!1),P.success("成功"),$()}).catch(l=>{t(!1)}))},M=s=>{Ie({title:"操作确认",icon:a.jsx(L,{}),content:"确认删除此课程？",centered:!0,okText:"确认",cancelText:"取消",onOk(){e||(t(!0),me({addons_id:s.id,addons_sign:s.sign}).then(()=>{t(!1),P.success("成功"),$()}).catch(l=>{t(!1)}))},onCancel(){console.log("Cancel")}})},I=(s,l)=>{e||(t(!0),pe({sign:s.sign,action:l===1?"enabled":"disabled"}).then(()=>{t(!1),P.success("成功"),location.reload()}).catch(A=>{t(!1)}))};return a.jsxs("div",{className:"meedu-main-body",children:[a.jsx("div",{className:"float-left mb-30",children:a.jsx(Ne,{style:{color:"#F56C6C"},message:"功能模块安装之后并不能直接使用，还需要切换到「本地已安装」列表，找到已安装的功能模块，点击「启用」。",type:"error",closable:!0})}),a.jsx("div",{className:"float-left",children:a.jsx(ge,{defaultActiveKey:f,items:d,onChange:_})})]})};export{We as default};
