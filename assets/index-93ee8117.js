import{u as J,b as Q,r as l,t as U,j as e,I as k,B as f,S,d as V,D as W,e as X,E as Y,m as Z,M as ee}from"./index-3fd54424.js";import{l as se,c as te,d as le}from"./course-c58bd7af.js";import{P as i}from"./index-df05a090.js";import{O as ae}from"./index-cbea6645.js";import{T as ie}from"./index-04a133fc.js";import{f as ne,a as re}from"./icon-filter-h-a57243b6.js";import{T as oe}from"./Table-59a53b18.js";import{D as ce}from"./index-88bdc632.js";import{S as de}from"./index-ff4e3b6e.js";import"./icon-option-c9fff0bb.js";import"./addEventListener-1752243f.js";import"./useIcons-235bc0cd.js";import"./CheckOutlined-44e74bd9.js";import"./Pagination-a2ebdf00.js";import"./LeftOutlined-a0f8cfa6.js";import"./useForceUpdate-56773729.js";import"./responsiveObserver-a0dea2e5.js";import"./index-a56efb1a.js";import"./iconUtil-14ff0944.js";const{confirm:ue}=ee,Te=()=>{const E=J(),n=Q(),[y,o]=l.useState(!1),[P,v]=l.useState([]),[C,d]=l.useState(1),[w,_]=l.useState(10),[z,B]=l.useState(0),[u,j]=l.useState(!1),[m,b]=l.useState(""),[p,N]=l.useState([]),[g,D]=l.useState(""),[O,L]=l.useState([]),[M,h]=l.useState(!1),[F,I]=l.useState(!1);l.useEffect(()=>{document.title="录播课",E(U("录播课")),R()},[]),l.useEffect(()=>{K()},[C,w,u]),l.useEffect(()=>{p&&p.length!==0||g||m?I(!0):I(!1)},[p,g,m]);const K=()=>{y||(o(!0),se({page:C,size:w,sort:"id",order:"desc",keywords:m,cid:p,id:g}).then(t=>{v(t.data.courses.data),B(t.data.courses.total),o(!1)}).catch(t=>{o(!1)}))},R=()=>{te().then(t=>{let s=t.data.categories;const r=[];for(let a=0;a<s.length;a++)if(s[a].children.length>0){r.push({label:s[a].name,value:s[a].id});let x=s[a].children;for(let c=0;c<x.length;c++)x[c].name="|----"+x[c].name,r.push({label:x[c].name,value:x[c].id})}else r.push({label:s[a].name,value:s[a].id});L(r)})},T=()=>{d(1),_(10),v([]),b(""),N([]),D(""),j(!u)},A={current:C,pageSize:w,total:z,onChange:(t,s)=>H(t,s),showSizeChanger:!0},H=(t,s)=>{d(t),_(s)},$=[{title:"ID",width:"6%",render:(t,s)=>e.jsx("span",{children:s.id})},{title:"课程",width:"30%",render:(t,s)=>e.jsx(ie,{width:120,value:s.thumb,height:90,title:s.title,border:4})},{title:"分类",width:"12%",render:(t,s)=>{var r;return e.jsxs(e.Fragment,{children:[s.category&&e.jsx("span",{children:((r=s==null?void 0:s.category)==null?void 0:r.name)||"-"}),!s.category&&e.jsx("span",{className:"c-red",children:"数据不完整"})]})}},{title:"价格",width:"8%",render:(t,s)=>e.jsxs("div",{children:[s.charge,"元"]})},{title:"销量",width:"8%",render:(t,s)=>e.jsx("span",{children:s.user_count})},{title:"上架时间",width:"14%",dataIndex:"published_at",render:t=>e.jsx("span",{children:V(t)})},{title:"是否显示",width:"8%",render:(t,s)=>e.jsxs(e.Fragment,{children:[s.is_show===1&&e.jsx("span",{className:"c-green",children:"· 显示"}),s.is_show!==1&&e.jsx("span",{className:"c-red",children:"· 隐藏"})]})},{title:"操作",width:"14%",fixed:"right",render:(t,s)=>{const r=[{key:"1",label:e.jsx(i,{type:"link",text:"编辑",class:"c-primary",icon:null,p:"course.update",onClick:()=>{n("/course/vod/update?id="+s.id)},disabled:null})},{key:"2",label:e.jsx(i,{type:"link",text:"附件",class:"c-primary",icon:null,p:"course_attach",onClick:()=>{n("/course/vod/attach/index?course_id="+s.id)},disabled:null})},{key:"3",label:e.jsx(i,{type:"link",text:"删除",class:"c-red",icon:null,p:"course.destroy",onClick:()=>{G(s.id)},disabled:null})}];return e.jsxs(S,{children:[e.jsx(i,{type:"link",text:"课时",class:"c-primary",icon:null,p:"video",onClick:()=>{n("/course/vod/video/index?course_id="+s.id+"&title="+s.title)},disabled:null}),e.jsx(i,{type:"link",text:"学员",class:"c-primary",icon:null,p:"course.subscribes",onClick:()=>{n("/course/vod/"+s.id+"/view")},disabled:null}),e.jsx(W,{menu:{items:r},children:e.jsx(f,{type:"link",className:"c-primary",onClick:a=>a.preventDefault(),children:e.jsxs(S,{size:"small",align:"center",children:["更多",e.jsx(X,{})]})})})]})}}],q=()=>{d(1),v([]),j(!u)},G=t=>{t!==0&&ue({title:"操作确认",icon:e.jsx(Y,{}),content:"确认删除此课程？",centered:!0,okText:"确认",cancelText:"取消",onOk(){y||(o(!0),le(t).then(()=>{o(!1),Z.success("删除成功"),q()}).catch(s=>{o(!1)}))},onCancel(){console.log("Cancel")}})};return e.jsxs("div",{className:"meedu-main-body",children:[e.jsxs("div",{className:"float-left j-b-flex mb-30",children:[e.jsxs("div",{className:"d-flex",children:[e.jsx(i,{type:"primary",text:"新建录播课",class:"",icon:null,p:"course.store",onClick:()=>n("/course/vod/create"),disabled:null}),e.jsx(i,{type:"primary",text:"录播课分类",class:"ml-10",icon:null,p:"courseCategory",onClick:()=>n("/course/vod/category/index"),disabled:null}),e.jsx(i,{type:"primary",text:"课程评论",class:"ml-10",icon:null,p:"course_comment",onClick:()=>n("/course/vod/components/vod-comments"),disabled:null}),e.jsx(i,{type:"primary",text:"课时评论",class:"ml-10",icon:null,p:"video_comment",onClick:()=>n("/course/vod/video/comments"),disabled:null}),e.jsx(i,{type:"primary",text:"课时批量导入",class:"ml-10",icon:null,p:"video.store",onClick:()=>n("/course/vod/video-import"),disabled:null}),e.jsx(ae,{text:"播放器配置",value:"/system/playerConfig?referer=%2Fcourse%2Fvod%2Findex"})]}),e.jsxs("div",{className:"d-flex",children:[e.jsx(k,{value:m,onChange:t=>{b(t.target.value)},allowClear:!0,style:{width:150},placeholder:"课程名称关键字"}),e.jsx(f,{className:"ml-10",onClick:T,children:"清空"}),e.jsx(f,{className:"ml-10",type:"primary",onClick:()=>{d(1),j(!u),h(!1)},children:"筛选"}),e.jsxs("div",{className:"drawerMore d-flex ml-10",onClick:()=>h(!0),children:[F&&e.jsxs(e.Fragment,{children:[e.jsx("img",{src:ne}),e.jsx("span",{className:"act",children:"已选"})]}),!F&&e.jsxs(e.Fragment,{children:[e.jsx("img",{src:re}),e.jsx("span",{children:"更多"})]})]})]})]}),e.jsx("div",{className:"float-left",children:e.jsx(oe,{loading:y,columns:$,dataSource:P,rowKey:t=>t.id,pagination:A})}),M?e.jsx(ce,{title:"更多筛选",onClose:()=>h(!1),maskClosable:!1,open:!0,footer:e.jsxs(S,{className:"j-b-flex",children:[e.jsx(f,{onClick:()=>{T(),h(!1)},children:"清空"}),e.jsx(f,{onClick:()=>{d(1),j(!u),h(!1)},type:"primary",children:"筛选"})]}),width:360,children:e.jsxs("div",{className:"float-left",children:[e.jsx(k,{value:m,onChange:t=>{b(t.target.value)},allowClear:!0,placeholder:"课程名称关键字"}),e.jsx(de,{style:{width:"100%",marginTop:20},value:p,onChange:t=>{N(t)},allowClear:!0,placeholder:"分类",options:O}),e.jsx(k,{style:{marginTop:20},value:g,onChange:t=>{D(t.target.value)},allowClear:!0,placeholder:"课程ID"})]})}):null]})};export{Te as default};
