import{u as N,b as q,r,t as k,j as e,B as p,S as a,I as h,m as o,h as g}from"./index-3fd54424.js";import{s as F}from"./tuangou-cc2a4f55.js";import{B as H}from"./index-c3c15456.js";import{H as l}from"./index-d5d1e443.js";import{S as M}from"./index-28ac63f6.js";import{F as s}from"./index-0ca68444.js";import{D as R}from"./index-a9db941d.js";import"./LeftOutlined-a0f8cfa6.js";import"./InfoCircleOutlined-fefc69ce.js";import"./course-c58bd7af.js";import"./Table-59a53b18.js";import"./addEventListener-1752243f.js";import"./useIcons-235bc0cd.js";import"./CheckOutlined-44e74bd9.js";import"./Pagination-a2ebdf00.js";import"./useForceUpdate-56773729.js";import"./responsiveObserver-a0dea2e5.js";import"./index-ff4e3b6e.js";import"./index-a56efb1a.js";import"./iconUtil-14ff0944.js";import"./live-9d1ed6d0.js";import"./role-ccbd4852.js";import"./book-3be45c7b.js";import"./path-1a3bf99e.js";import"./topic-e7e1a389.js";import"./paper-57a0cabd.js";import"./practice-c882748e.js";import"./mock-e0c98417.js";import"./index-47408a6e.js";import"./PlusOutlined-18e71fec.js";import"./row-98a37fbf.js";const{RangePicker:T}=R,he=()=>{const[m]=s.useForm(),j=N(),u=q(),[n,c]=r.useState(!1),[i,f]=r.useState(""),[b,_]=r.useState(""),[y,x]=r.useState(""),[S,w]=r.useState(""),[C,d]=r.useState(!1);r.useEffect(()=>{document.title="新建团购活动",j(k("新建团购活动"))},[]);const Y=t=>{if(!n){if(t.charge<0){o.error("请输入正确的团购价");return}if(t.people_num<2){o.error("组团成功人数最少为2个");return}if(t.time_limit<0){o.error("请输入正确的有效期");return}c(!0),t.goods_type=y,t.original_charge=S,t.goods_title=i,t.goods_thumb=b,t.other_id=t.goods_id,t.ended_at=g(new Date(t.started_at[1])).format("YYYY-MM-DD HH:mm"),t.started_at=g(new Date(t.started_at[0])).format("YYYY-MM-DD HH:mm"),F(t).then(I=>{c(!1),o.success("保存成功！"),u(-1)}).catch(I=>{c(!1)})}},D=t=>{console.log("Failed:",t)};return e.jsxs("div",{className:"meedu-main-body",children:[e.jsx(H,{title:"新建团购活动"}),e.jsx(M,{open:C,enabledResource:"vod,live,book,learnPath",onCancel:()=>d(!1),onSelected:t=>{m.setFieldsValue({goods_id:t.id}),f(t.title),_(t.thumb),t.resource_type==="vod"?x("course"):x(t.resource_type),w(t.original_charge),d(!1)}}),e.jsx("div",{className:"float-left mt-30",children:e.jsxs(s,{form:m,name:"tuangou-create",labelCol:{span:3},wrapperCol:{span:21},initialValues:{remember:!0},onFinish:Y,onFinishFailed:D,autoComplete:"off",children:[e.jsx(s.Item,{label:"商品",name:"goods_id",rules:[{required:!0,message:"请选择商品!"}],children:e.jsxs(p,{loading:n,type:"primary",onClick:()=>d(!0),children:[i&&e.jsxs("span",{children:["已选择「",i,"」"]}),!i&&e.jsx("span",{children:"选择商品"})]})}),e.jsx(s.Item,{label:"团购价",name:"charge",rules:[{required:!0,message:"请输入团购价!"}],children:e.jsxs(a,{align:"baseline",style:{height:32},children:[e.jsx(s.Item,{name:"charge",rules:[{required:!0,message:"请输入团购价!"}],children:e.jsx(h,{style:{width:300},placeholder:"请输入团购价",allowClear:!0,type:"number"})}),e.jsx("div",{className:"ml-10",children:e.jsx(l,{text:"最小单位：元。不支持小数。"})})]})}),e.jsx(s.Item,{label:"组团成功人数",name:"people_num",rules:[{required:!0,message:"请输入组团成功人数!"}],children:e.jsxs(a,{align:"baseline",style:{height:32},children:[e.jsx(s.Item,{name:"people_num",rules:[{required:!0,message:"请输入组团成功人数!"}],children:e.jsx(h,{type:"number",style:{width:300},placeholder:"请输入组团成功人数",allowClear:!0})}),e.jsx("div",{className:"ml-10",children:e.jsx(l,{text:"组团达到指定人数即为组团成功。原则上最少为2个人。"})})]})}),e.jsx(s.Item,{label:"有效期",name:"time_limit",rules:[{required:!0,message:"请输入有效期!"}],children:e.jsxs(a,{align:"baseline",style:{height:32},children:[e.jsx(s.Item,{name:"time_limit",rules:[{required:!0,message:"请输入有效期!"}],children:e.jsx(h,{type:"number",style:{width:300},placeholder:"单位：天",allowClear:!0})}),e.jsx("div",{className:"ml-10",children:e.jsx(l,{text:"团长开团时刻起多少天内有效，失败的话将自动转为退款订单"})})]})}),e.jsx(s.Item,{label:"活动时间",required:!0,children:e.jsxs(a,{align:"baseline",style:{height:32},children:[e.jsx(s.Item,{name:"started_at",rules:[{required:!0,message:"请输入活动时间!"}],children:e.jsx(T,{format:"YYYY-MM-DD HH:mm",showTime:!0,placeholder:["开始时间","结束时间"]})}),e.jsx("div",{className:"ml-10",children:e.jsx(l,{text:"团购开始时间，时间达到之后，学员才能参与团购"})})]})})]})}),e.jsx("div",{className:"bottom-menus",children:e.jsxs("div",{className:"bottom-menus-box",children:[e.jsx("div",{children:e.jsx(p,{loading:n,type:"primary",onClick:()=>m.submit(),children:"保存"})}),e.jsx("div",{className:"ml-24",children:e.jsx(p,{type:"default",onClick:()=>u(-1),children:"取消"})})]})})]})};export{he as default};
