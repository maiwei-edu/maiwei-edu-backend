import{f as H,u as M,b as N,r as s,t as F,j as e,g as C,I,B as u,h,m as k}from"./index-b4683d61.js";import{a as E,u as S}from"./codeExchanger-b570ffd4.js";import{B as v}from"./index-5f967da4.js";import{d as p,D as f}from"./index-cc7d88a3.js";import{F as r}from"./index-d434f3eb.js";import"./LeftOutlined-9e6e73a2.js";import"./row-4ee18533.js";import"./responsiveObserver-dc429d3b.js";const A=()=>{const n=new URLSearchParams(H().search),[o]=r.useForm(),x=M(),m=N(),[d,Y]=s.useState(!0),[c,l]=s.useState(!1),[i,j]=s.useState(Number(n.get("id"))),[D,g]=s.useState("");s.useEffect(()=>{document.title="编辑兑换活动",x(F("编辑兑换活动")),b()},[i]),s.useEffect(()=>{j(Number(n.get("id")))},[n.get("id")]);const b=async()=>{await _(),Y(!1)},_=async()=>{if(i===0)return;var a=(await E(i)).data;g(a.relate_data),o.setFieldsValue({name:a.name,start_at:p(a.start_at,"YYYY-MM-DD HH:mm"),end_at:p(a.end_at,"YYYY-MM-DD HH:mm")})},w=t=>{c||(l(!0),t.relate_data=D,t.start_at=h(new Date(t.start_at)).format("YYYY-MM-DD HH:mm"),t.end_at=h(new Date(t.end_at)).format("YYYY-MM-DD HH:mm"),S(i,t).then(a=>{l(!1),k.success("保存成功！"),m(-1)}).catch(a=>{l(!1)}))},y=t=>{console.log("Failed:",t)};return e.jsxs("div",{className:"meedu-main-body",children:[e.jsx(v,{title:"编辑兑换活动"}),d&&e.jsx("div",{className:"float-left text-center mt-30",children:e.jsx(C,{})}),e.jsxs("div",{style:{display:d?"none":"block"},className:"float-left mt-30",children:[e.jsxs(r,{form:o,name:"codeExchanger-update",labelCol:{span:3},wrapperCol:{span:21},initialValues:{remember:!0},onFinish:w,onFinishFailed:y,autoComplete:"off",children:[e.jsx(r.Item,{label:"活动名称",name:"name",rules:[{required:!0,message:"请输入活动名称!"}],children:e.jsx(I,{style:{width:300},placeholder:"请输入活动名称",allowClear:!0})}),e.jsx(r.Item,{label:"活动开始时间",name:"start_at",rules:[{required:!0,message:"请选择开始时间!"}],children:e.jsx(f,{format:"YYYY-MM-DD HH:mm",style:{width:300},showTime:!0,placeholder:"请选择开始时间"})}),e.jsx(r.Item,{label:"活动结束时间",name:"end_at",rules:[{required:!0,message:"请选择结束时间!"}],children:e.jsx(f,{format:"YYYY-MM-DD HH:mm",style:{width:300},showTime:!0,placeholder:"请选择结束时间"})})]}),e.jsx("div",{className:"bottom-menus",children:e.jsxs("div",{className:"bottom-menus-box",children:[e.jsx("div",{children:e.jsx(u,{loading:c,type:"primary",onClick:()=>o.submit(),children:"保存"})}),e.jsx("div",{className:"ml-24",children:e.jsx(u,{type:"default",onClick:()=>m(-1),children:"取消"})})]})})]})]})};export{A as default};
