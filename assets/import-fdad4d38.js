import{u as y,b,r as n,t as v,j as e,B as l,m as w,i as B}from"./index-b4683d61.js";import{i as N}from"./question-10c27e70.js";import{r as k,u as S}from"./xlsx-b055c42d.js";import{B as U}from"./index-5f967da4.js";import{U as E}from"./index-9c2b15e9.js";import"./LeftOutlined-9e6e73a2.js";import"./Dragger-1df363a5.js";import"./useForceUpdate-f2aff5e0.js";import"./DeleteOutlined-8e7e99fd.js";import"./CheckOutlined-e6bc730e.js";const Q=()=>{const c=y(),d=b(),[o,t]=n.useState(!1);n.useEffect(()=>{document.title="试题批量导入",c(v("试题批量导入"))},[]);const m={accept:".xls,.xlsx,application/vnd.ms-excel",beforeUpload:s=>{if(o)return;t(!0);const a=s,r=new FileReader;return r.onload=f=>{const h=f.target.result,i=k(h,{type:"binary"}),j=i.Sheets[i.SheetNames[0]],g=S.sheet_to_json(j,{header:1});p(g)},r.readAsBinaryString(a),!1}},p=(s,a)=>{s.splice(0,2),u(s)},u=s=>{N({line:3,data:s}).then(()=>{t(!1),w.success("导入成功！"),d(-1)}).catch(a=>{t(!1)})},x=()=>{let s=B()+"/template/试题批量导入模板.xlsx";window.open(s)};return e.jsxs("div",{className:"meedu-main-body",children:[e.jsx(U,{title:"试题批量导入"}),e.jsx("div",{className:"user-import-box",children:e.jsxs("div",{className:"float-left d-flex mb-30x",children:[e.jsx("div",{children:e.jsx(E,{...m,showUploadList:!1,children:e.jsx(l,{loading:o,type:"primary",children:"导入表格"})})}),e.jsx("div",{className:"ml-30",children:e.jsx(l,{type:"link",className:"c-primary",onClick:()=>x(),children:"下载「试题批量导入模板」"})})]})})]})};export{Q as default};
