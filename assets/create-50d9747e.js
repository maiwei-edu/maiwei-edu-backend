import{u as S,b as _,r as m,t as q,j as e,S as c,I as d,B as g,h as k,m as P}from"./index-3fd54424.js";import{c as B,s as D}from"./path-1a3bf99e.js";import{B as Y}from"./index-c3c15456.js";import{P as H}from"./index-df05a090.js";import{H as p}from"./index-d5d1e443.js";import{U as V}from"./index-edf85c8b.js";import{F as s}from"./index-0ca68444.js";import{S as M}from"./index-ff4e3b6e.js";import{R as T,C as b}from"./row-98a37fbf.js";import{D as E}from"./index-a9db941d.js";import{S as L}from"./index-27712364.js";import"./LeftOutlined-a0f8cfa6.js";import"./InfoCircleOutlined-fefc69ce.js";import"./InboxOutlined-35d156a9.js";import"./selected-7e6221ce.js";import"./Dragger-3ad849c3.js";import"./useForceUpdate-56773729.js";import"./DeleteOutlined-529a4ffa.js";import"./CheckOutlined-44e74bd9.js";import"./useIcons-235bc0cd.js";import"./Pagination-a2ebdf00.js";import"./responsiveObserver-a0dea2e5.js";const me=()=>{const f=S(),h=_(),[r]=s.useForm(),[x,u]=m.useState(!1),[w,y]=m.useState([]),[j,C]=m.useState("");m.useEffect(()=>{document.title="新建学习路径",f(q("新建学习路径")),r.setFieldsValue({is_show:1}),I()},[]);const I=()=>{B().then(t=>{let a=t.data.categories;const n=[];for(let l=0;l<a.length;l++)if(a[l].children.length>0){n.push({label:a[l].name,value:a[l].id});let o=a[l].children;for(let i=0;i<o.length;i++)o[i].name="|----"+o[i].name,n.push({label:o[i].name,value:o[i].id})}else n.push({label:a[l].name,value:a[l].id});y(n)})},v=t=>{x||(u(!0),t.published_at=k(new Date(t.published_at)).format("YYYY-MM-DD HH:mm"),D(t).then(a=>{u(!1),P.success("成功！"),h(-1)}).catch(a=>{u(!1)}))},F=t=>{console.log("Failed:",t)},N=t=>{t?r.setFieldsValue({is_show:1}):r.setFieldsValue({is_show:0})};return e.jsxs("div",{className:"meedu-main-body",children:[e.jsx(Y,{title:"新建学习路径"}),e.jsxs("div",{className:"float-left mt-30",children:[e.jsxs(s,{form:r,name:"learnPath-create",labelCol:{span:3},wrapperCol:{span:21},initialValues:{remember:!0},onFinish:v,onFinishFailed:F,autoComplete:"off",children:[e.jsx(s.Item,{label:"所属分类",name:"category_id",rules:[{required:!0,message:"请选择所属分类!"}],children:e.jsxs(c,{align:"baseline",style:{height:32},children:[e.jsx(s.Item,{name:"category_id",rules:[{required:!0,message:"请选择所属分类!"}],children:e.jsx(M,{style:{width:300},allowClear:!0,placeholder:"请选择所属分类",options:w})}),e.jsx(H,{type:"link",text:"分类管理",class:"c-primary",icon:null,p:"addons.learnPaths.category.list",onClick:()=>{h("/learningpath/path/category/index")},disabled:null})]})}),e.jsx(s.Item,{label:"路径名称",name:"name",rules:[{required:!0,message:"请输入路径名称!"}],children:e.jsx(d,{style:{width:300},placeholder:"请输入路径名称",allowClear:!0})}),e.jsx(s.Item,{label:"路径封面",name:"thumb",rules:[{required:!0,message:"请上传路径封面!"}],children:e.jsxs(c,{align:"baseline",style:{height:32},children:[e.jsx(s.Item,{name:"thumb",rules:[{required:!0,message:"请上传路径封面!"}],children:e.jsx(V,{text:"选择图片",onSelected:t=>{r.setFieldsValue({thumb:t}),C(t)}})}),e.jsx("div",{className:"ml-10",children:e.jsx(p,{text:"长宽比4:3，建议尺寸：400x300像素"})})]})}),j&&e.jsxs(T,{style:{marginBottom:22},children:[e.jsx(b,{span:3}),e.jsx(b,{span:21,children:e.jsx("div",{className:"normal-thumb-box",style:{backgroundImage:`url(${j})`,width:200,height:150}})})]}),e.jsx(s.Item,{label:"原价",name:"original_charge",rules:[{required:!0,message:"请输入原价!"}],children:e.jsx(d,{type:"number",style:{width:300},placeholder:"单位：元",allowClear:!0})}),e.jsx(s.Item,{label:"现价",name:"charge",rules:[{required:!0,message:"请输入现价!"}],children:e.jsx(d,{type:"number",style:{width:300},placeholder:"单位：元",allowClear:!0})}),e.jsx(s.Item,{label:"上架时间",required:!0,children:e.jsxs(c,{align:"baseline",style:{height:32},children:[e.jsx(s.Item,{name:"published_at",rules:[{required:!0,message:"请选择上架时间!"}],children:e.jsx(E,{format:"YYYY-MM-DD HH:mm",style:{width:300},showTime:!0,placeholder:"请选择上架时间"})}),e.jsx("div",{className:"ml-10",children:e.jsx(p,{text:"上架时间越晚，排序越靠前"})})]})}),e.jsx(s.Item,{label:"显示",name:"is_show",children:e.jsxs(c,{align:"baseline",style:{height:32},children:[e.jsx(s.Item,{name:"is_show",valuePropName:"checked",children:e.jsx(L,{onChange:N})}),e.jsx("div",{className:"ml-10",children:e.jsx(p,{text:"关闭后此路径在前台隐藏显示"})})]})}),e.jsx(s.Item,{label:"简短介绍",name:"desc",rules:[{required:!0,message:"请输入简短介绍!"}],children:e.jsx(d.TextArea,{style:{width:800},placeholder:"请输入简短介绍",allowClear:!0,rows:4,maxLength:150,showCount:!0})})]}),e.jsx("div",{className:"bottom-menus",children:e.jsxs("div",{className:"bottom-menus-box",children:[e.jsx("div",{children:e.jsx(g,{loading:x,type:"primary",onClick:()=>r.submit(),children:"保存"})}),e.jsx("div",{className:"ml-24",children:e.jsx(g,{type:"default",onClick:()=>h(-1),children:"取消"})})]})})]})]})};export{me as default};
