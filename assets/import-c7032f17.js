import{u as y,b as v,r as n,t as b,j as e,B as l,m as c}from"./index-b4683d61.js";import{i as g}from"./promocode-79347298.js";import{B as w}from"./index-5f967da4.js";import{r as B,u as N}from"./xlsx-b055c42d.js";import{U as E}from"./index-9c2b15e9.js";import"./LeftOutlined-9e6e73a2.js";import"./Dragger-1df363a5.js";import"./useForceUpdate-f2aff5e0.js";import"./DeleteOutlined-8e7e99fd.js";import"./CheckOutlined-e6bc730e.js";const _={"user-import-box":"_user-import-box_4t6em_1"},F=()=>{const m=y(),d=v(),[p,o]=n.useState(!1);n.useEffect(()=>{document.title="优惠码批量导入",m(b("优惠码批量导入"))},[]);const u={accept:".xls,.xlsx,application/vnd.ms-excel",beforeUpload:t=>{const s=t,r=new FileReader;return r.onload=a=>{const x=new Uint8Array(a.target.result),j=B(x,{type:"array",cellDates:!0});let i=f(j);if(i.length===0){c.error("数据为空");return}h(i)},r.readAsArrayBuffer(s),!1}},f=t=>{let s=[];return t.SheetNames.forEach(r=>{var a=N.sheet_to_json(t.Sheets[r],{header:1});a.length&&s.push(...a)}),s},h=t=>{p||(o(!0),g({data:t}).then(()=>{o(!1),c.success("导入成功！"),d(-1)}).catch(s=>{o(!1)}))};return e.jsxs("div",{className:"meedu-main-body",children:[e.jsx(w,{title:"优惠码批量导入"}),e.jsx("div",{className:_["user-import-box"],children:e.jsxs("div",{className:"float-left d-flex mb-15",children:[e.jsx("div",{children:e.jsx(E,{...u,children:e.jsx(l,{type:"primary",children:"选择Excel表格文件"})})}),e.jsx("div",{className:"ml-30",children:e.jsx(l,{type:"link",onClick:()=>{window.open("https://www.yuque.com/meedu/fvvkbf/lpwsry")},children:"点击链接下载「优惠码批量导入模板」"})})]})})]})};export{F as default};
