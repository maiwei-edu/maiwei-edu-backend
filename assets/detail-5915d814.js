import{r as a,j as e,M as z,S as H,I as A,m as L,b as Q,B,d as N,a as q,u as re,k as le,t as de,E as oe}from"./index-3fd54424.js";import{g as ce,I as ue,c as X,t as he,r as me,h as fe,i as ge,j as xe,k as pe,m as je,n as _e,o as we,p as be,q as Se,v as ve,e as Ce}from"./member-4894e8dc.js";import{B as ke}from"./index-c3c15456.js";import{P as O}from"./index-df05a090.js";import{M as Ne}from"./update-9dff7942.js";import{H as Y}from"./index-d5d1e443.js";import{F as k}from"./index-0ca68444.js";import{S as ye}from"./index-ff4e3b6e.js";import{Q as Ie}from"./index-019b594b.js";import{T as P}from"./index-04a133fc.js";import{p as Fe}from"./default-paper-c83eabd4.js";import{v as Te}from"./default-vip-add1d1c7.js";import{T as F}from"./Table-59a53b18.js";import{l as Re}from"./snapshot-f665cacc.js";import{D as M}from"./index-423292da.js";import{S as Oe}from"./index-035ffcb5.js";import{T as ze}from"./index-2c039b27.js";import{R as J}from"./index-a56efb1a.js";import"./LeftOutlined-a0f8cfa6.js";import"./index-a9db941d.js";import"./index-edf85c8b.js";import"./InboxOutlined-35d156a9.js";import"./selected-7e6221ce.js";import"./Dragger-3ad849c3.js";import"./useForceUpdate-56773729.js";import"./DeleteOutlined-529a4ffa.js";import"./CheckOutlined-44e74bd9.js";import"./row-98a37fbf.js";import"./responsiveObserver-a0dea2e5.js";import"./useIcons-235bc0cd.js";import"./Pagination-a2ebdf00.js";import"./InfoCircleOutlined-fefc69ce.js";import"./index-749454db.js";import"./addEventListener-1752243f.js";import"./iconUtil-14ff0944.js";import"./index-0e80bad7.js";const De="_buttons_1wxj9_55",Pe="_large_1wxj9_97",Le="_item_1wxj9_100",m={"user-main-body":"_user-main-body_1wxj9_1","user-info-box":"_user-info-box_1wxj9_6","user-base-info-box":"_user-base-info-box_1wxj9_16","user-avatar":"_user-avatar_1wxj9_26","user-info":"_user-info_1wxj9_6","user-nickname":"_user-nickname_1wxj9_44",buttons:De,"real-profile":"_real-profile_1wxj9_64","edit-profile":"_edit-profile_1wxj9_70","panel-info-box":"_panel-info-box_1wxj9_76","panel-info-item":"_panel-info-item_1wxj9_86",large:Pe,item:Le,"item-box":"_item-box_1wxj9_105","remark-text":"_remark-text_1wxj9_110"},Ve=n=>{const[l]=k.useForm(),[r,u]=a.useState(!1);a.useEffect(()=>{n.open&&l.setFieldsValue({credit1:"",remark:""})},[n.open]);const f=g=>{if(r)return;u(!0);let d={user_id:n.id};Object.assign(d,g),ce(d).then(o=>{u(!1),L.success("成功！"),n.onSuccess()}).catch(o=>{u(!1)})},i=g=>{console.log("Failed:",g)};return e.jsx(e.Fragment,{children:n.open?e.jsx(z,{title:"积分变动",onCancel:()=>{n.onCancel()},open:!0,width:800,maskClosable:!1,onOk:()=>{l.submit()},centered:!0,children:e.jsx("div",{className:"float-left mt-30",children:e.jsxs(k,{form:l,name:"credit-dailog",labelCol:{span:3},wrapperCol:{span:21},initialValues:{remember:!0},onFinish:f,onFinishFailed:i,autoComplete:"off",children:[e.jsx(k.Item,{label:"变动额度",name:"credit1",rules:[{required:!0,message:"请输入变动额度!"}],children:e.jsxs(H,{align:"baseline",style:{height:32},children:[e.jsx(k.Item,{name:"credit1",rules:[{required:!0,message:"请输入变动额度!"}],children:e.jsx(A,{type:"number",style:{width:300},placeholder:"请输入变动额度",allowClear:!0})}),e.jsx("div",{className:"ml-10",children:e.jsx(Y,{text:"正数增加积分，负数减少积分"})})]})}),e.jsx(k.Item,{label:"变动说明",name:"remark",rules:[{required:!0,message:"请输入变动说明!"}],children:e.jsx(A.TextArea,{style:{width:300},placeholder:"请输入变动说明",allowClear:!0,rows:3})})]})})}):null})},Ee=n=>{const[l]=k.useForm(),[r,u]=a.useState(!1);a.useEffect(()=>{n.open&&l.setFieldsValue({amount:"",remark:""})},[n.open]);const f=g=>{if(r)return;u(!0);let d={user_id:n.id};Object.assign(d,g),ue(d).then(o=>{u(!1),L.success("成功！"),n.onSuccess()}).catch(o=>{u(!1)})},i=g=>{console.log("Failed:",g)};return e.jsx(e.Fragment,{children:n.open?e.jsx(z,{title:"变动iOS余额",onCancel:()=>{n.onCancel()},open:!0,width:800,maskClosable:!1,onOk:()=>{l.submit()},centered:!0,children:e.jsx("div",{className:"float-left mt-30",children:e.jsxs(k,{form:l,name:"IOS-dailog",labelCol:{span:3},wrapperCol:{span:21},initialValues:{remember:!0},onFinish:f,onFinishFailed:i,autoComplete:"off",children:[e.jsx(k.Item,{label:"变动额度",name:"amount",rules:[{required:!0,message:"请输入变动额度!"}],children:e.jsxs(H,{align:"baseline",style:{height:32},children:[e.jsx(k.Item,{name:"amount",rules:[{required:!0,message:"请输入变动额度!"}],children:e.jsx(A,{type:"number",style:{width:300},placeholder:"请输入变动额度",allowClear:!0})}),e.jsx("div",{className:"ml-10",children:e.jsx(Y,{text:"正数增加iOS余额，负数减少iOS余额"})})]})}),e.jsx(k.Item,{label:"变动说明",name:"remark",rules:[{required:!0,message:"请输入变动说明!"}],children:e.jsx(A.TextArea,{style:{width:300},placeholder:"请输入变动说明",allowClear:!0,rows:3})})]})})}):null})},Ue=n=>{const[l]=k.useForm(),r=Q(),[u,f]=a.useState(!1);a.useEffect(()=>{n.open&&l.setFieldsValue({tag_ids:[]}),n.id&&i()},[n.open,n.id]);const i=()=>{X(n.id).then(o=>{let c=[];if(o.data.tags)for(let x=0;x<o.data.tags.length;x++)c.push(o.data.tags[x].id);l.setFieldsValue({tag_ids:c})})},g=o=>{u||(f(!0),he(n.id,{tag_ids:o.tag_ids.join(",")}).then(c=>{f(!1),L.success("成功！"),n.onSuccess()}).catch(c=>{f(!1)}))},d=o=>{console.log("Failed:",o)};return e.jsx(e.Fragment,{children:n.open?e.jsx(z,{title:"修改标签",onCancel:()=>{n.onCancel()},open:!0,width:800,maskClosable:!1,onOk:()=>{l.submit()},centered:!0,children:e.jsx("div",{className:"float-left mt-30",children:e.jsx(k,{form:l,name:"tags-dailog",labelCol:{span:3},wrapperCol:{span:21},initialValues:{remember:!0},onFinish:g,onFinishFailed:d,autoComplete:"off",children:e.jsx(k.Item,{label:"学员标签",name:"tag_ids",children:e.jsxs(H,{align:"baseline",style:{height:32},children:[e.jsx(k.Item,{name:"tag_ids",children:e.jsx(ye,{style:{width:300},mode:"multiple",allowClear:!0,placeholder:"请选择学员标签",options:n.tags})}),e.jsx("div",{children:e.jsx(B,{type:"link",className:"c-primary",onClick:()=>r("/member/tag/index"),children:"标签管理"})})]})})})})}):null})},We=n=>{const[l]=k.useForm();Q();const[r,u]=a.useState(!1),[f,i]=a.useState("");a.useEffect(()=>{n.open&&l.setFieldsValue({remark:""}),n.id&&g()},[n.open,n.id]);const g=()=>{X(n.id).then(c=>{l.setFieldsValue({remark:c.data.remark?c.data.remark.remark:""}),i(c.data.remark?c.data.remark.remark:"")})},d=c=>{r||(u(!0),me(n.id,c).then(x=>{u(!1),L.success("成功！"),n.onSuccess()}).catch(x=>{u(!1)}))},o=c=>{console.log("Failed:",c)};return e.jsx(e.Fragment,{children:n.open?e.jsx(z,{title:"修改备注",onCancel:()=>{n.onCancel()},open:!0,width:800,maskClosable:!1,onOk:()=>{l.submit()},centered:!0,children:e.jsx("div",{className:"float-left mt-30",children:e.jsx(k,{form:l,name:"remark-dailog",labelCol:{span:3},wrapperCol:{span:21},initialValues:{remember:!0},onFinish:d,onFinishFailed:o,autoComplete:"off",children:e.jsx(k.Item,{label:"学员备注",name:"remark",style:{height:240},children:e.jsx(Ie,{mode:"remark",height:200,defautValue:f,isFormula:!1,setContent:c=>{l.setFieldsValue({remark:c})}})})})})}):null})},Ae=n=>{const[l,r]=a.useState(!1),[u,f]=a.useState([]),[i,g]=a.useState(1),[d,o]=a.useState(8),[c,x]=a.useState(0),[S,I]=a.useState(!1);a.useEffect(()=>{v()},[n.id,i,d,S]);const v=()=>{l||(r(!0),fe(n.id,{page:i,size:d,status:9}).then(s=>{f(s.data.data.data),x(s.data.data.total),r(!1)}).catch(s=>{r(!1)}))},_={current:i,pageSize:d,total:c,onChange:(s,t)=>C(s,t),showSizeChanger:!0},C=(s,t)=>{g(s),o(t)},w=[{title:"订单编号",width:200,render:(s,t)=>e.jsx("span",{children:t.order_id})},{title:"订单商品",render:(s,t)=>e.jsx(e.Fragment,{children:t.goods.map(b=>e.jsx("div",{children:b.goods_type==="BOOK"?e.jsx(P,{value:b.goods_thumb,width:67.5,height:90,title:b.goods_name,border:4}):b.goods_type==="模拟试卷"||b.goods_type==="试卷"||b.goods_type==="练习"?e.jsx(P,{value:Fe,width:120,height:90,title:b.goods_name,border:4}):b.goods_type==="ROLE"?e.jsx(P,{value:Te,width:120,height:90,title:b.goods_name,border:4}):e.jsx(P,{value:b.goods_thumb,width:120,height:90,title:b.goods_name,border:4})},b.id))})},{title:"支付金额",width:200,render:(s,t)=>e.jsx("span",{children:t.charge})},{title:"付款时间",width:200,dataIndex:"created_at",render:s=>e.jsx("span",{children:N(s)})}];return e.jsx("div",{className:"float-left",children:e.jsx(F,{loading:l,columns:w,dataSource:u,rowKey:s=>s.id,pagination:_})})},Be=n=>{const[l,r]=a.useState(!1),[u,f]=a.useState([]),[i,g]=a.useState({}),[d,o]=a.useState(!1),[c,x]=a.useState(0),S=q(s=>s.enabledAddonsConfig.value.enabledAddons);a.useEffect(()=>{n.id!==0&&n.open&&n.userId&&n.id&&v()},[n.open,n.userId,n.id]);const I=[{title:"课时名称",width:"20%",render:(s,t)=>e.jsx("span",{children:t.title})},{title:"课时时长",width:"13%",render:(s,t)=>e.jsx(M,{duration:t.duration})},{title:"已学时长",width:"13%",render:(s,t)=>e.jsx(e.Fragment,{children:typeof t.watch_record.watch_seconds<"u"?e.jsx(M,{duration:t.watch_record.watch_seconds}):e.jsx("span",{children:"-"})})},{title:"是否学完",width:"10%",render:(s,t)=>e.jsx(e.Fragment,{children:typeof t.watch_record.watched_at<"u"&&t.watch_record.watched_at?e.jsx("span",{className:"c-green",children:"已学完"}):e.jsx("span",{children:"未学完"})})},{title:"开始学习时间",width:"16%",render:(s,t)=>e.jsx(e.Fragment,{children:typeof t.watch_record.created_at<"u"&&t.watch_record.created_at?e.jsx("span",{children:N(t.watch_record.created_at)}):e.jsx("span",{children:"-"})})},{title:"最近一次学习",width:"16%",render:(s,t)=>e.jsx(e.Fragment,{children:typeof t.watch_record.updated_at<"u"&&t.watch_record.updated_at?e.jsx("span",{children:N(t.watch_record.updated_at)}):e.jsx("span",{children:"-"})})},S.Snapshot?{title:"已拍照片",width:"12%",render:(s,t)=>e.jsx(e.Fragment,{children:i[t.id]&&i[t.id].images.length>0?e.jsx(B,{size:"small",className:"c-primary",type:"link",onClick:()=>{C(t.id)},children:i[t.id].images.length}):e.jsx("span",{children:"-"})})}:{}],v=()=>{l||(r(!0),ge({course_id:n.id,user_id:n.userId}).then(s=>{let t=s.data.videos,b=[],R=[];for(let y in t)b.push(t[y]),R.push(t[y].id);f(b),r(!1),S.Snapshot&&_(R)}).catch(s=>{r(!1)}))},_=s=>{Re({user_id:n.userId,type:"vod",other_ids:s}).then(t=>{g(t.data)})},C=s=>{x(s),o(!0)},w=()=>{x(0),o(!1),v()};return e.jsxs(e.Fragment,{children:[n.open?e.jsx(z,{title:n.text,onCancel:()=>{n.onCancel()},open:!0,width:1e3,maskClosable:!1,footer:null,centered:!0,children:e.jsx("div",{style:{minHeight:400},className:"mt-30",children:e.jsx(F,{loading:l,columns:I,dataSource:u,rowKey:s=>s.id,pagination:!1})})}):null,e.jsx(Oe,{open:d,vid:c,uid:n.userId,onCancel:()=>{w()}})]})},Me=n=>{const[l,r]=a.useState(!1),[u,f]=a.useState([]),[i,g]=a.useState(1),[d,o]=a.useState(8),[c,x]=a.useState(0),[S,I]=a.useState(!1),[v,_]=a.useState(0),[C,w]=a.useState(""),[s,t]=a.useState(!1);a.useEffect(()=>{b()},[n.id,i,d,S]);const b=()=>{l||(r(!0),xe({page:i,size:d,user_id:n.id}).then(p=>{f(p.data.data),x(p.data.total),r(!1)}).catch(p=>{r(!1)}))},R={current:i,pageSize:d,total:c,onChange:(p,j)=>y(p,j),showSizeChanger:!0},y=(p,j)=>{g(p),o(j)},K=[{title:"录播课程",render:(p,j)=>e.jsxs(e.Fragment,{children:[j.course.id&&e.jsx(P,{value:j.course.thumb,width:120,height:90,title:j.course.title,border:4}),!j.course.id&&e.jsx("span",{className:"c-red",children:"课程不存在"})]})},{title:"课程学习进度",width:200,render:(p,j)=>e.jsxs("span",{children:[j.progress,"%"]})},{title:"开始学习时间",width:200,dataIndex:"created_at",render:p=>e.jsx("span",{children:N(p)})},{title:"最近一次学习",width:200,render:(p,j)=>e.jsx(e.Fragment,{children:j.last_view_video&&j.last_view_video.length!==0&&j.last_view_video.updated_at?e.jsx("span",{children:N(j.last_view_video.updated_at)}):e.jsx("span",{children:"-"})})},{title:"课时学习进度",width:200,render:(p,j)=>e.jsx(O,{type:"link",text:"学习进度",class:"c-primary",icon:null,p:"v2.member.course.progress",onClick:()=>{V(j)},disabled:null})}],V=p=>{w(p.course.title),_(p.course_id),t(!0)};return e.jsxs("div",{className:"float-left",children:[e.jsx(F,{loading:l,columns:K,dataSource:u,rowKey:p=>p.id,pagination:R}),e.jsx(Be,{open:s,text:C,id:v,userId:n.id,onCancel:()=>t(!1)})]})},Ke=n=>{const[l,r]=a.useState(!1),[u,f]=a.useState([]),[i,g]=a.useState(1),[d,o]=a.useState(8),[c,x]=a.useState(0),[S,I]=a.useState(!1);a.useEffect(()=>{v()},[n.id,i,d,S]);const v=()=>{l||(r(!0),pe({page:i,size:d,user_id:n.id}).then(s=>{f(s.data.data),x(s.data.total),r(!1)}).catch(s=>{r(!1)}))},_={current:i,pageSize:d,total:c,onChange:(s,t)=>C(s,t),showSizeChanger:!0},C=(s,t)=>{g(s),o(t)},w=[{title:"课时名称",render:(s,t)=>e.jsx("span",{children:t.video.title})},{title:"课时时长",width:200,render:(s,t)=>e.jsx(M,{duration:t.duration})},{title:"已学时长",width:200,render:(s,t)=>e.jsx(e.Fragment,{children:typeof t.watch_record.watch_seconds<"u"?e.jsx(M,{duration:t.watch_record.watch_seconds}):e.jsx("span",{children:"-"})})},{title:"是否学完",width:200,render:(s,t)=>e.jsx(e.Fragment,{children:typeof t.watch_record.watched_at<"u"&&t.watch_record.watched_at?e.jsx("span",{className:"c-green",children:"已学完"}):e.jsx("span",{children:"未学完"})})},{title:"开始学习时间",width:200,render:(s,t)=>e.jsx(e.Fragment,{children:typeof t.watch_record.created_at<"u"&&t.watch_record.created_at?e.jsx("span",{children:N(t.watch_record.created_at)}):e.jsx("span",{children:"-"})})},{title:"最近一次学习",width:200,render:(s,t)=>e.jsx(e.Fragment,{children:typeof t.watch_record.updated_at<"u"&&t.watch_record.updated_at?e.jsx("span",{children:N(t.watch_record.updated_at)}):e.jsx("span",{children:"-"})})}];return e.jsx("div",{className:"float-left",children:e.jsx(F,{loading:l,columns:w,dataSource:u,rowKey:s=>s.id,pagination:_})})},qe=n=>{const[l,r]=a.useState(!1),[u,f]=a.useState([]),[i,g]=a.useState(1),[d,o]=a.useState(10),[c,x]=a.useState(0),[S,I]=a.useState(!1);a.useEffect(()=>{v()},[n.id,i,d,S]);const v=()=>{l||(r(!0),je(n.id,{page:i,size:d}).then(s=>{f(s.data.data.data),x(s.data.data.total),r(!1)}).catch(s=>{r(!1)}))},_={current:i,pageSize:d,total:c,onChange:(s,t)=>C(s,t),showSizeChanger:!0},C=(s,t)=>{g(s),o(t)},w=[{title:"邀请学员ID",width:200,render:(s,t)=>e.jsx("span",{children:t.id})},{title:"邀请学员",render:(s,t)=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"user-item d-flex",children:[e.jsx("div",{className:"avatar",children:e.jsx("img",{src:t.avatar,width:"40",height:"40"})}),e.jsx("div",{className:"ml-10",children:t.nick_name})]})})},{title:"手机号码",width:400,render:(s,t)=>e.jsx("span",{children:t.mobile})},{title:"注册时间",width:215,render:(s,t)=>e.jsx("span",{children:N(t.created_at)})},{title:"邀请关系有效期至",width:215,render:(s,t)=>e.jsx("span",{children:N(t.invite_user_expired_at)})}];return e.jsx("div",{className:"float-left",children:e.jsx(F,{loading:l,columns:w,dataSource:u,rowKey:s=>s.id,pagination:_})})},He=n=>{const[l,r]=a.useState(!1),[u,f]=a.useState([]),[i,g]=a.useState(1),[d,o]=a.useState(10),[c,x]=a.useState(0),[S,I]=a.useState(!1);a.useEffect(()=>{v()},[n.id,i,d,S]);const v=()=>{l||(r(!0),_e(n.id,{page:i,size:d}).then(s=>{f(s.data.data.data),x(s.data.data.total),r(!1)}).catch(s=>{r(!1)}))},_={current:i,pageSize:d,total:c,onChange:(s,t)=>C(s,t),showSizeChanger:!0},C=(s,t)=>{g(s),o(t)},w=[{title:"积分记录ID",width:300,render:(s,t)=>e.jsx("span",{children:t.id})},{title:"邀积分变更",width:300,render:(s,t)=>e.jsx("span",{children:t.sum})},{title:"变更原因",render:(s,t)=>e.jsx("span",{children:t.remark})},{title:"变更时间",width:200,render:(s,t)=>e.jsx("span",{children:N(t.created_at)})}];return e.jsx("div",{className:"float-left",children:e.jsx(F,{loading:l,columns:w,dataSource:u,rowKey:s=>s.id,pagination:_})})},Qe=n=>{const[l,r]=a.useState(!1),[u,f]=a.useState([]),[i,g]=a.useState(1),[d,o]=a.useState(10),[c,x]=a.useState(0),[S,I]=a.useState(!1);a.useEffect(()=>{v()},[n.id,i,d,S]);const v=()=>{l||(r(!0),we({page:i,size:d,user_id:n.id}).then(s=>{f(s.data.data),x(s.data.total),r(!1)}).catch(s=>{r(!1)}))},_={current:i,pageSize:d,total:c,onChange:(s,t)=>C(s,t),showSizeChanger:!0},C=(s,t)=>{g(s),o(t)},w=[{title:"ID",width:120,render:(s,t)=>e.jsx("span",{children:t.id})},{title:"变动前余额",width:250,render:(s,t)=>e.jsxs("span",{children:[t.before_balance,"元"]})},{title:"变动金额",width:250,render:(s,t)=>e.jsxs("span",{children:[t.amount,"元"]})},{title:"备注",render:(s,t)=>e.jsx("span",{children:t.remark})},{title:"时间",width:200,render:(s,t)=>e.jsx("span",{children:N(t.created_at)})}];return e.jsx("div",{className:"float-left",children:e.jsx(F,{loading:l,columns:w,dataSource:u,rowKey:s=>s.id,pagination:_})})},Ge=n=>{const[l,r]=a.useState(!1),[u,f]=a.useState([]),[i,g]=a.useState(1),[d,o]=a.useState(10),[c,x]=a.useState(0),[S,I]=a.useState(!1);a.useEffect(()=>{v()},[n.id,i,d,S]);const v=()=>{l||(r(!0),be({page:i,size:d,user_id:n.id}).then(s=>{f(s.data.data),x(s.data.total),r(!1)}).catch(s=>{r(!1)}))},_={current:i,pageSize:d,total:c,onChange:(s,t)=>C(s,t),showSizeChanger:!0},C=(s,t)=>{g(s),o(t)},w=[{title:"ID",width:120,render:(s,t)=>e.jsx("span",{children:t.id})},{title:"变动金额",width:250,render:(s,t)=>e.jsx("span",{children:t.sum})},{title:"备注",render:(s,t)=>e.jsx("span",{children:t.remark})},{title:"时间",width:200,render:(s,t)=>e.jsx("span",{children:N(t.created_at)})}];return e.jsx("div",{className:"float-left",children:e.jsx(F,{loading:l,columns:w,dataSource:u,rowKey:s=>s.id,pagination:_})})},{confirm:$e}=z,Ot=()=>{const n=re(),l=Q(),r=le(),[u,f]=a.useState(!1),[i,g]=a.useState({}),[d,o]=a.useState(!1),[c,x]=a.useState(!1),[S,I]=a.useState(!1),[v,_]=a.useState(!1),[C,w]=a.useState(!1),[s,t]=a.useState([]),[b,R]=a.useState([]),[y,K]=a.useState("order"),[V,p]=a.useState([]),j=q(h=>h.loginUser.value.user),E=q(h=>h.enabledAddonsConfig.value.enabledAddons);a.useEffect(()=>{document.title="学员详情",n(de("学员详情"))},[]),a.useEffect(()=>{T(),Z()},[r.memberId]),a.useEffect(()=>{let h=[{name:"订单明细",key:"order"}];U("v2.member.courses")&&h.push({name:"录播课学习",key:"vod-watch-records"}),U("v2.member.videos")&&h.push({name:"单独订阅课时",key:"video-watch-records"}),h.push({name:"邀请明细",key:"invite"},{name:"积分明细",key:"credit1"}),E.MultiLevelShare&&U("addons.MultiLevelShare.member.balanceRecords")&&h.push({name:"邀请余额明细",key:"balanceRecords"}),E.TemplateOne&&U("addons.TemplateOne.memberCredit2Records.list")&&h.push({name:"iOS余额明细",key:"iOSRecords"}),p(h)},[E,j]);const U=h=>typeof j.permissions[h]<"u",T=()=>{u||(f(!0),Se(Number(r.memberId)).then(h=>{g(h.data.data),f(!1)}).catch(h=>{f(!1)}))},Z=()=>{ve({}).then(h=>{let W=h.data.roles,G=[];W.map(D=>{G.push({label:D.name,value:D.id})}),t(G);let ie=h.data.tags,$=[];ie.map(D=>{$.push({label:D.name,value:D.id})}),R($)})},ee=()=>{let h="冻结后此账号将无法登录，确认冻结？",W=1;i.is_lock===1&&(h="解冻后此账号将正常登录，确认解冻？",W=0),$e({title:"警告",icon:e.jsx(oe,{}),content:h,centered:!0,okText:"确认",cancelText:"取消",onOk(){Ce({user_ids:[Number(r.memberId)],field:"is_lock",value:W}).then(()=>{L.success("成功"),T()})},onCancel(){console.log("Cancel")}})},te=()=>{x(!0)},se=()=>{_(!0)},ae=()=>{I(!0)},ne=()=>{w(!0)};return e.jsxs("div",{className:m["user-main-body"],children:[e.jsx(Ne,{id:Number(r.memberId),open:d,roles:s,onCancel:()=>o(!1),onSuccess:()=>{o(!1),T()}}),e.jsx(Ve,{id:Number(r.memberId),open:c,onCancel:()=>x(!1),onSuccess:()=>{x(!1),T()}}),e.jsx(Ee,{id:Number(r.memberId),open:C,onCancel:()=>w(!1),onSuccess:()=>{w(!1),T()}}),e.jsx(Ue,{tags:b,id:Number(r.memberId),open:v,onCancel:()=>_(!1),onSuccess:()=>{_(!1),T()}}),e.jsx(We,{id:Number(r.memberId),open:S,onCancel:()=>I(!1),onSuccess:()=>{I(!1),T()}}),e.jsxs("div",{className:"float-left bg-white br-15 p-30",children:[e.jsx(ke,{title:"学员详情"}),e.jsxs("div",{className:m["user-info-box"],children:[e.jsxs("div",{className:m["user-base-info-box"],children:[e.jsx("div",{className:m["user-avatar"],children:e.jsx("img",{src:i.avatar,width:80,height:80})}),e.jsxs("div",{className:m["user-info"],children:[e.jsx("div",{className:m["user-nickname"],children:i.nick_name}),e.jsxs("div",{className:m.buttons,children:[e.jsx(B,{type:"link",className:m["real-profile"],onClick:()=>o(!0),children:"修改资料"}),e.jsx(B,{type:"link",className:m["edit-profile"],onClick:()=>l("/member/profile/"+r.memberId),children:"实名信息"}),e.jsx(O,{type:"link",text:i.is_lock===1?"解冻账号":"冻结账号",class:m["edit-profile"],icon:null,p:"member.update",onClick:()=>{ee()},disabled:null}),e.jsx(O,{type:"link",text:"变动积分",class:m["edit-profile"],icon:null,p:"member.credit1.change",onClick:()=>{te()},disabled:null}),e.jsx(O,{type:"link",text:"修改标签",class:m["edit-profile"],icon:null,p:"member.tags",onClick:()=>{se()},disabled:null}),e.jsx(O,{type:"link",text:"修改备注",class:m["edit-profile"],icon:null,p:"member.remark.update",onClick:()=>{ae()},disabled:null}),E.TemplateOne&&e.jsx(O,{type:"link",text:"变动iOS余额",class:m["edit-profile"],icon:null,p:"addons.TemplateOne.memberCredit2.recharge",onClick:()=>{ne()},disabled:null})]})]})]}),e.jsxs("div",{className:m["panel-info-box"],children:[e.jsxs("div",{className:m["panel-info-item"],children:["ID：",i.id]}),e.jsxs("div",{className:m["panel-info-item"],children:["手机号：",i.mobile]}),e.jsxs("div",{className:m["panel-info-item"],children:["VIP： ",i.role?i.role.name:""]}),e.jsxs("div",{className:m["panel-info-item"],children:["VIP到期：",N(i.role_expired_at)]}),e.jsxs("div",{className:m["panel-info-item"],children:["账号状态：",i.is_lock===1&&e.jsx("span",{className:"c-red",children:"已冻结"}),i.is_lock!==1&&e.jsx("span",{className:"c-green",children:"正常"})]}),e.jsxs("div",{className:m["panel-info-item"],children:["注册区域：",i.register_area]}),e.jsxs("div",{className:m["panel-info-item"],children:["最近登录：",N(i.updated_at)]}),e.jsxs("div",{className:m["panel-info-item"],children:["注册IP：",i.register_ip]}),e.jsxs("div",{className:m["panel-info-item"],children:["邀请人：",i.invitor?i.invitor.nick_name:"",i.invito&&e.jsxs("div",{className:"item",children:["(截",N(i.invite_user_expired_at),")"]})]}),e.jsxs("div",{className:m["panel-info-item"],children:["推广分销余额：",i.invite_balance]}),e.jsxs("div",{className:m["panel-info-item"],children:["积分：",e.jsx("span",{children:i.credit1})]}),e.jsxs("div",{className:m["panel-info-item"],children:["iOS余额：",e.jsx("span",{children:i.credit2})]}),e.jsxs("div",{className:m["panel-info-item"],children:["用户标签：",i.tags&&i.tags.length>0&&i.tags.map(h=>e.jsx(ze,{color:"processing",className:"ml-5 mb-5",children:h.name},h.id))]}),e.jsxs("div",{className:m["panel-info-item"],children:["备注：",i.remark&&e.jsx("div",{className:m["remark-text"],dangerouslySetInnerHTML:{__html:i.remark.remark}})]})]})]})]}),e.jsxs("div",{className:"float-left bg-white br-15 p-30 mt-30",style:{textAlign:"left"},children:[e.jsx(J.Group,{size:"large",defaultValue:y,buttonStyle:"solid",onChange:h=>{K(h.target.value)},children:V.length>0&&V.map(h=>e.jsx(J.Button,{value:h.key,children:h.name},h.key))}),e.jsxs("div",{className:"float-left mt-30",children:[y==="order"&&e.jsx(Ae,{id:Number(r.memberId)}),y==="vod-watch-records"&&e.jsx(Me,{id:Number(r.memberId)}),y==="video-watch-records"&&e.jsx(Ke,{id:Number(r.memberId)}),y==="invite"&&e.jsx(qe,{id:Number(r.memberId)}),y==="credit1"&&e.jsx(He,{id:Number(r.memberId)}),y==="balanceRecords"&&e.jsx(Qe,{id:Number(r.memberId)}),y==="iOSRecords"&&e.jsx(Ge,{id:Number(r.memberId)})]})]})]})};export{Ot as default};
