import{u as g,b,r as c,t as y,j as t,B as m,m as v,i as w}from"./index-3fd54424.js";import{f as B}from"./member-4894e8dc.js";import{r as N,u as k}from"./xlsx-b055c42d.js";import{B as S}from"./index-c3c15456.js";import{U}from"./index-0b71564b.js";import"./LeftOutlined-a0f8cfa6.js";import"./Dragger-3ad849c3.js";import"./useForceUpdate-56773729.js";import"./DeleteOutlined-529a4ffa.js";import"./CheckOutlined-44e74bd9.js";const J=()=>{const d=g();b();const[l,r]=c.useState(!1);c.useEffect(()=>{document.title="学员批量导入",d(y("学员批量导入"))},[]);const p={accept:".xls,.xlsx,application/vnd.ms-excel",beforeUpload:e=>{if(l)return;r(!0);const i=e,s=new FileReader;return s.onload=a=>{const o=a.target.result,n=N(o,{type:"binary"}),x=n.Sheets[n.SheetNames[0]],j=k.sheet_to_json(x,{header:1});u(j)},s.readAsBinaryString(i),!1}},u=(e,i)=>{e.splice(0,2);let s=[];for(let a=0;a<e.length;a++){let o=e[a];o.length!==0&&(o.splice(4,0,0),s.push(o))}f(s)},f=e=>{B({users:e}).then(()=>{r(!1),v.success("导入成功！")}).catch(i=>{r(!1)})},h=()=>{let e=w()+"/template/学员批量导入模板.xlsx";window.open(e)};return t.jsxs("div",{className:"meedu-main-body",children:[t.jsx(S,{title:"学员批量导入"}),t.jsx("div",{className:"user-import-box",children:t.jsxs("div",{className:"float-left d-flex mb-30x",children:[t.jsx("div",{children:t.jsx(U,{...p,showUploadList:!1,children:t.jsx(m,{loading:l,type:"primary",children:"导入表格"})})}),t.jsx("div",{className:"ml-30",children:t.jsx(m,{type:"link",className:"c-primary",onClick:()=>h(),children:"下载「学员批量导入模板」"})})]})})]})};export{J as default};
