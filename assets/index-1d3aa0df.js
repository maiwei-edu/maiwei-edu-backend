import{u as te,b as se,r as a,t as ae,j as e,B as c,I as k,S as le,m as z,E as ne,d as re,M as ie}from"./index-b4683d61.js";import{l as oe,c as ce,d as de}from"./wenda-cd02147f.js";import{P as A}from"./index-573a6ce5.js";import{O as ue}from"./index-6f8a3ac0.js";import{f as me,a as he}from"./icon-filter-h-a57243b6.js";import{S as N}from"./index-c09cc6d7.js";import{T as xe}from"./Table-76e623b5.js";import{D as pe}from"./index-cfda4d23.js";import{D as fe}from"./index-cc7d88a3.js";import{T as B}from"./index-e058fb67.js";import"./icon-option-c9fff0bb.js";import"./useIcons-e0af7133.js";import"./CheckOutlined-e6bc730e.js";import"./addEventListener-a27ae3f4.js";import"./Pagination-d2c763c6.js";import"./LeftOutlined-9e6e73a2.js";import"./useForceUpdate-f2aff5e0.js";import"./responsiveObserver-dc429d3b.js";import"./index-10f1a096.js";import"./iconUtil-f3f90360.js";const{confirm:ge}=ie,{RangePicker:je}=fe,Ke=()=>{const K=te(),b=se(),[f,l]=a.useState(!1),[L,_]=a.useState([]),[g,d]=a.useState(1),[j,I]=a.useState(10),[Y,q]=a.useState(0),[u,w]=a.useState(!1),[r,y]=a.useState(""),[m,T]=a.useState(""),[n,C]=a.useState([]),[h,D]=a.useState(-1),[x,P]=a.useState([]),[O,W]=a.useState([]),[S,E]=a.useState([]),[F,H]=a.useState([]),[U,i]=a.useState(!1),[M,R]=a.useState(!1),$=[{value:-1,label:"全部"},{value:0,label:"未解决"},{value:1,label:"已解决"}];a.useEffect(()=>{document.title="站内问答",K(ae("站内问答")),J()},[]),a.useEffect(()=>{G()},[g,j,u]),a.useEffect(()=>{x&&x.length>0||n&&n.length!==0||m||r||h!==-1?R(!0):R(!1)},[x,n,m,r,h]);const G=()=>{f||(l(!0),oe({page:g,size:j,sort:"id",order:"desc",user_id:m,category_id:n,status:h,created_at:x,keywords:r}).then(t=>{_(t.data.data.data),q(t.data.data.total),l(!1)}).catch(t=>{l(!1)}))},J=()=>{ce().then(t=>{let s=t.data.data;const o=[];for(let p=0;p<s.length;p++)o.push({label:s[p].name,value:s[p].id});H(o)})},v=()=>{d(1),I(10),_([]),E([]),y(""),T(""),C([]),D(-1),P([]),w(!u)},Q=()=>{if(S.length===0){z.error("请选择需要操作的数据");return}ge({title:"操作确认",icon:e.jsx(ne,{}),content:"确认删除选中的优惠码？",centered:!0,okText:"确认",cancelText:"取消",onOk(){f||(l(!0),de({ids:S}).then(()=>{z.success("成功"),v(),l(!1)}).catch(t=>{l(!1)}))},onCancel(){console.log("Cancel")}})},V={selectedRowKeys:S,onChange:(t,s)=>{E(t)}},X={current:g,pageSize:j,total:Y,onChange:(t,s)=>Z(t,s),showSizeChanger:!0},Z=(t,s)=>{d(t),I(s)},ee=[{title:"分类",width:200,render:(t,s)=>{var o;return e.jsx("span",{children:((o=s==null?void 0:s.category)==null?void 0:o.name)||"-"})}},{title:"学员",width:300,render:(t,s)=>e.jsxs(e.Fragment,{children:[s.user&&e.jsxs("div",{className:"user-item d-flex",children:[e.jsx("div",{className:"avatar",children:e.jsx("img",{src:s.user.avatar,width:"40",height:"40"})}),e.jsx("div",{className:"ml-10",children:s.user.nick_name})]}),!s.user&&e.jsx("span",{className:"c-red",children:"学员不存在"})]})},{title:"标题",width:500,dataIndex:"title",render:t=>e.jsx("span",{children:t})},{title:"浏览",width:120,dataIndex:"view_times",render:t=>e.jsxs("span",{children:[t,"次"]})},{title:"答案",width:120,dataIndex:"answer_count",render:t=>e.jsxs("span",{children:[t,"个"]})},{title:"积分",width:120,dataIndex:"credit1",render:t=>e.jsxs("span",{children:[t,"积分"]})},{title:"状态",width:120,render:(t,s)=>e.jsxs(e.Fragment,{children:[s.status===1&&e.jsx(B,{color:"success",children:s.status_text}),s.status!==1&&e.jsx(B,{color:"default",children:s.status_text})]})},{title:"创建时间",width:200,dataIndex:"created_at",render:t=>e.jsx("span",{children:re(t)})},{title:"操作",key:"action",fixed:"right",width:80,render:(t,s)=>e.jsx(A,{type:"link",text:"回答",class:"c-primary",icon:null,p:"addons.Wenda.question.answers",onClick:()=>{b("/wenda/question/answer?id="+s.id+"&status="+s.status)},disabled:null})}];return e.jsxs("div",{className:"meedu-main-body",children:[e.jsxs("div",{className:"float-left j-b-flex mb-30",children:[e.jsxs("div",{className:"d-flex",children:[e.jsx(A,{type:"primary",text:"问答分类",class:"",icon:null,p:"addons.Wenda.category.list",onClick:()=>b("/wenda/question/category/index"),disabled:null}),e.jsx(c,{type:"primary",className:"ml-10",danger:!0,onClick:()=>Q(),children:"批量删除"}),e.jsx(ue,{text:"问答配置",value:"/system/config?key=问答"})]}),e.jsxs("div",{className:"d-flex",children:[e.jsx(k,{value:r,onChange:t=>{y(t.target.value)},allowClear:!0,style:{width:150},placeholder:"标题关键字"}),e.jsx(N,{style:{width:150,marginLeft:10},value:n,onChange:t=>{C(t)},allowClear:!0,placeholder:"分类",options:F}),e.jsx(c,{className:"ml-10",onClick:v,children:"清空"}),e.jsx(c,{className:"ml-10",type:"primary",onClick:()=>{d(1),w(!u),i(!1)},children:"筛选"}),e.jsxs("div",{className:"drawerMore d-flex ml-10",onClick:()=>i(!0),children:[M&&e.jsxs(e.Fragment,{children:[e.jsx("img",{src:me}),e.jsx("span",{className:"act",children:"已选"})]}),!M&&e.jsxs(e.Fragment,{children:[e.jsx("img",{src:he}),e.jsx("span",{children:"更多"})]})]})]})]}),e.jsx("div",{className:"float-left",children:e.jsx(xe,{rowSelection:{type:"checkbox",...V},loading:f,columns:ee,dataSource:L,rowKey:t=>t.id,pagination:X})}),U?e.jsx(pe,{title:"更多筛选",onClose:()=>i(!1),maskClosable:!1,open:!0,footer:e.jsxs(le,{className:"j-b-flex",children:[e.jsx(c,{onClick:()=>{v(),i(!1)},children:"清空"}),e.jsx(c,{onClick:()=>{d(1),w(!u),i(!1)},type:"primary",children:"筛选"})]}),width:360,children:e.jsxs("div",{className:"float-left",children:[e.jsx(k,{value:r,onChange:t=>{y(t.target.value)},allowClear:!0,placeholder:"关键字"}),e.jsx(N,{style:{marginTop:20,width:"100%"},value:n,onChange:t=>{C(t)},allowClear:!0,placeholder:"分类",options:F}),e.jsx(k,{value:m,onChange:t=>{T(t.target.value)},allowClear:!0,style:{marginTop:20},placeholder:"学员ID"}),e.jsx(N,{style:{marginTop:20,width:"100%"},value:h,onChange:t=>{D(t)},allowClear:!0,placeholder:"状态",options:$}),e.jsx(je,{format:"YYYY-MM-DD",value:O,style:{marginTop:20},onChange:(t,s)=>{P(s),W(t)},placeholder:["日期-开始","日期-结束"]})]})}):null]})};export{Ke as default};
