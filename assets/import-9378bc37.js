import{u as y,b as I,r as p,t as b,j as o,B as d,m as n,i as v}from"./index-3fd54424.js";import{m as w}from"./course-c58bd7af.js";import{r as B,u as N}from"./xlsx-b055c42d.js";import{B as k}from"./index-c3c15456.js";import{U}from"./index-0b71564b.js";import"./LeftOutlined-a0f8cfa6.js";import"./Dragger-3ad849c3.js";import"./useForceUpdate-56773729.js";import"./DeleteOutlined-529a4ffa.js";import"./CheckOutlined-44e74bd9.js";const F=()=>{const m=y();I();const[i,l]=p.useState(!1);p.useEffect(()=>{document.title="课时批量导入",m(b("课时批量导入"))},[]);const f={accept:".xls,.xlsx,application/vnd.ms-excel",beforeUpload:a=>{if(i)return;l(!0);const t=a,s=new FileReader;return s.onload=r=>{const e=r.target.result,c=B(e,{type:"binary"}),j=c.Sheets[c.SheetNames[0]],g=N.sheet_to_json(j,{header:1});u(g)},s.readAsBinaryString(t),!1}},u=(a,t)=>{a.splice(0,2);let s=[];a.forEach(r=>{let e=[];e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=parseInt(r[3]||0),e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=0,e[8]=r[7]||"",e[9]="",e[10]="",e[11]=parseInt(r[8]||0),s.push(e)}),h(s)},h=a=>{for(let t=0;t<a.length;t++){let s=a[t];if(!s[0]){l(!1),n.error(`第${t+2}行课程名为空`);return}if(!s[2]){l(!1),n.error(`第${t+2}行课时名称为空`);return}if(s[3]<=0){l(!1),n.error(`第${t+2}行课时时长必须大于0`);return}if(!s[4]&&!s[5]&&!s[6]){l(!1),n.error(`第${t+2}行的腾讯云视频ID、阿里云视频ID、视频URL必须填写一个`);return}}w({line:3,data:a}).then(()=>{l(!1),n.success("导入成功！")}).catch(t=>{l(!1)})},x=()=>{let a=v()+"/template/课时批量导入模板.xlsx";window.open(a)};return o.jsxs("div",{className:"meedu-main-body",children:[o.jsx(k,{title:"课时批量导入"}),o.jsx("div",{className:"user-import-box",children:o.jsxs("div",{className:"float-left d-flex mb-30x",children:[o.jsx("div",{children:o.jsx(U,{...f,showUploadList:!1,children:o.jsx(d,{loading:i,type:"primary",children:"导入表格"})})}),o.jsx("div",{className:"ml-30",children:o.jsx(d,{type:"link",className:"c-primary",onClick:()=>x(),children:"下载「课时批量导入模板」"})})]})})]})};export{F as default};
