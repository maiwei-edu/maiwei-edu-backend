import{u as O,b as R,r as s,t as A,j as t,I as $,B as f,d as q,S as v,D as G,e as H,E as J,m as Q,M as U}from"./index-3fd54424.js";import{l as V,c as W,d as X}from"./path-1a3bf99e.js";import{P as o}from"./index-df05a090.js";import{T as Y}from"./index-04a133fc.js";import{S as Z}from"./index-ff4e3b6e.js";import{T as ee}from"./Table-59a53b18.js";import"./useIcons-235bc0cd.js";import"./CheckOutlined-44e74bd9.js";import"./addEventListener-1752243f.js";import"./Pagination-a2ebdf00.js";import"./LeftOutlined-a0f8cfa6.js";import"./useForceUpdate-56773729.js";import"./responsiveObserver-a0dea2e5.js";import"./index-a56efb1a.js";import"./iconUtil-14ff0944.js";const{confirm:te}=U,je=()=>{const S=O(),c=R(),[u,i]=s.useState(!1),[_,m]=s.useState([]),[x,h]=s.useState(1),[g,y]=s.useState(10),[P,N]=s.useState(0),[p,j]=s.useState(!1),[w,b]=s.useState(""),[C,k]=s.useState([]),[D,T]=s.useState([]);s.useEffect(()=>{document.title="学习路径",S(A("学习路径")),z()},[]),s.useEffect(()=>{E()},[x,g,p]);const E=()=>{u||(i(!0),V({page:x,size:g,keywords:w,category_id:C}).then(a=>{m(a.data.data),N(a.data.total),i(!1)}).catch(a=>{i(!1)}))},z=()=>{W().then(a=>{let e=a.data.categories;const n=[];for(let l=0;l<e.length;l++)if(e[l].children.length>0){n.push({label:e[l].name,value:e[l].id});let d=e[l].children;for(let r=0;r<d.length;r++)d[r].name="|----"+d[r].name,n.push({label:d[r].name,value:d[r].id})}else n.push({label:e[l].name,value:e[l].id});T(n)})},I=()=>{h(1),y(10),m([]),b(""),k([]),j(!p)},L={current:x,pageSize:g,total:P,onChange:(a,e)=>B(a,e),showSizeChanger:!0},B=(a,e)=>{h(a),y(e)},F=[{title:"ID",width:"6%",render:(a,e)=>t.jsx("span",{children:e.id})},{title:"学习路径",width:"22%",render:(a,e)=>t.jsx(Y,{width:120,value:e.thumb,height:90,title:e.name,border:4})},{title:"分类",width:"8%",render:(a,e)=>{var n;return t.jsx("span",{children:((n=e==null?void 0:e.category)==null?void 0:n.name)||"-"})}},{title:"价格",width:"12%",render:(a,e)=>t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:["现价：",e.charge,"元"]}),t.jsxs("div",{style:{color:"#666"},className:"original-charge",children:["原价：",e.original_charge,"元"]})]})},{title:"包含步骤",width:"8%",render:(a,e)=>t.jsxs("span",{children:[e.steps_count,"个步骤"]})},{title:"包含课程",width:"8%",render:(a,e)=>t.jsxs("span",{children:[e.courses_count,"个课程"]})},{title:"上架时间",width:"14%",dataIndex:"published_at",render:a=>t.jsx("span",{children:q(a)})},{title:"是否显示",width:"8%",render:(a,e)=>t.jsxs(t.Fragment,{children:[e.is_show===1&&t.jsx("span",{className:"c-green",children:"· 显示"}),e.is_show!==1&&t.jsx("span",{className:"c-red",children:"· 隐藏"})]})},{title:"操作",width:"14%",fixed:"right",render:(a,e)=>{const n=[{key:"1",label:t.jsx(o,{type:"link",text:"编辑",class:"c-primary",icon:null,p:"addons.learnPaths.path.update",onClick:()=>{c("/learningpath/path/update?id="+e.id)},disabled:null})},{key:"2",label:t.jsx(o,{type:"link",text:"删除",class:"c-red",icon:null,p:"addons.learnPaths.path.delete",onClick:()=>{M(e.id)},disabled:null})}];return t.jsxs(v,{children:[t.jsx(o,{type:"link",text:"步骤",class:"c-primary",icon:null,p:"addons.learnPaths.step.list",onClick:()=>{c("/learningpath/step/index?id="+e.id+"&title="+e.name)},disabled:null}),t.jsx(o,{type:"link",text:"学员",class:"c-primary",icon:null,p:"addons.learnPaths.path.users",onClick:()=>{c("/learningpath/path/user?id="+e.id)},disabled:null}),t.jsx(G,{menu:{items:n},children:t.jsx(f,{type:"link",className:"c-primary",onClick:l=>l.preventDefault(),children:t.jsxs(v,{size:"small",align:"center",children:["更多",t.jsx(H,{})]})})})]})}}],K=()=>{h(1),m([]),j(!p)},M=a=>{a!==0&&te({title:"操作确认",icon:t.jsx(J,{}),content:"确认删除此学习路径？",centered:!0,okText:"确认",cancelText:"取消",onOk(){u||(i(!0),X(a).then(()=>{i(!1),Q.success("删除成功"),K()}).catch(e=>{i(!1)}))},onCancel(){console.log("Cancel")}})};return t.jsxs("div",{className:"meedu-main-body",children:[t.jsxs("div",{className:"float-left j-b-flex mb-30",children:[t.jsxs("div",{className:"d-flex",children:[t.jsx(o,{type:"primary",text:"新建学习路径",class:"",icon:null,p:"addons.learnPaths.path.store",onClick:()=>c("/learningpath/path/create"),disabled:null}),t.jsx(o,{type:"primary",text:"学习路径分类",class:"ml-10",icon:null,p:"addons.learnPaths.category.list",onClick:()=>c("/learningpath/path/category/index"),disabled:null})]}),t.jsxs("div",{className:"d-flex",children:[t.jsx($,{value:w,onChange:a=>{b(a.target.value)},allowClear:!0,style:{width:150},placeholder:"课程关键字"}),t.jsx(Z,{style:{width:150,marginLeft:10},value:C,onChange:a=>{k(a)},allowClear:!0,placeholder:"分类",options:D}),t.jsx(f,{className:"ml-10",onClick:I,children:"清空"}),t.jsx(f,{className:"ml-10",type:"primary",onClick:()=>{h(1),j(!p)},children:"筛选"})]})]}),t.jsx("div",{className:"float-left",children:t.jsx(ee,{loading:u,columns:F,dataSource:_,rowKey:a=>a.id,pagination:L})})]})};export{je as default};
