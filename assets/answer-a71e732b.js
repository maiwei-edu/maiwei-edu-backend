import{f as k,u as S,b as y,r as a,t as T,j as e,d as q,S as C,E,m as h,M as I}from"./index-3fd54424.js";import{e as A,f as D,g as B}from"./wenda-b79732f0.js";import{B as F}from"./index-c3c15456.js";import{P as c}from"./index-df05a090.js";import{T as L}from"./Table-59a53b18.js";import{T as P}from"./index-2c039b27.js";import"./LeftOutlined-a0f8cfa6.js";import"./addEventListener-1752243f.js";import"./useIcons-235bc0cd.js";import"./CheckOutlined-44e74bd9.js";import"./Pagination-a2ebdf00.js";import"./useForceUpdate-56773729.js";import"./responsiveObserver-a0dea2e5.js";import"./index-ff4e3b6e.js";import"./index-a56efb1a.js";import"./iconUtil-14ff0944.js";const{confirm:W}=I,te=()=>{const n=new URLSearchParams(k().search),p=S(),l=y(),[d,i]=a.useState(!1),[x,o]=a.useState([]),[u,f]=a.useState(!1),[r,j]=a.useState(Number(n.get("id"))),[w,g]=a.useState(Number(n.get("status")));a.useEffect(()=>{document.title="问题回答",p(T("问题回答"))},[]),a.useEffect(()=>{j(Number(n.get("id"))),g(Number(n.get("status"))),_()},[n.get("id"),n.get("status"),u]);const _=()=>{d||(i(!0),A(r).then(t=>{o(t.data.answers),i(!1)}).catch(t=>{i(!1)}))},m=()=>{o([]),f(!u)},v=[{title:"ID",width:120,render:(t,s)=>e.jsx("span",{children:s.id})},{title:"学员ID",width:120,dataIndex:"user_id",render:t=>e.jsx("span",{children:t})},{title:"学员",width:300,render:(t,s)=>e.jsxs(e.Fragment,{children:[s.user&&e.jsxs("div",{className:"user-item d-flex",children:[e.jsx("div",{className:"avatar",children:e.jsx("img",{src:s.user.avatar,width:"40",height:"40"})}),e.jsx("div",{className:"ml-10",children:s.user.nick_name})]}),!s.user&&e.jsx("span",{className:"c-red",children:"学员不存在"})]})},{title:"点赞",width:120,dataIndex:"vote_count",render:t=>e.jsxs("span",{children:[t,"次"]})},{title:"内容",width:500,render:(t,s)=>e.jsx("div",{children:s.original_content})},{title:"答案",width:120,render:(t,s)=>e.jsx(e.Fragment,{children:s.is_correct===1&&e.jsx(P,{color:"success",children:"答案"})})},{title:"时间",width:200,dataIndex:"created_at",render:t=>e.jsx("span",{children:q(t)})},{title:"操作",width:160,render:(t,s)=>e.jsxs(C,{children:[e.jsx(c,{type:"link",text:"评论",class:"c-primary",icon:null,p:"addons.Wenda.question.answers.comments",onClick:()=>{l("/wenda/question/comment?id="+s.question_id+"&answer_id="+s.id)},disabled:null}),w!==1&&e.jsx(c,{type:"link",text:"设为答案",class:"c-primary",icon:null,p:"addons.Wenda.question.answers.setTrue",onClick:()=>{b(s.id)},disabled:null}),e.jsx(c,{type:"link",text:"删除",class:"c-red",icon:null,p:"addons.Wenda.question.answers.delete",onClick:()=>{N(s.id)},disabled:null})]})}],N=t=>{t!==0&&W({title:"操作确认",icon:e.jsx(E,{}),content:"确认删除此回答？",centered:!0,okText:"确认",cancelText:"取消",onOk(){d||(i(!0),D(r,t).then(()=>{i(!1),h.success("删除成功"),m()}).catch(s=>{i(!1)}))},onCancel(){console.log("Cancel")}})},b=t=>{t!==0&&B(r,t).then(()=>{h.success("成功"),l("/wenda/question/answer?id="+r+"&status=1",{replace:!0}),m()})};return e.jsxs("div",{className:"meedu-main-body",children:[e.jsx(F,{title:"问题回答"}),e.jsx("div",{className:"float-left mt-30",children:e.jsx(L,{loading:d,columns:v,dataSource:x,rowKey:t=>t.id,pagination:!1})})]})};export{te as default};
