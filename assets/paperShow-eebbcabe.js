import{f as R,u as L,b as U,r as u,t as E,m as O,j as o,B as D}from"./index-3fd54424.js";import{m as I}from"./mock-e0c98417.js";import{B as J}from"./index-c3c15456.js";import{C as Q,S as A,I as M,Q as H,J as T,a as X,h as z}from"./htmlToPdf-ca3af8b7.js";import"./LeftOutlined-a0f8cfa6.js";import"./index-04a133fc.js";import"./index-0b71564b.js";import"./Dragger-3ad849c3.js";import"./useForceUpdate-56773729.js";import"./DeleteOutlined-529a4ffa.js";import"./CheckOutlined-44e74bd9.js";const os=()=>{const c=new URLSearchParams(R().search),m=L(),y=U();u.useState(!1);const[p,x]=u.useState({}),[l,v]=u.useState({}),[C,N]=u.useState({}),[d,S]=u.useState([]),[_,k]=u.useState(Number(c.get("id"))),[j,b]=u.useState(Number(c.get("pid")));u.useEffect(()=>{document.title="查看模拟考试",m(E("查看模拟考试"))},[]),u.useEffect(()=>{k(Number(c.get("id"))),b(Number(c.get("pid")))},[c.get("id"),c.get("pid")]),u.useEffect(()=>{B()},[_,j]);const B=()=>{I(_,j).then(s=>{x(s.data.paper),v(s.data.user_paper),N(s.data.user);let r=s.data.questions;if(r.length===0){O.error("未获取到试题"),y(-1);return}let e=[];for(let n in r)e.push(...r[n]);let t=[],a=[],f=[],h=[],g=[],q=[],w=[];e.forEach(n=>{n.question&&(n.question.type===1&&a.push(n),n.question.type===2&&f.push(n),n.question.type===3&&h.push(n),n.question.type===4&&g.push(n),n.question.type===5&&q.push(n),n.question.type===6&&w.push(n))}),a.length>0&&t.push(...a),f.length>0&&t.push(...f),h.length>0&&t.push(...h),g.length>0&&t.push(...g),q.length>0&&t.push(...q),w.length>0&&t.push(...w),S(t)})},P=()=>{let r=document.querySelector("#pdfDom").querySelectorAll("img");if(r){var e;for(e=1;e<r.length;e++){r[e].src+="&timeSign="+Date.now().toString(),window.URL=window.URL||window.webkitURL;var t=new XMLHttpRequest;t.open("get",r[e].src,!0),t.send()}}z.getPdf(p.title)},i=(s,r,e)=>{console.log(s+":"+e+":"+r)};return o.jsxs("div",{className:"meedu-main-body",children:[o.jsx(J,{title:"查看模拟考试"}),o.jsx(D,{className:"mt-30",type:"primary",onClick:()=>{P()},children:"下载pdf格式试卷"}),o.jsx("div",{className:"float-left",id:"pdfDom",children:o.jsxs("div",{className:"read-paper-box",children:[o.jsxs("div",{className:"top float-left d-flex",children:[o.jsxs("div",{className:"user-info",children:["考生：",C.nick_name]}),o.jsxs("div",{className:"user-info",children:["考卷：",p.title]}),o.jsxs("div",{className:"score-info",children:["及格分/总分：",p.pass_score,"/",p.score]}),l&&l.status===1?o.jsxs("div",{className:"score",children:["考试得分：",o.jsxs("strong",{children:[l.get_score,"分"]})]}):o.jsx("div",{className:"score",children:"阅卷中"})]}),o.jsx("div",{className:"line float-left d-flex"}),d&&l&&o.jsx("div",{className:"questions-box",children:d.length>0&&d.map((s,r)=>o.jsxs("div",{className:"item",children:[s.question.type===1&&o.jsx(Q,{num:r+1,question:s.question,reply:s.answer_content,score:s.score,isCorrect:s.is_correct,isOver:!0,wrongBook:!1,update:(e,t,a)=>{i(e,t,a)}},s.question_id),s.question.type===2&&o.jsx(A,{num:r+1,question:s.question,reply:s.answer_contents_rows,score:s.score,isCorrect:s.is_correct,isOver:!0,wrongBook:!1,update:(e,t,a)=>{i(e,t,a)}},s.question_id),s.question.type===3&&o.jsx(M,{num:r+1,question:s.question,reply:s.answer_contents_rows,score:s.score,isCorrect:s.is_correct,isOver:!0,wrongBook:!1,update:(e,t,a)=>{i(e,t,a)}},s.question_id),s.question.type===4&&o.jsx(H,{num:r+1,question:s.question,reply:s.answer_content,thumbs:s.thumbs_rows,score:s.score,isCorrect:s.is_correct,isOver:!0,showImage:!0,wrongBook:!1,update:(e,t,a)=>{i(e,t,a)}},s.question_id),s.question.type===5&&o.jsx(T,{num:r+1,question:s.question,reply:s.answer_contents_rows,score:s.score,isCorrect:s.is_correct,isOver:!0,wrongBook:!1,update:(e,t,a)=>{i(e,t,a)}},s.question_id),s.question.type===6&&o.jsx(X,{num:r+1,question:s.question,reply:s.answer_contents_rows,score:s.score,isCorrect:s.is_correct,isOver:!0,showImage:!0,wrongBook:!1,update:(e,t,a)=>{i(e,t,a)}},s.question_id)]},r))})]})})]})};export{os as default};
