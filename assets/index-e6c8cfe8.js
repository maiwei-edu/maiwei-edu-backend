import{b as w,j as e,cc as _,u as L,r as a,t as P,I as S,B as m,d as T,m as B}from"./index-b4683d61.js";import{l as R}from"./snapshot-aa142fe1.js";import{i as O}from"./icon-option-c9fff0bb.js";import{T as A}from"./Table-76e623b5.js";import"./addEventListener-a27ae3f4.js";import"./useIcons-e0af7133.js";import"./CheckOutlined-e6bc730e.js";import"./Pagination-d2c763c6.js";import"./LeftOutlined-9e6e73a2.js";import"./useForceUpdate-f2aff5e0.js";import"./responsiveObserver-dc429d3b.js";import"./index-c09cc6d7.js";import"./index-10f1a096.js";import"./iconUtil-f3f90360.js";const K=i=>{const r=w(),n=()=>{r(i.value)};return e.jsx("div",{className:_["options-link"],children:e.jsxs("div",{className:_.link,onClick:()=>n(),children:[e.jsx("img",{src:O}),i.text]})})},te=()=>{const i=L(),r=w(),[n,l]=a.useState(!1),[y,u]=a.useState([]),[d,o]=a.useState(1),[c,p]=a.useState(10),[N,C]=a.useState(0),[h,x]=a.useState(!1),[g,j]=a.useState(""),[I,k]=a.useState([]),[f,v]=a.useState("");a.useEffect(()=>{document.title="学习照片",i(P("学习照片"))},[]),a.useEffect(()=>{D()},[d,c,h]);const D=()=>{n||(l(!0),R({page:d,size:c,user_id:g,type:I,other_id:f}).then(t=>{u(t.data.data),C(t.data.total),l(!1)}).catch(t=>{l(!1)}))},b=()=>{o(1),p(10),u([]),j(""),k([]),v(""),x(!h)},z={current:d,pageSize:c,total:N,onChange:(t,s)=>E(t,s),showSizeChanger:!0},E=(t,s)=>{o(t),p(s)},F=[{title:"学员ID",width:100,dataIndex:"user_id",render:t=>e.jsx("span",{children:t})},{title:"课程ID",width:100,dataIndex:"other_id",render:t=>e.jsx("span",{children:t})},{title:"学员",width:250,render:(t,s)=>e.jsxs(e.Fragment,{children:[s.user&&e.jsxs("div",{className:"user-item d-flex",children:[e.jsx("div",{className:"avatar",children:e.jsx("img",{src:s.user.avatar,width:"40",height:"40"})}),e.jsx("div",{className:"ml-10",children:s.user.nick_name})]}),!s.user&&e.jsx("span",{className:"c-red",children:"学员不存在"})]})},{title:"课程名称",render:(t,s)=>e.jsx("span",{children:s.type_title})},{title:"照片",width:100,render:(t,s)=>e.jsx("span",{children:s.count})},{title:"最后拍照时间",width:200,dataIndex:"last_snap_at",render:t=>e.jsx("span",{children:T(t)})},{title:"操作",width:80,render:(t,s)=>e.jsx(m,{type:"link",className:"c-primary",onClick:()=>{if(!s.images){B.warning("暂无照片");return}r("/snapshot/images?rid="+s.id+"&other_id="+s.other_id+"&user_id="+s.user_id)},children:"查看"})}];return e.jsxs("div",{className:"meedu-main-body",children:[e.jsxs("div",{className:"float-left j-b-flex mb-30",children:[e.jsx("div",{children:e.jsx(K,{text:"拍照设置",value:"/system/config?key=随机拍照&referer=%2Fsnapshot%2Findex"})}),e.jsxs("div",{className:"d-flex",children:[e.jsx(S,{value:g,onChange:t=>{j(t.target.value)},allowClear:!0,style:{width:150},placeholder:"学员ID"}),e.jsx(S,{value:f,onChange:t=>{v(t.target.value)},allowClear:!0,style:{width:150,marginLeft:10},placeholder:"课程ID"}),e.jsx(m,{className:"ml-10",onClick:b,children:"清空"}),e.jsx(m,{className:"ml-10",type:"primary",onClick:()=>{o(1),x(!h)},children:"筛选"})]})]}),e.jsx("div",{className:"float-left",children:e.jsx(A,{loading:n,columns:F,dataSource:y,rowKey:t=>t.id,pagination:z})})]})};export{te as default};
