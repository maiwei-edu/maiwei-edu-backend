import{u as T,b as R,f as D,r as x,a as E,t as K,cx as J,j as e,g as Q,I as p,S as m,B as o,cy as z,m as M}from"./index-3fd54424.js";import{B as O}from"./index-c3c15456.js";import{Q as X}from"./index-019b594b.js";import{F as i}from"./index-0ca68444.js";import{S as f}from"./index-27712364.js";import{U as u}from"./index-0b71564b.js";import"./LeftOutlined-a0f8cfa6.js";import"./index-749454db.js";import"./InboxOutlined-35d156a9.js";import"./selected-7e6221ce.js";import"./Dragger-3ad849c3.js";import"./useForceUpdate-56773729.js";import"./DeleteOutlined-529a4ffa.js";import"./CheckOutlined-44e74bd9.js";import"./row-98a37fbf.js";import"./responsiveObserver-a0dea2e5.js";import"./useIcons-235bc0cd.js";import"./Pagination-a2ebdf00.js";import"./index-ff4e3b6e.js";const ye=()=>{const b=T(),j=R(),[t]=i.useForm();new URLSearchParams(D().search);const[c,h]=x.useState(!0),_=E(s=>s.enabledAddonsConfig.value.enabledAddons),[g,v]=x.useState(""),[y,r]=x.useState(!1);x.useEffect(()=>{document.title="支付配置",b(K("支付配置")),w()},[]);const w=()=>{J().then(s=>{let l=s.data.支付;for(let a in l)l[a].key==="meedu.payment.alipay.enabled"?t.setFieldsValue({"meedu.payment.alipay.enabled":Number(l[a].value)}):l[a].key==="pay.alipay.app_id"?t.setFieldsValue({"pay.alipay.app_id":l[a].value}):l[a].key==="pay.alipay.ali_public_key"?t.setFieldsValue({"pay.alipay.ali_public_key":l[a].value}):l[a].key==="pay.alipay.alipay_root_cert"?t.setFieldsValue({"pay.alipay.alipay_root_cert":l[a].value}):l[a].key==="pay.alipay.app_cert_public_key"?t.setFieldsValue({"pay.alipay.app_cert_public_key":l[a].value}):l[a].key==="pay.alipay.private_key"?t.setFieldsValue({"pay.alipay.private_key":l[a].value}):l[a].key==="meedu.payment.wechat.enabled"?t.setFieldsValue({"meedu.payment.wechat.enabled":Number(l[a].value)}):l[a].key==="pay.wechat.app_id"?t.setFieldsValue({"pay.wechat.app_id":l[a].value}):l[a].key==="pay.wechat.appid"?t.setFieldsValue({"pay.wechat.appid":l[a].value}):l[a].key==="pay.wechat.mch_id"?t.setFieldsValue({"pay.wechat.mch_id":l[a].value}):l[a].key==="pay.wechat.key"?t.setFieldsValue({"pay.wechat.key":l[a].value}):l[a].key==="meedu.payment.handPay.enabled"?t.setFieldsValue({"meedu.payment.handPay.enabled":Number(l[a].value)}):l[a].key==="meedu.payment.handPay.introduction"?(t.setFieldsValue({"meedu.payment.handPay.introduction":l[a].value}),v(l[a].value)):l[a].key==="pay.wechat.cert_key"?t.setFieldsValue({"pay.wechat.cert_key":l[a].value}):l[a].key==="pay.wechat.cert_client"?t.setFieldsValue({"pay.wechat.cert_client":l[a].value}):l[a].key==="meedu.payment.wechat-jsapi.enabled"&&t.setFieldsValue({"meedu.payment.wechat-jsapi.enabled":Number(l[a].value)});h(!1)}).catch(s=>{h(!1)})},k=s=>{c||(h(!0),z({config:s}).then(l=>{h(!1),M.success("成功！"),w(),j(-1)}).catch(l=>{h(!1)}))},F=s=>{console.log("Failed:",s)},C=s=>{s?t.setFieldsValue({"meedu.payment.alipay.enabled":1}):t.setFieldsValue({"meedu.payment.alipay.enabled":0})},V=s=>{s?t.setFieldsValue({"meedu.payment.wechat.enabled":1}):t.setFieldsValue({"meedu.payment.wechat.enabled":0})},I=s=>{s?t.setFieldsValue({"meedu.payment.wechat-jsapi.enabled":1}):t.setFieldsValue({"meedu.payment.wechat-jsapi.enabled":0})},P=s=>{s?t.setFieldsValue({"meedu.payment.handPay.enabled":1}):t.setFieldsValue({"meedu.payment.handPay.enabled":0})},A={accept:".pem",beforeUpload:s=>{if(y)return;r(!0);const l=s,a=new FileReader;return a.onload=n=>{let d=n.target.result;t.setFieldsValue({"pay.wechat.cert_client":d}),r(!1)},a.readAsBinaryString(l),!1}},N={accept:".pem",beforeUpload:s=>{if(y)return;r(!0);const l=s,a=new FileReader;return a.onload=n=>{let d=n.target.result;t.setFieldsValue({"pay.wechat.cert_key":d}),r(!1)},a.readAsBinaryString(l),!1}},S={accept:".crt",beforeUpload:s=>{if(y)return;r(!0);const l=s,a=new FileReader;return a.onload=n=>{let d=n.target.result;t.setFieldsValue({"pay.alipay.ali_public_key":d}),r(!1)},a.readAsBinaryString(l),!1}},U={accept:".crt",beforeUpload:s=>{if(y)return;r(!0);const l=s,a=new FileReader;return a.onload=n=>{let d=n.target.result;t.setFieldsValue({"pay.alipay.app_cert_public_key":d}),r(!1)},a.readAsBinaryString(l),!1}},B={accept:".crt",beforeUpload:s=>{if(y)return;r(!0);const l=s,a=new FileReader;return a.onload=n=>{let d=n.target.result;t.setFieldsValue({"pay.alipay.alipay_root_cert":d}),r(!1)},a.readAsBinaryString(l),!1}},L={accept:".txt",beforeUpload:s=>{if(y)return;r(!0);const l=s,a=new FileReader;return a.onload=n=>{let d=n.target.result;t.setFieldsValue({"pay.alipay.private_key":d}),r(!1)},a.readAsBinaryString(l),!1}};return e.jsxs("div",{className:"meedu-main-body",children:[e.jsx(O,{title:"支付配置"}),c&&e.jsx("div",{style:{width:"100%",textAlign:"center",paddingTop:50,paddingBottom:30,boxSizing:"border-box"},children:e.jsx(Q,{})}),!c&&e.jsx("div",{className:"float-left",children:e.jsxs(i,{form:t,name:"system-payment-config",labelCol:{span:3},wrapperCol:{span:21},initialValues:{remember:!0},onFinish:k,onFinishFailed:F,autoComplete:"off",children:[e.jsx("div",{className:"from-title mt-30",children:"支付宝支付"}),e.jsx(i.Item,{label:"支付宝支付",name:"meedu.payment.alipay.enabled",valuePropName:"checked",children:e.jsx(f,{onChange:C})}),e.jsx(i.Item,{label:"支付宝AppId",name:"pay.alipay.app_id",children:e.jsx(p,{style:{width:300},allowClear:!0})}),e.jsx(i.Item,{label:"支付宝公钥",name:"pay.alipay.ali_public_key",children:e.jsxs(m,{align:"baseline",style:{height:100},children:[e.jsx(i.Item,{name:"pay.alipay.ali_public_key",children:e.jsx(p.TextArea,{rows:3,style:{width:300},allowClear:!0})}),e.jsx("div",{className:"d-flex ml-10",children:e.jsx(u,{...S,showUploadList:!1,children:e.jsx(o,{loading:c,type:"primary",children:"选择crt文件"})})})]})}),e.jsx(i.Item,{label:"应用私钥",name:"pay.alipay.private_key",children:e.jsxs(m,{align:"baseline",style:{height:100},children:[e.jsx(i.Item,{name:"pay.alipay.private_key",children:e.jsx(p.TextArea,{rows:3,style:{width:300},allowClear:!0})}),e.jsx("div",{className:"d-flex ml-10",children:e.jsx(u,{...L,showUploadList:!1,children:e.jsx(o,{loading:c,type:"primary",children:"选择TXT"})})})]})}),e.jsx(i.Item,{label:"支付宝根证书",name:"pay.alipay.alipay_root_cert",children:e.jsxs(m,{align:"baseline",style:{height:100},children:[e.jsx(i.Item,{name:"pay.alipay.alipay_root_cert",children:e.jsx(p.TextArea,{rows:3,style:{width:300},allowClear:!0})}),e.jsx("div",{className:"d-flex ml-10",children:e.jsx(u,{...B,showUploadList:!1,children:e.jsx(o,{loading:c,type:"primary",children:"选择crt文件"})})})]})}),e.jsx(i.Item,{label:"应用公钥证书",name:"pay.alipay.app_cert_public_key",children:e.jsxs(m,{align:"baseline",style:{height:100},children:[e.jsx(i.Item,{name:"pay.alipay.app_cert_public_key",children:e.jsx(p.TextArea,{rows:3,style:{width:300},allowClear:!0})}),e.jsx("div",{className:"d-flex ml-10",children:e.jsx(u,{...U,showUploadList:!1,children:e.jsx(o,{loading:c,type:"primary",children:"选择crt文件"})})})]})}),e.jsx("div",{className:"from-title mt-30",children:"微信支付"}),e.jsx(i.Item,{label:"微信扫码支付",name:"meedu.payment.wechat.enabled",valuePropName:"checked",children:e.jsx(f,{onChange:V})}),e.jsx(i.Item,{label:"微信JSAPI支付",name:"meedu.payment.wechat-jsapi.enabled",valuePropName:"checked",children:e.jsx(f,{onChange:I})}),e.jsx(i.Item,{label:"微信支付公众号AppId",name:"pay.wechat.app_id",children:e.jsx(p,{style:{width:300},allowClear:!0})}),_.TemplateOne&&e.jsx(i.Item,{label:"微信支付手机应用AppId",name:"pay.wechat.appid",children:e.jsx(p,{style:{width:300},allowClear:!0})}),e.jsx(i.Item,{label:"微信支付MchId",name:"pay.wechat.mch_id",children:e.jsx(p,{style:{width:300},allowClear:!0})}),e.jsx(i.Item,{label:"微信支付Key",name:"pay.wechat.key",children:e.jsx(p,{style:{width:300},allowClear:!0})}),e.jsx(i.Item,{label:"微信证书Client",name:"pay.wechat.cert_client",children:e.jsxs(m,{align:"baseline",style:{height:100},children:[e.jsx(i.Item,{name:"pay.wechat.cert_client",children:e.jsx(p.TextArea,{rows:3,style:{width:300},allowClear:!0})}),e.jsx("div",{className:"d-flex ml-10",children:e.jsx(u,{...A,showUploadList:!1,children:e.jsx(o,{loading:c,type:"primary",children:"选择证书"})})})]})}),e.jsx(i.Item,{label:"微信证书Key",name:"pay.wechat.cert_key",children:e.jsxs(m,{align:"baseline",style:{height:100},children:[e.jsx(i.Item,{name:"pay.wechat.cert_key",children:e.jsx(p.TextArea,{rows:3,style:{width:300},allowClear:!0})}),e.jsx("div",{className:"d-flex ml-10",children:e.jsx(u,{...N,showUploadList:!1,children:e.jsx(o,{loading:c,type:"primary",children:"选择证书"})})})]})}),e.jsx("div",{className:"from-title mt-30",children:"手动支付"}),e.jsx(i.Item,{label:"手动打款",name:"meedu.payment.handPay.enabled",valuePropName:"checked",children:e.jsx(f,{onChange:P})}),e.jsx(i.Item,{label:"手动打款说明",name:"meedu.payment.handPay.introduction",style:{height:440},children:e.jsx("div",{className:"w-800px",children:e.jsx(X,{mode:"",height:400,defautValue:g,isFormula:!1,setContent:s=>{t.setFieldsValue({"meedu.payment.handPay.introduction":s})}})})})]})}),e.jsx("div",{className:"bottom-menus",children:e.jsxs("div",{className:"bottom-menus-box",children:[e.jsx("div",{children:e.jsx(o,{loading:c,type:"primary",onClick:()=>t.submit(),children:"保存"})}),e.jsx("div",{className:"ml-24",children:e.jsx(o,{type:"default",onClick:()=>j(-1),children:"取消"})})]})})]})};export{ye as default};
