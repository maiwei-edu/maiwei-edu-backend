import{r as n,u as R,h as _,t as W,j as e}from"./index-b4683d61.js";import{i as B}from"./index-305edcd4.js";import{m as H,u as K,b as I,D as N}from"./index-9275dfb9.js";import{T as J}from"./Table-76e623b5.js";import"./addEventListener-a27ae3f4.js";import"./useIcons-e0af7133.js";import"./CheckOutlined-e6bc730e.js";import"./Pagination-d2c763c6.js";import"./LeftOutlined-9e6e73a2.js";import"./useForceUpdate-f2aff5e0.js";import"./responsiveObserver-dc429d3b.js";import"./index-c09cc6d7.js";import"./index-10f1a096.js";import"./iconUtil-f3f90360.js";const Q="_el_content_y2q6d_1",V="_el_top_row1_y2q6d_9",X="_el_row_item_y2q6d_16",Z="_item_title_y2q6d_33",$="_icon_y2q6d_48",ee="_item_info_y2q6d_64",te="_el_top_row2_y2q6d_87",se="_el_row_left_y2q6d_96",re="_header_y2q6d_110",oe="_controls_y2q6d_135",ne="_el_row_right_y2q6d_141",ae="_el_row_right_item_y2q6d_147",o={el_content:Q,el_top_row1:V,el_row_item:X,item_title:Z,icon:$,item_info:ee,el_top_row2:te,el_row_left:se,header:re,controls:oe,el_row_right:ne,el_row_right_item:ae},ve=()=>{let f=n.useRef(null);const S=R(),[x,d]=n.useState(!1),[h,y]=n.useState(1),[u,b]=n.useState(10),[D,Y]=n.useState(0),[s,F]=n.useState([]),[w,M]=n.useState(_().format("YYYY-MM-DD")),[j,q]=n.useState(_().add(1,"days").format("YYYY-MM-DD")),[T,z]=n.useState([]),[ie,C]=n.useState([]);n.useEffect(()=>(document.title="学员数据",S(W("学员数据")),k(),g(_().format("YYYY-MM-DD"),_().add(1,"days").format("YYYY-MM-DD")),()=>{window.onresize=null}),[]),n.useEffect(()=>{L()},[h,u,w,j]);const k=()=>{H({}).then(t=>{F(t.data)})},L=()=>{x||(d(!0),K({start_at:w,end_at:j,page:h,size:u}).then(t=>{z(t.data.data),Y(t.data.total),d(!1)}).catch(t=>{d(!1)}))},a=(t,r)=>{if(typeof t!="number"||typeof r!="number"||t===0)return 0;if(r===0)return 100;let c=((t-r)/r).toFixed(2);return Math.floor(c*100)},i=(t,r)=>{if(typeof t!="number"||typeof r!="number")return 0;if(r===t)return 100;let c=(r/(t-r)).toFixed(2);return Math.floor(c*100)},m=t=>t?Number(t).toLocaleString():0,p=t=>t>=1e8?(t/1e8).toFixed(2)+"亿":t>=1e7?(t/1e7).toFixed(2)+"千万":t>=1e6?(t/1e6).toFixed(2)+"百万":t>=1e4?(t/1e4).toFixed(2)+"万":t,P=t=>{y(t)},E=(t,r)=>{M(t),q(r),P(1)},G={current:h,pageSize:u,total:D,onChange:(t,r)=>U(t,r),showSizeChanger:!0},U=(t,r)=>{y(t),b(r)},A=[{title:"TOP10付费学员",render:(t,r)=>e.jsxs(e.Fragment,{children:[r.user.length===0&&e.jsx("span",{className:"c-red",children:"已删除"}),r.user.length!==0&&e.jsx("span",{children:r.user.nick_name})]})},{title:"支付订单数",width:250,render:(t,r)=>e.jsx("span",{children:r.count})},{title:"支付总金额",width:250,render:(t,r)=>e.jsx("span",{children:r.total})}],g=(t,r)=>(I({start_at:t,end_at:r}).then(l=>{C(l.data["first-non-first"]),O(l.data["first-non-first"])}),()=>{window.onresize=null}),O=t=>{let r=t.first_count+t.non_first_count,c=[{name:"新成交学员",value:t.first_count},{name:"老成交学员",value:t.non_first_count}],l=f.current,v=B(l);v.setOption({legend:[{selectedMode:!0,bottom:"10%",left:"center",textStyle:{fontSize:14,color:" #333333"},data:["新成交学员","老成交学员"]}],tooltip:{show:!0},title:{text:"",left:"center",bottom:0,itemGap:4,textStyle:{fontSize:16,fontWeight:400}},series:[{type:"pie",radius:["40%","60%"],center:["50%","40%"],color:["#3A7BFF","#FF9742"],avoidLabelOverlap:!1,itemStyle:{borderColor:"#fff",borderWidth:2},emphasis:{disabled:!0},label:{show:!0,position:"center",formatter:"付费"+r+"人"},labelLine:{show:!1},data:c}]}),window.onresize=()=>{v.resize()}};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:o.el_content,children:[e.jsxs("div",{className:o.el_top_row1,children:[e.jsxs("div",{className:o.el_row_item,children:[e.jsx("span",{className:o.item_title,children:"今日录播课学习学员"}),e.jsx("p",{children:m(s.today_watch_count||0)}),e.jsxs("div",{className:o.item_info,children:[e.jsxs("span",{children:["昨日：",p(s.yesterday_watch_count)]}),e.jsxs("span",{children:["较昨日：",a(s.today_watch_count,s.yesterday_watch_count)<0&&e.jsxs("strong",{className:"c-danger",children:[a(s.today_watch_count,s.yesterday_watch_count),"%"]}),a(s.today_watch_count,s.yesterday_watch_count)>=0&&e.jsxs("strong",{children:[a(s.today_watch_count,s.yesterday_watch_count),"%"]})]})]})]}),e.jsxs("div",{className:o.el_row_item,children:[e.jsx("span",{className:o.item_title,children:"今日新注册学员"}),e.jsx("p",{children:m(s.today_count||0)}),e.jsxs("div",{className:o.item_info,children:[e.jsxs("span",{children:["昨日：",p(s.yesterday_count)]}),e.jsxs("span",{children:["较昨日：",a(s.today_count,s.yesterday_count)<0&&e.jsxs("strong",{className:"c-danger",children:[a(s.today_count,s.yesterday_count),"%"]}),a(s.today_count,s.yesterday_count)>=0&&e.jsxs("strong",{children:[a(s.today_count,s.yesterday_count),"%"]})]})]})]}),e.jsxs("div",{className:o.el_row_item,children:[e.jsx("span",{className:o.item_title,children:"总学员数"}),e.jsx("p",{children:m(s.user_count||0)}),e.jsxs("div",{className:o.item_info,children:[e.jsxs("span",{children:["昨日：",p(s.yesterday_count)]}),e.jsxs("span",{children:["较上周：",i(s.user_count,s.week_count)<0&&e.jsxs("strong",{className:"c-danger",children:[i(s.user_count,s.week_count),"%"]}),i(s.user_count,s.week_count)>=0&&e.jsxs("strong",{children:[i(s.user_count,s.week_count),"%"]})]}),e.jsxs("span",{children:["较上月：",i(s.user_count,s.month_count)<0&&e.jsxs("strong",{className:"c-danger",children:[i(s.user_count,s.month_count),"%"]}),i(s.user_count,s.month_count)>=0&&e.jsxs("strong",{children:[i(s.user_count,s.month_count),"%"]})]})]})]})]}),e.jsxs("div",{className:o.el_top_row2,children:[e.jsxs("div",{className:o.el_row_left,children:[e.jsxs("div",{className:o.header,children:[e.jsx("div",{className:o.item_title,children:e.jsx("span",{children:"Top10付费学员"})}),e.jsx("div",{className:o.controls,children:e.jsx(N,{active:!1,onChange:(t,r)=>{E(t,r)}})})]}),e.jsx("div",{className:"float-left mt-15",children:e.jsx(J,{loading:x,columns:A,dataSource:T,rowKey:t=>t.user_id,pagination:G})})]}),e.jsx("div",{className:o.el_row_right,children:e.jsxs("div",{className:o.el_row_right_item,children:[e.jsxs("div",{className:o.header,children:[e.jsx("div",{className:o.item_title,children:e.jsx("span",{children:"新老学员成交趋势"})}),e.jsx("div",{className:o.controls,children:e.jsx(N,{active:!1,onChange:(t,r)=>{g(t,r)}})})]}),e.jsx("div",{ref:f,style:{width:"100%",height:273,marginTop:16,position:"relative"}})]})})]})]})})};export{ve as default};
