import{r as s,j as e,M as b,I as x,S as C,m as w,g as D,u as _,t as E,E as N}from"./index-3fd54424.js";import{b as q,e as B,f as L,g as T,h as U}from"./book-3be45c7b.js";import{B as V}from"./index-c3c15456.js";import{P as y}from"./index-df05a090.js";import{H as k}from"./index-d5d1e443.js";import{F as r}from"./index-0ca68444.js";import{T as W}from"./Table-59a53b18.js";import"./LeftOutlined-a0f8cfa6.js";import"./InfoCircleOutlined-fefc69ce.js";import"./row-98a37fbf.js";import"./responsiveObserver-a0dea2e5.js";import"./addEventListener-1752243f.js";import"./useIcons-235bc0cd.js";import"./CheckOutlined-44e74bd9.js";import"./Pagination-a2ebdf00.js";import"./useForceUpdate-56773729.js";import"./index-ff4e3b6e.js";import"./index-a56efb1a.js";import"./iconUtil-14ff0944.js";const A=t=>{const[a]=r.useForm(),[l,i]=s.useState(!1);s.useEffect(()=>{t.open&&a.setFieldsValue({name:"",sort:""})},[t.open]);const m=d=>{l||(i(!0),q(d).then(f=>{i(!1),w.success("成功！"),t.onSuccess()}).catch(f=>{i(!1)}))},c=d=>{console.log("Failed:",d)};return e.jsx(e.Fragment,{children:t.open?e.jsx(b,{title:"添加分类",onCancel:()=>{t.onCancel()},open:!0,width:800,maskClosable:!1,onOk:()=>{a.submit()},centered:!0,children:e.jsx("div",{className:"float-left mt-30",children:e.jsxs(r,{form:a,name:"live-category-create-dailog",labelCol:{span:3},wrapperCol:{span:21},initialValues:{remember:!0},onFinish:m,onFinishFailed:c,autoComplete:"off",children:[e.jsx(r.Item,{label:"分类名称",name:"name",rules:[{required:!0,message:"请输入分类名称!"}],children:e.jsx(x,{style:{width:300},placeholder:"请输入分类名称",allowClear:!0})}),e.jsx(r.Item,{label:"排序",name:"sort",rules:[{required:!0,message:"填输入排序!"}],children:e.jsxs(C,{align:"baseline",style:{height:32},children:[e.jsx(r.Item,{name:"sort",rules:[{required:!0,message:"填输入排序!"}],children:e.jsx(x,{type:"number",style:{width:300},placeholder:"填输入排序",allowClear:!0})}),e.jsx("div",{className:"ml-10",children:e.jsx(k,{text:"填写整数，数字越小排序越靠前"})})]})})]})})}):null})},O=t=>{const[a]=r.useForm(),[l,i]=s.useState(!0),[m,c]=s.useState(!1);s.useEffect(()=>{t.open&&(i(!0),a.setFieldsValue({name:"",sort:""})),t.id>0&&d()},[t.open,t.id]);const d=async()=>{await f(),i(!1)},f=async()=>{const n=await B(t.id);a.setFieldsValue({name:n.data.name,sort:n.data.sort})},h=n=>{m||(c(!0),L(t.id,n).then(g=>{c(!1),w.success("成功！"),t.onSuccess()}).catch(g=>{c(!1)}))},p=n=>{console.log("Failed:",n)};return e.jsx(e.Fragment,{children:t.open?e.jsxs(b,{title:"编辑分类",onCancel:()=>{t.onCancel()},open:!0,width:800,maskClosable:!1,onOk:()=>{a.submit()},centered:!0,children:[l&&e.jsx("div",{className:"float-left text-center mt-30",children:e.jsx(D,{})}),e.jsx("div",{style:{display:l?"none":"block"},className:"float-left mt-30",children:e.jsxs(r,{form:a,name:"live-category-update-dailog",labelCol:{span:3},wrapperCol:{span:21},initialValues:{remember:!0},onFinish:h,onFinishFailed:p,autoComplete:"off",children:[e.jsx(r.Item,{label:"分类名称",name:"name",rules:[{required:!0,message:"请输入分类名称!"}],children:e.jsx(x,{style:{width:300},placeholder:"请输入分类名称",allowClear:!0})}),e.jsx(r.Item,{label:"排序",name:"sort",rules:[{required:!0,message:"填输入排序!"}],children:e.jsxs(C,{align:"baseline",style:{height:32},children:[e.jsx(r.Item,{name:"sort",rules:[{required:!0,message:"填输入排序!"}],children:e.jsx(x,{type:"number",style:{width:300},placeholder:"填输入排序",allowClear:!0})}),e.jsx("div",{className:"ml-10",children:e.jsx(k,{text:"填写整数，数字越小排序越靠前"})})]})})]})})]}):null})},{confirm:P}=b,re=()=>{const t=_(),[a,l]=s.useState(!1),[i,m]=s.useState([]),[c,d]=s.useState(!1),[f,h]=s.useState(!1),[p,n]=s.useState(!1),[g,S]=s.useState(0);s.useEffect(()=>{document.title="电子书分类管理",t(E("电子书分类管理"))},[]),s.useEffect(()=>{F()},[c]);const F=()=>{a||(l(!0),T({}).then(o=>{m(o.data),l(!1)}).catch(o=>{l(!1)}))},I=[{title:"排序",width:150,render:(o,u)=>e.jsx("span",{children:u.sort})},{title:"分类名",render:(o,u)=>e.jsxs("span",{children:[u.name," "]})},{title:"操作",width:160,fixed:"right",render:(o,u)=>e.jsxs(C,{children:[e.jsx(y,{type:"link",text:"编辑",class:"c-primary",icon:null,p:"addons.meedu_books.book_category.update",onClick:()=>{S(u.id),n(!0)},disabled:null}),e.jsx(y,{type:"link",text:"删除",class:"c-red",icon:null,p:"addons.meedu_books.book_category.delete",onClick:()=>{v(u.id)},disabled:null})]})}],j=()=>{m([]),d(!c)},v=o=>{o!==0&&P({title:"操作确认",icon:e.jsx(N,{}),content:"确认删除此分类？",centered:!0,okText:"确认",cancelText:"取消",onOk(){a||(l(!0),U(o).then(()=>{l(!1),w.success("删除成功"),j()}).catch(u=>{l(!1)}))},onCancel(){console.log("Cancel")}})};return e.jsxs("div",{className:"meedu-main-body",children:[e.jsx(V,{title:"电子书分类管理"}),e.jsx(A,{open:f,onCancel:()=>h(!1),onSuccess:()=>{j(),h(!1)}}),e.jsx(O,{id:g,open:p,onCancel:()=>n(!1),onSuccess:()=>{j(),n(!1)}}),e.jsx("div",{className:"float-left  mt-30 mb-30",children:e.jsx(y,{type:"primary",text:"添加分类",class:"",icon:null,p:"addons.meedu_books.book_category.store",onClick:()=>h(!0),disabled:null})}),e.jsx("div",{className:"float-left",children:e.jsx(W,{loading:a,columns:I,dataSource:i,rowKey:o=>o.id,pagination:!1})})]})};export{re as default};
