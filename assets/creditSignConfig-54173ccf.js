import{u as p,b as g,r as u,a as j,t as w,cx as y,j as e,g as v,I as m,B as h,cy as C,m as _}from"./index-b4683d61.js";import{B as F}from"./index-5f967da4.js";import{F as i}from"./index-d434f3eb.js";import"./LeftOutlined-9e6e73a2.js";import"./row-4ee18533.js";import"./responsiveObserver-dc429d3b.js";const V=()=>{const x=p(),o=g(),[r]=i.useForm(),[n,d]=u.useState(!0);j(s=>s.enabledAddonsConfig.value.enabledAddons),u.useEffect(()=>{document.title="积分配置",x(w("积分配置")),c()},[]);const c=()=>{y().then(s=>{let l=s.data.每日签到;for(let t in l)l[t].key==="meedu.addons.DaySignIn.reward_rule"&&r.setFieldsValue({"meedu.addons.DaySignIn.reward_rule":l[t].value});let a=s.data.积分;for(let t in a)a[t].key==="meedu.member.credit1.register"?r.setFieldsValue({"meedu.member.credit1.register":a[t].value}):a[t].key==="meedu.member.credit1.watched_course"?r.setFieldsValue({"meedu.member.credit1.watched_course":a[t].value}):a[t].key==="meedu.member.credit1.watched_video"?r.setFieldsValue({"meedu.member.credit1.watched_video":a[t].value}):a[t].key==="meedu.member.credit1.paid_order"&&r.setFieldsValue({"meedu.member.credit1.paid_order":a[t].value});d(!1)}).catch(s=>{d(!1)})},b=s=>{n||(d(!0),C({config:s}).then(l=>{d(!1),_.success("成功！"),c(),o(-1)}).catch(l=>{d(!1)}))},f=s=>{console.log("Failed:",s)};return e.jsxs("div",{className:"meedu-main-body",children:[e.jsx(F,{title:"积分配置"}),n&&e.jsx("div",{style:{width:"100%",textAlign:"center",paddingTop:50,paddingBottom:30,boxSizing:"border-box"},children:e.jsx(v,{})}),!n&&e.jsx("div",{className:"float-left mt-30",children:e.jsxs(i,{form:r,name:"system-creditSign-config",labelCol:{span:3},wrapperCol:{span:21},initialValues:{remember:!0},onFinish:b,onFinishFailed:f,autoComplete:"off",children:[e.jsx(i.Item,{label:"积分签到奖励规则",name:"meedu.addons.DaySignIn.reward_rule",children:e.jsx(m,{style:{width:300},allowClear:!0})}),e.jsx(i.Item,{label:"注册奖励",name:"meedu.member.credit1.register",children:e.jsx(m,{style:{width:300},allowClear:!0})}),e.jsx(i.Item,{label:"看完课程",name:"meedu.member.credit1.watched_course",children:e.jsx(m,{style:{width:300},allowClear:!0})}),e.jsx(i.Item,{label:"看完视频",name:"meedu.member.credit1.watched_video",children:e.jsx(m,{style:{width:300},allowClear:!0})}),e.jsxs(i.Item,{label:"支付订单",name:"meedu.member.credit1.paid_order",children:[e.jsx(i.Item,{name:"meedu.member.credit1.paid_order",children:e.jsx(m,{style:{width:300},allowClear:!0})}),e.jsx("div",{className:"form-helper-text",children:e.jsx("span",{children:"注意，支付订单的积分奖励与上面不同，它是根据订单金额*百分比奖励的，所以这里应该填写百分比。举个例子：订单支付金额100元，这里填写0.1，则用户奖励10积分。"})})]})]})}),e.jsx("div",{className:"bottom-menus",children:e.jsxs("div",{className:"bottom-menus-box",children:[e.jsx("div",{children:e.jsx(h,{loading:n,type:"primary",onClick:()=>r.submit(),children:"保存"})}),e.jsx("div",{className:"ml-24",children:e.jsx(h,{type:"default",onClick:()=>o(-1),children:"取消"})})]})})]})};export{V as default};
