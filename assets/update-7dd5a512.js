import{f as _,u as k,b as B,r as a,t as R,j as e,g as A,I as x,B as j,m as D}from"./index-b4683d61.js";import{b as E,c as T,u as L}from"./admin-role-11f718fe.js";import{B as P}from"./index-5f967da4.js";import{F as r}from"./index-d434f3eb.js";import{T as q}from"./index-52c44623.js";import"./LeftOutlined-9e6e73a2.js";import"./row-4ee18533.js";import"./responsiveObserver-dc429d3b.js";import"./useIcons-e0af7133.js";import"./CheckOutlined-e6bc730e.js";import"./iconUtil-f3f90360.js";const X=()=>{const m=new URLSearchParams(_().search),[c]=r.useForm(),y=k(),u=B(),[p,b]=a.useState(!0),[h,d]=a.useState(!1),[g,v]=a.useState([]),[l,w]=a.useState(Number(m.get("id")));a.useEffect(()=>{document.title="编辑管理员角色",y(R("编辑管理员角色")),C()},[l]),a.useEffect(()=>{w(Number(m.get("id")))},[m.get("id")]);const C=async()=>{await F(),await N(),b(!1)},N=async()=>{if(l===0)return;var s=(await E(l)).data;c.setFieldsValue({description:s.description,display_name:s.display_name,permission_ids:s.permission_ids})},F=async()=>{const t=await T(),s=[];let n=t.data.permissions;for(let i in n){let f=[];for(let o=0;o<n[i].length;o++)f.push({value:n[i][o].id,title:n[i][o].display_name});s.push({value:i,title:i,children:f})}v(s)},S=t=>{h||(d(!0),L(l,t).then(s=>{d(!1),D.success("保存成功！"),u(-1)}).catch(s=>{d(!1)}))},I=t=>{console.log("Failed:",t)};return e.jsxs("div",{className:"meedu-main-body",children:[e.jsx(P,{title:"编辑管理员角色"}),p&&e.jsx("div",{className:"float-left text-center mt-30",children:e.jsx(A,{})}),e.jsx("div",{style:{display:p?"none":"block"},className:"float-left mt-30",children:e.jsxs(r,{form:c,name:"administrator-create",labelCol:{span:3},wrapperCol:{span:21},initialValues:{remember:!0},onFinish:S,onFinishFailed:I,autoComplete:"off",children:[e.jsx(r.Item,{label:"角色名",name:"display_name",rules:[{required:!0,message:"请输入角色名!"}],children:e.jsx(x,{style:{width:300},placeholder:"请输入角色名",allowClear:!0})}),e.jsx(r.Item,{label:"描述",name:"description",rules:[{required:!0,message:"请输入描述!"}],children:e.jsx(x,{style:{width:300},placeholder:"请输入描述",allowClear:!0})}),e.jsx(r.Item,{label:"权限",name:"permission_ids",children:e.jsx(q,{listHeight:400,style:{width:"100%"},treeCheckable:!0,placeholder:"请选择权限",multiple:!0,allowClear:!0,treeData:g})})]})}),e.jsx("div",{className:"bottom-menus",children:e.jsxs("div",{className:"bottom-menus-box",children:[e.jsx("div",{children:e.jsx(j,{loading:h,type:"primary",onClick:()=>c.submit(),children:"保存"})}),e.jsx("div",{className:"ml-24",children:e.jsx(j,{type:"default",onClick:()=>u(-1),children:"取消"})})]})})]})};export{X as default};
