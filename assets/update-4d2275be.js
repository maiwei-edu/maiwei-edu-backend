import{f as B,u as L,b as E,r as l,t as T,j as e,g as D,S as H,I as d,B as j,m as P}from"./index-3fd54424.js";import{a as q,c as A,u as R}from"./wechat-f8e0631e.js";import{B as U}from"./index-c3c15456.js";import{H as V}from"./index-d5d1e443.js";import{F as a}from"./index-0ca68444.js";import{S as f}from"./index-ff4e3b6e.js";import"./LeftOutlined-a0f8cfa6.js";import"./InfoCircleOutlined-fefc69ce.js";import"./row-98a37fbf.js";import"./responsiveObserver-a0dea2e5.js";import"./useIcons-235bc0cd.js";import"./CheckOutlined-44e74bd9.js";const ee=()=>{const i=new URLSearchParams(B().search),[o]=a.useForm(),b=L(),p=E(),[u,g]=l.useState(!0),[h,c]=l.useState(!1),[v,w]=l.useState([]),[x,y]=l.useState(""),[r,C]=l.useState(Number(i.get("id"))),I=[{value:"subscribe",label:"用户关注"},{value:"CLICK",label:"自定义菜单事件"}];l.useEffect(()=>{document.title="编辑自动回复",b(T("编辑自动回复")),S()},[r]),l.useEffect(()=>{C(Number(i.get("id")))},[i.get("id")]);const S=async()=>{await k(),await N(),g(!1)},N=async()=>{if(r===0)return;var t=(await q(r)).data.data;y(t.type),o.setFieldsValue({reply_content:t.reply_content,event_key:t.event_key,rule:t.rule,event_type:t.event_type,type:t.type})},k=async()=>{const s=await A(),t=[];let m=s.data.types;for(let n=0;n<m.length;n++)t.push({label:m[n].name,value:m[n].id});w(t)},F=s=>{h||(c(!0),R(r,s).then(t=>{c(!1),P.success("保存成功！"),p(-1)}).catch(t=>{c(!1)}))},_=s=>{console.log("Failed:",s)};return e.jsxs("div",{className:"meedu-main-body",children:[e.jsx(U,{title:"编辑自动回复"}),u&&e.jsx("div",{className:"float-left text-center mt-30",children:e.jsx(D,{})}),e.jsx("div",{style:{display:u?"none":"block"},className:"float-left mt-30",children:e.jsxs(a,{form:o,name:"wechat-update",labelCol:{span:3},wrapperCol:{span:21},initialValues:{remember:!0},onFinish:F,onFinishFailed:_,autoComplete:"off",children:[e.jsx(a.Item,{label:"消息类型",name:"type",rules:[{required:!0,message:"请选择消息类型!"}],children:e.jsx(f,{style:{width:300},allowClear:!0,placeholder:"请选择消息类型",options:v,onChange:s=>{y(s)}})}),x==="text"&&e.jsx(a.Item,{label:"触发关键字",children:e.jsxs(H,{align:"baseline",style:{height:32},children:[e.jsx(a.Item,{name:"rule",children:e.jsx(d,{style:{width:300},placeholder:"请输入触发关键字",allowClear:!0})}),e.jsx("div",{className:"ml-10",children:e.jsx(V,{text:"支持正则表达式"})})]})}),x==="event"&&e.jsxs(e.Fragment,{children:[e.jsx(a.Item,{label:"事件",name:"event_type",children:e.jsx(f,{style:{width:300},allowClear:!0,placeholder:"请选择事件",options:I})}),e.jsx(a.Item,{label:"事件key",name:"event_key",children:e.jsx(d,{style:{width:300},allowClear:!0,placeholder:"请输入事件key"})})]}),e.jsx(a.Item,{label:"回复内容",name:"reply_content",rules:[{required:!0,message:"请输入回复内容!"}],children:e.jsx(d.TextArea,{style:{width:500,minHeight:120},placeholder:"请输入回复内容",allowClear:!0,maxLength:200})})]})}),e.jsx("div",{className:"bottom-menus",children:e.jsxs("div",{className:"bottom-menus-box",children:[e.jsx("div",{children:e.jsx(j,{loading:h,type:"primary",onClick:()=>o.submit(),children:"保存"})}),e.jsx("div",{className:"ml-24",children:e.jsx(j,{type:"default",onClick:()=>p(-1),children:"取消"})})]})})]})};export{ee as default};
