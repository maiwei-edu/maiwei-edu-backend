import{u as T,b as z,r as n,t as F,j as e,I,B as f,S as B,E as D,m as L,M}from"./index-3fd54424.js";import{l as O,d as R}from"./codeExchanger-51e29e94.js";import{P as o}from"./index-df05a090.js";import{T as $}from"./Table-59a53b18.js";import"./addEventListener-1752243f.js";import"./useIcons-235bc0cd.js";import"./CheckOutlined-44e74bd9.js";import"./Pagination-a2ebdf00.js";import"./LeftOutlined-a0f8cfa6.js";import"./useForceUpdate-56773729.js";import"./responsiveObserver-a0dea2e5.js";import"./index-ff4e3b6e.js";import"./index-a56efb1a.js";import"./iconUtil-14ff0944.js";const{confirm:A}=M,ae=()=>{const y=T(),r=z(),[d,l]=n.useState(!1),[C,p]=n.useState([]),[x,c]=n.useState(1),[u,m]=n.useState(10),[v,E]=n.useState(0),[i,h]=n.useState(!1),[g,j]=n.useState("");n.useEffect(()=>{document.title="兑换活动",y(F("兑换活动"))},[]),n.useEffect(()=>{S()},[x,u,i]);const S=()=>{d||(l(!0),O({page:x,size:u,name:g}).then(s=>{p(s.data.data),E(s.data.total),l(!1)}).catch(s=>{l(!1)}))},k=()=>{c(1),m(10),p([]),j(""),h(!i)},b={current:x,pageSize:u,total:v,onChange:(s,t)=>N(s,t),showSizeChanger:!0},N=(s,t)=>{c(s),m(t)},_=[{title:"活动名",width:240,dataIndex:"name",render:s=>e.jsx("span",{children:s})},{title:"兑换商品",render:(s,t)=>e.jsx(e.Fragment,{children:JSON.parse(t.relate_data).map(a=>e.jsxs("div",{children:[a.sign==="vod"&&e.jsxs("span",{children:["录播-",a.name]}),a.sign==="live"&&e.jsxs("span",{children:["直播-",a.name]}),a.sign==="book"&&e.jsxs("span",{children:["电子书-",a.name]}),a.sign==="paper"&&e.jsxs("span",{children:["考试-",a.name]}),a.sign==="mock_paper"&&e.jsxs("span",{children:["模拟-",a.name]}),a.sign==="practice"&&e.jsxs("span",{children:["练习-",a.name]}),a.sign==="vip"&&e.jsxs("span",{children:["VIP-",a.name]})]},a.id))})},{title:"使用率",width:200,render:(s,t)=>e.jsx(e.Fragment,{children:t.code_count>0&&e.jsxs("span",{children:[(t.used_count*100/t.code_count).toFixed(2),"%"]})})},{title:"操作",width:150,render:(s,t)=>e.jsxs(B,{children:[e.jsx(o,{type:"link",text:"兑换码",class:"c-primary",icon:null,p:"addons.CodeExchanger.activity-code.list",onClick:()=>{r("/codeExchanger/codes?id="+t.id)},disabled:null}),e.jsx(o,{type:"link",text:"编辑",class:"c-primary",icon:null,p:"addons.CodeExchanger.activity.update",onClick:()=>{r("/codeExchanger/update?id="+t.id)},disabled:null}),e.jsx(o,{type:"link",text:"删除",class:"c-red",icon:null,p:"addons.CodeExchanger.activity.destroy",onClick:()=>{P(t.id)},disabled:null})]})}],w=()=>{c(1),p([]),h(!i)},P=s=>{s!==0&&A({title:"操作确认",icon:e.jsx(D,{}),content:"确认删除此活动？",centered:!0,okText:"确认",cancelText:"取消",onOk(){d||(l(!0),R(s).then(()=>{l(!1),L.success("删除成功"),w()}).catch(t=>{l(!1)}))},onCancel(){console.log("Cancel")}})};return e.jsxs("div",{className:"meedu-main-body",children:[e.jsxs("div",{className:"float-left j-b-flex mb-30",children:[e.jsx("div",{className:"d-flex",children:e.jsx(o,{type:"primary",text:"新建兑换活动",class:"",icon:null,p:"addons.CodeExchanger.activity.store",onClick:()=>r("/codeExchanger/create"),disabled:null})}),e.jsxs("div",{className:"d-flex",children:[e.jsx(I,{value:g,onChange:s=>{j(s.target.value)},allowClear:!0,style:{width:150},placeholder:"活动名称关键字"}),e.jsx(f,{className:"ml-10",onClick:k,children:"清空"}),e.jsx(f,{className:"ml-10",type:"primary",onClick:()=>{c(1),h(!i)},children:"筛选"})]})]}),e.jsx("div",{className:"float-left",children:e.jsx($,{loading:d,columns:_,dataSource:C,rowKey:s=>s.id,pagination:b})})]})};export{ae as default};
