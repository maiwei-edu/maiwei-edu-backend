import{f as V,u as W,r as a,t as X,j as s,B as x,m as k,E as Y,M as Z}from"./index-b4683d61.js";import{r as $,t as ee}from"./paper-7f0d6524.js";import{B as te}from"./index-5f967da4.js";import{Q as se}from"./index-68c2beeb.js";import{S}from"./index-c09cc6d7.js";import{T as ae}from"./Table-76e623b5.js";import"./LeftOutlined-9e6e73a2.js";import"./useIcons-e0af7133.js";import"./CheckOutlined-e6bc730e.js";import"./addEventListener-a27ae3f4.js";import"./Pagination-d2c763c6.js";import"./useForceUpdate-f2aff5e0.js";import"./responsiveObserver-dc429d3b.js";import"./index-10f1a096.js";import"./iconUtil-f3f90360.js";const{confirm:le}=Z,ye=()=>{const d=new URLSearchParams(V().search),E=W(),[u,n]=a.useState(!1),[R,m]=a.useState([]),[p,h]=a.useState(1),[f,j]=a.useState(20),[T,P]=a.useState(0),[i,g]=a.useState(!1),[r,q]=a.useState(Number(d.get("id"))),[c,y]=a.useState([]),[v,w]=a.useState([]),[B,z]=a.useState([]),[C,b]=a.useState([]),[D,I]=a.useState([]),[L,N]=a.useState([]),[K,M]=a.useState([]);a.useEffect(()=>{document.title="新建试题",E(X("新建试题"))},[]),a.useEffect(()=>{q(Number(d.get("id")))},[d.get("id")]),a.useEffect(()=>{Q()},[r,p,f,i]);const Q=()=>{u||(n(!0),$(r,{id:r,page:p,size:f,in:0,category_id:v,type:C,level:L}).then(e=>{m(e.data.questions.data),P(e.data.questions.total);let t=[];e.data.categories.length>0&&e.data.categories.map(l=>{t.push({label:l.name,value:l.id})}),z(t);let o=[];e.data.types.length>0&&e.data.types.map(l=>{o.push({label:l.name,value:l.id})}),I(o);let _=[];e.data.levels.length>0&&e.data.levels.map(l=>{_.push({label:l.name,value:l.id})}),M(_),n(!1)}).catch(e=>{n(!1)}))},A=()=>{h(1),j(20),m([]),b([]),w([]),N([]),g(!i)},F=()=>{m([]),y([]),g(!i)},O=[{title:"试题ID",width:150,render:(e,t)=>s.jsx("span",{children:t.id})},{title:"分类",width:200,render:(e,t)=>{var o;return s.jsx("span",{children:((o=t==null?void 0:t.category)==null?void 0:o.name)||"-"})}},{title:"类型",width:200,render:(e,t)=>s.jsx("span",{children:t.type_text})},{title:"难度",width:200,render:(e,t)=>s.jsx("span",{children:t.level_text})},{title:"分数",width:150,render:(e,t)=>s.jsx("span",{children:t.score})},{title:"内容",render:(e,t)=>s.jsx(se,{question:t})}],U={selectedRowKeys:c,onChange:(e,t)=>{y(e)}},G=()=>{if(c.length===0){k.error("请选择需要操作的数据");return}le({title:"操作确认",icon:s.jsx(Y,{}),content:"确认添加选中试题？",centered:!0,okText:"确认添加",cancelText:"取消",onOk(){u||(n(!0),ee(r,{s:c}).then(e=>{k.success(e.message),F(),n(!1)}).catch(e=>{n(!1)}))},onCancel(){console.log("Cancel")}})},H={current:p,pageSize:f,total:T,onChange:(e,t)=>J(e,t),showSizeChanger:!0},J=(e,t)=>{h(e),j(t)};return s.jsxs("div",{className:"meedu-main-body",children:[s.jsx(te,{title:"新建试题"}),s.jsxs("div",{className:"float-left j-b-flex mb-30 mt-30",children:[s.jsx("div",{className:"d-flex",children:s.jsx(x,{type:"primary",onClick:()=>G(),children:"批量添加"})}),s.jsxs("div",{className:"d-flex",children:[s.jsx(S,{style:{width:150},value:v,onChange:e=>{w(e)},allowClear:!0,placeholder:"分类",options:B}),s.jsx(S,{style:{width:150,marginLeft:10},value:C,onChange:e=>{b(e)},allowClear:!0,placeholder:"类型",options:D}),s.jsx(S,{style:{width:150,marginLeft:10},value:L,onChange:e=>{N(e)},allowClear:!0,placeholder:"难度",options:K}),s.jsx(x,{className:"ml-10",onClick:A,children:"清空"}),s.jsx(x,{className:"ml-10",type:"primary",onClick:()=>{h(1),g(!i)},children:"筛选"})]})]}),s.jsxs("div",{className:"float-left mb-30 check-num",children:["已选择",c.length,"项"]}),s.jsx("div",{className:"float-left",children:s.jsx(ae,{rowSelection:{type:"checkbox",...U},loading:u,columns:O,dataSource:R,rowKey:e=>e.id,pagination:H})})]})};export{ye as default};
