import{u as w,b as k,r as s,t as F,j as e,B as n,S as H,I as h,m as c,h as u}from"./index-b4683d61.js";import{s as I}from"./miaosha-36726402.js";import{B as M}from"./index-5f967da4.js";import{H as N}from"./index-133d6e1c.js";import{S as R}from"./index-ea4492e3.js";import{F as r}from"./index-d434f3eb.js";import{D as q}from"./index-cc7d88a3.js";import"./LeftOutlined-9e6e73a2.js";import"./InfoCircleOutlined-4d24221b.js";import"./course-7dc1c12e.js";import"./Table-76e623b5.js";import"./addEventListener-a27ae3f4.js";import"./useIcons-e0af7133.js";import"./CheckOutlined-e6bc730e.js";import"./Pagination-d2c763c6.js";import"./useForceUpdate-f2aff5e0.js";import"./responsiveObserver-dc429d3b.js";import"./index-c09cc6d7.js";import"./index-10f1a096.js";import"./iconUtil-f3f90360.js";import"./live-ef2dd82c.js";import"./role-513b287e.js";import"./book-a8b4ca06.js";import"./path-6d6aef48.js";import"./topic-842c58e2.js";import"./paper-7f0d6524.js";import"./practice-e65e37d7.js";import"./mock-274446b7.js";import"./index-d198db66.js";import"./PlusOutlined-c97c4cac.js";import"./row-4ee18533.js";const{RangePicker:B}=q,he=()=>{const[a]=r.useForm(),g=w(),d=k(),[i,m]=s.useState(!1),[o,x]=s.useState(""),[f,j]=s.useState(""),[b,p]=s.useState(""),[y,_]=s.useState(""),[S,l]=s.useState(!1);s.useEffect(()=>{document.title="新建秒杀活动",g(F("新建秒杀活动"))},[]);const Y=t=>{if(!i){if(t.charge<0){c.error("请输入正确的秒杀价");return}if(t.num<0){c.error("请输入正确的库存");return}m(!0),t.goods_type=b,t.original_charge=y,t.goods_title=o,t.goods_thumb=f,t.end_at=u(new Date(t.started_at[1])).format("YYYY-MM-DD HH:mm"),t.started_at=u(new Date(t.started_at[0])).format("YYYY-MM-DD HH:mm"),I(t).then(D=>{m(!1),c.success("保存成功！"),d(-1)}).catch(D=>{m(!1)})}},C=t=>{console.log("Failed:",t)};return e.jsxs("div",{className:"meedu-main-body",children:[e.jsx(M,{title:"新建秒杀活动"}),e.jsx(R,{open:S,enabledResource:"vod,live,book,learnPath",onCancel:()=>l(!1),onSelected:t=>{a.setFieldsValue({goods_id:t.id}),x(t.title),j(t.thumb),t.resource_type==="vod"?p("course"):p(t.resource_type),_(t.original_charge),l(!1)}}),e.jsx("div",{className:"float-left mt-30",children:e.jsxs(r,{form:a,name:"miaosha-create",labelCol:{span:3},wrapperCol:{span:21},initialValues:{remember:!0},onFinish:Y,onFinishFailed:C,autoComplete:"off",children:[e.jsx(r.Item,{label:"商品",name:"goods_id",rules:[{required:!0,message:"请选择商品!"}],children:e.jsxs(n,{loading:i,type:"primary",onClick:()=>l(!0),children:[o&&e.jsxs("span",{children:["已选择「",o,"」"]}),!o&&e.jsx("span",{children:"选择商品"})]})}),e.jsx(r.Item,{label:"秒杀价",name:"charge",rules:[{required:!0,message:"请输入秒杀价!"}],children:e.jsxs(H,{align:"baseline",style:{height:32},children:[e.jsx(r.Item,{name:"charge",rules:[{required:!0,message:"请输入秒杀价!"}],children:e.jsx(h,{style:{width:300},placeholder:"请输入秒杀价",allowClear:!0,type:"number"})}),e.jsx("div",{className:"ml-10",children:e.jsx(N,{text:"最小单位：元。不支持小数。"})})]})}),e.jsx(r.Item,{label:"库存",name:"num",rules:[{required:!0,message:"请输入库存!"}],children:e.jsx(h,{type:"number",style:{width:300},placeholder:"请输入库存",allowClear:!0})}),e.jsx(r.Item,{label:"活动时间",name:"started_at",rules:[{required:!0,message:"请输入活动时间!"}],children:e.jsx(B,{format:"YYYY-MM-DD HH:mm",showTime:!0,placeholder:["开始时间","结束时间"]})})]})}),e.jsx("div",{className:"bottom-menus",children:e.jsxs("div",{className:"bottom-menus-box",children:[e.jsx("div",{children:e.jsx(n,{loading:i,type:"primary",onClick:()=>a.submit(),children:"保存"})}),e.jsx("div",{className:"ml-24",children:e.jsx(n,{type:"default",onClick:()=>d(-1),children:"取消"})})]})})]})};export{he as default};
