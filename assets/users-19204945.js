import{f as z,u as F,r as a,t as K,j as e,I as M,B as N,d as W,m as g,E as O,M as q}from"./index-3fd54424.js";import{o as G,k as H,m as J}from"./topic-e7e1a389.js";import{B as Q}from"./index-c3c15456.js";import{P as _}from"./index-df05a090.js";import{U as V}from"./index-dd790b41.js";import{T as X}from"./Table-59a53b18.js";import"./LeftOutlined-a0f8cfa6.js";import"./member-4894e8dc.js";import"./index-ff4e3b6e.js";import"./useIcons-235bc0cd.js";import"./CheckOutlined-44e74bd9.js";import"./index-a9db941d.js";import"./addEventListener-1752243f.js";import"./Pagination-a2ebdf00.js";import"./useForceUpdate-56773729.js";import"./responsiveObserver-a0dea2e5.js";import"./index-a56efb1a.js";import"./iconUtil-14ff0944.js";const{confirm:Y}=q,xe=()=>{const c=new URLSearchParams(z().search),v=F(),[i,r]=a.useState(!1),[y,d]=a.useState([]),[u,n]=a.useState(1),[m,j]=a.useState(10),[k,b]=a.useState(0),[o,p]=a.useState(!1),[S,w]=a.useState(""),[D,h]=a.useState(!1),[f,x]=a.useState([]),[l,I]=a.useState(Number(c.get("id")));a.useEffect(()=>{document.title="付费学员",v(K("付费学员"))},[]),a.useEffect(()=>{I(Number(c.get("id")))},[c.get("id")]),a.useEffect(()=>{E()},[l,u,m,o]);const E=()=>{i||(r(!0),G({topic_id:l,page:u,size:m,user_id:S}).then(t=>{d(t.data.data.data),b(t.data.data.total),r(!1)}).catch(t=>{r(!1)}))},P=()=>{n(1),j(10),d([]),w(""),x([]),p(!o)},C=()=>{n(1),d([]),x([]),p(!o)},U={current:u,pageSize:m,total:k,onChange:(t,s)=>A(t,s),showSizeChanger:!0},A=(t,s)=>{n(t),j(s)},B=[{title:"ID",width:120,render:(t,s)=>e.jsx("span",{children:s.id})},{title:"学员ID",width:120,render:(t,s)=>e.jsx("span",{children:s.user_id})},{title:"学员",render:(t,s)=>e.jsxs(e.Fragment,{children:[s.user&&e.jsxs("div",{className:"user-item d-flex",children:[e.jsx("div",{className:"avatar",children:e.jsx("img",{src:s.user.avatar,width:"40",height:"40"})}),e.jsx("div",{className:"ml-10",children:s.user.nick_name})]}),!s.user&&e.jsx("span",{className:"c-red",children:"学员不存在"})]})},{title:"价格",width:150,render:(t,s)=>e.jsxs("span",{children:[s.charge,"元"]})},{title:"时间",width:200,dataIndex:"updated_at",render:t=>e.jsx("span",{children:W(t)})}],R=()=>{if(f.length===0){g.error("请选择需要操作的数据");return}Y({title:"操作确认",icon:e.jsx(O,{}),content:"确认删除选中的学员？",centered:!0,okText:"确认",cancelText:"取消",onOk(){i||(r(!0),H({topic_id:l,ids:f.join(",")}).then(()=>{r(!1),g.success("成功"),C()}).catch(t=>{r(!1)}))},onCancel(){console.log("Cancel")}})},T={selectedRowKeys:f,onChange:(t,s)=>{x(t)}},L=t=>{i||(r(!0),J({topic_id:l,ids:t}).then(()=>{r(!1),g.success("成功"),h(!1),C()}).catch(s=>{r(!1)}))};return e.jsxs("div",{className:"meedu-main-body",children:[e.jsx(Q,{title:"付费学员"}),e.jsxs("div",{className:"float-left j-b-flex mb-30 mt-30",children:[e.jsxs("div",{className:"d-flex",children:[e.jsx(_,{type:"primary",text:"添加学员",class:"",icon:null,p:"addons.meedu_topics.orders.user.add",onClick:()=>h(!0),disabled:null}),e.jsx(_,{type:"danger",text:"删除学员",class:"ml-10",icon:null,p:"addons.meedu_topics.orders.user.del",onClick:()=>R(),disabled:null})]}),e.jsxs("div",{className:"d-flex",children:[e.jsx(M,{value:S,onChange:t=>{w(t.target.value)},allowClear:!0,style:{width:150},placeholder:"学员ID"}),e.jsx(N,{className:"ml-10",onClick:P,children:"清空"}),e.jsx(N,{className:"ml-10",type:"primary",onClick:()=>{n(1),p(!o)},children:"筛选"})]})]}),e.jsx("div",{className:"float-left",children:e.jsx(X,{rowSelection:{type:"checkbox",...T},loading:i,columns:B,dataSource:y,rowKey:t=>t.id,pagination:U})}),e.jsx(V,{type:"",open:D,onCancel:()=>h(!1),onSuccess:t=>{L(t)}})]})};export{xe as default};
