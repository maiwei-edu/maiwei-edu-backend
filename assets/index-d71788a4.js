import{u as F,b as P,r as a,t as z,j as e,I as B,B as j,d as f,S as D,E as I,m as L,M as K}from"./index-3fd54424.js";import{l as R,d as A}from"./miaosha-30265f4e.js";import{P as n}from"./index-df05a090.js";import{T as y}from"./index-04a133fc.js";import{T as O}from"./Table-59a53b18.js";import"./addEventListener-1752243f.js";import"./useIcons-235bc0cd.js";import"./CheckOutlined-44e74bd9.js";import"./Pagination-a2ebdf00.js";import"./LeftOutlined-a0f8cfa6.js";import"./useForceUpdate-56773729.js";import"./responsiveObserver-a0dea2e5.js";import"./index-ff4e3b6e.js";import"./index-a56efb1a.js";import"./iconUtil-14ff0944.js";const{confirm:$}=K,ie=()=>{const v=F(),d=P(),[r,i]=a.useState(!1),[S,c]=a.useState([]),[h,o]=a.useState(1),[m,p]=a.useState(10),[_,b]=a.useState(0),[l,u]=a.useState(!1),[x,g]=a.useState("");a.useEffect(()=>{document.title="秒杀活动",v(z("秒杀活动"))},[]),a.useEffect(()=>{k()},[h,m,l]);const k=()=>{r||(i(!0),R({page:h,size:m,keywords:x}).then(s=>{c(s.data.data.data),b(s.data.data.total),i(!1)}).catch(s=>{i(!1)}))},C=()=>{o(1),p(10),c([]),g(""),u(!l)},w={current:h,pageSize:m,total:_,onChange:(s,t)=>N(s,t),showSizeChanger:!0},N=(s,t)=>{o(s),p(t)},M=[{title:"类型",dataIndex:"goods_type_text",render:s=>e.jsx("span",{children:s})},{title:"商品名称",width:400,render:(s,t)=>e.jsxs(e.Fragment,{children:[t.goods_type==="book"&&e.jsx(y,{value:t.goods_thumb,width:90,height:120,title:t.goods_title,border:4}),t.goods_type!=="book"&&e.jsx(y,{value:t.goods_thumb,width:120,height:90,title:t.goods_title,border:4})]})},{title:"价格",width:150,render:(s,t)=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["秒杀价：",t.charge,"元"]}),e.jsxs("div",{className:"ori-charge",children:["原价：",t.original_charge,"元"]})]})},{title:"库存",width:120,render:(s,t)=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"c-red",children:["剩余：",t.over_num,"件"]}),e.jsxs("div",{children:["总量：",t.num,"件"]})]})},{title:"时间",width:200,render:(s,t)=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["开始:",f(t.started_at)]}),e.jsxs("div",{children:["结束:",f(t.end_at)]})]})},{title:"操作",width:140,render:(s,t)=>e.jsxs(D,{children:[e.jsx(n,{type:"link",text:"订单",class:"c-primary",icon:null,p:"addons.MiaoSha.orders",onClick:()=>{d("/miaosha/orders/index?id="+t.id)},disabled:null}),e.jsx(n,{type:"link",text:"编辑",class:"c-primary",icon:null,p:"addons.MiaoSha.goods.update",onClick:()=>{d("/miaosha/goods/update?id="+t.id)},disabled:null}),e.jsx(n,{type:"link",text:"删除",class:"c-red",icon:null,p:"addons.MiaoSha.goods.delete",onClick:()=>{T(t.id)},disabled:null})]})}],T=s=>{s!==0&&$({title:"操作确认",icon:e.jsx(I,{}),content:"确认删除此活动？",centered:!0,okText:"确认",cancelText:"取消",onOk(){r||(i(!0),A(s).then(()=>{i(!1),L.success("删除成功"),E()}).catch(t=>{i(!1)}))},onCancel(){console.log("Cancel")}})},E=()=>{o(1),c([]),u(!l)};return e.jsxs("div",{className:"meedu-main-body",children:[e.jsxs("div",{className:"float-left j-b-flex mb-30",children:[e.jsx("div",{className:"d-flex",children:e.jsx(n,{type:"primary",text:"新建秒杀",class:"",icon:null,p:"addons.MiaoSha.goods.store",onClick:()=>d("/miaosha/goods/create"),disabled:null})}),e.jsxs("div",{className:"d-flex",children:[e.jsx(B,{value:x,onChange:s=>{g(s.target.value)},allowClear:!0,style:{width:150},placeholder:"商品名称关键字"}),e.jsx(j,{className:"ml-10",onClick:C,children:"清空"}),e.jsx(j,{className:"ml-10",type:"primary",onClick:()=>{o(1),u(!l)},children:"筛选"})]})]}),e.jsx("div",{className:"float-left",children:e.jsx(O,{loading:r,columns:M,dataSource:S,rowKey:s=>s.id,pagination:w})})]})};export{ie as default};
