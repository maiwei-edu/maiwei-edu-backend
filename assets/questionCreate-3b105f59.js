import{f as V,u as W,r as a,t as X,j as t,B as x,m as E,E as Y,M as Z}from"./index-3fd54424.js";import{o as $,p as ee}from"./practice-c882748e.js";import{B as te}from"./index-c3c15456.js";import{Q as se}from"./index-5ce7603a.js";import{S}from"./index-ff4e3b6e.js";import{T as ae}from"./Table-59a53b18.js";import"./LeftOutlined-a0f8cfa6.js";import"./useIcons-235bc0cd.js";import"./CheckOutlined-44e74bd9.js";import"./addEventListener-1752243f.js";import"./Pagination-a2ebdf00.js";import"./useForceUpdate-56773729.js";import"./responsiveObserver-a0dea2e5.js";import"./index-a56efb1a.js";import"./iconUtil-14ff0944.js";const{confirm:oe}=Z,je=()=>{const r=new URLSearchParams(V().search),R=W(),[c,l]=a.useState(!1),[T,d]=a.useState([]),[u,m]=a.useState(1),[p,y]=a.useState(20),[_,P]=a.useState(0),[i,h]=a.useState(!1),[g,B]=a.useState(Number(r.get("id"))),[f,j]=a.useState([]),[C,v]=a.useState([]),[q,z]=a.useState([]),[w,b]=a.useState([]),[D,K]=a.useState([]),[L,N]=a.useState([]),[M,Q]=a.useState([]);a.useEffect(()=>{document.title="添加章节组卷",R(X("添加章节组卷"))},[]),a.useEffect(()=>{B(Number(r.get("id")))},[r.get("id")]),a.useEffect(()=>{I()},[g,u,p,i]);const I=()=>{c||(l(!0),$(g,{page:u,size:p,category_id:C,type:w,level:L}).then(e=>{d(e.data.data.data),P(e.data.data.total);let s=[];e.data.categories.length>0&&e.data.categories.map(o=>{s.push({label:o.name,value:o.id})}),z(s);let n=[];e.data.types.length>0&&e.data.types.map(o=>{n.push({label:o.name,value:o.id})}),K(n);let k=[];e.data.levels.length>0&&e.data.levels.map(o=>{k.push({label:o.name,value:o.id})}),Q(k),l(!1)}).catch(e=>{l(!1)}))},A=()=>{m(1),y(20),d([]),b([]),v([]),N([]),h(!i)},F=()=>{d([]),j([]),h(!i)},O=[{title:"分类",width:200,render:(e,s)=>{var n;return t.jsx("span",{children:((n=s==null?void 0:s.category)==null?void 0:n.name)||"-"})}},{title:"类型",width:120,render:(e,s)=>t.jsx("span",{children:s.type_text})},{title:"难度",width:120,render:(e,s)=>t.jsx("span",{children:s.level_text})},{title:"内容",render:(e,s)=>t.jsx(se,{question:s})}],U={selectedRowKeys:f,onChange:(e,s)=>{j(e)}},G=()=>{if(f.length===0){E.error("请选择需要操作的数据");return}oe({title:"操作确认",icon:t.jsx(Y,{}),content:"确认添加选中试题？",centered:!0,okText:"确认添加",cancelText:"取消",onOk(){c||(l(!0),ee(g,{qids:f}).then(e=>{E.success(e.message),F(),l(!1)}).catch(e=>{l(!1)}))},onCancel(){console.log("Cancel")}})},H={current:u,pageSize:p,total:_,onChange:(e,s)=>J(e,s),showSizeChanger:!0},J=(e,s)=>{m(e),y(s)};return t.jsxs("div",{className:"meedu-main-body",children:[t.jsx(te,{title:"添加章节组卷"}),t.jsxs("div",{className:"float-left j-b-flex mb-30 mt-30",children:[t.jsx("div",{className:"d-flex",children:t.jsx(x,{type:"primary",onClick:()=>G(),children:"批量添加"})}),t.jsxs("div",{className:"d-flex",children:[t.jsx(S,{style:{width:150},value:C,onChange:e=>{v(e)},allowClear:!0,placeholder:"分类",options:q}),t.jsx(S,{style:{width:150,marginLeft:10},value:w,onChange:e=>{b(e)},allowClear:!0,placeholder:"类型",options:D}),t.jsx(S,{style:{width:150,marginLeft:10},value:L,onChange:e=>{N(e)},allowClear:!0,placeholder:"难度",options:M}),t.jsx(x,{className:"ml-10",onClick:A,children:"清空"}),t.jsx(x,{className:"ml-10",type:"primary",onClick:()=>{m(1),h(!i)},children:"筛选"})]})]}),t.jsx("div",{className:"float-left",children:t.jsx(ae,{rowSelection:{type:"checkbox",...U},loading:c,columns:O,dataSource:T,rowKey:e=>e.id,pagination:H})})]})};export{je as default};
