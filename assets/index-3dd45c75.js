import{u as A,b as M,f as K,r as i,a as I,t as O,j as e,m as f,E as U,d as V,S as j,D as q,B as G,e as H,M as J}from"./index-3fd54424.js";import{z as Q,A as W}from"./course-c58bd7af.js";import{D as X}from"./index-423292da.js";import{B as Y}from"./index-c3c15456.js";import{P as r}from"./index-df05a090.js";import{T as Z}from"./Table-59a53b18.js";import"./LeftOutlined-a0f8cfa6.js";import"./addEventListener-1752243f.js";import"./useIcons-235bc0cd.js";import"./CheckOutlined-44e74bd9.js";import"./Pagination-a2ebdf00.js";import"./useForceUpdate-56773729.js";import"./responsiveObserver-a0dea2e5.js";import"./index-ff4e3b6e.js";import"./index-a56efb1a.js";import"./iconUtil-14ff0944.js";const{confirm:$}=J,ge=()=>{const v=A(),l=M(),o=new URLSearchParams(K().search),[c,n]=i.useState(!1),[y,m]=i.useState([]),[d,h]=i.useState(1),[u,S]=i.useState(100),[b,w]=i.useState(0),[x,_]=i.useState(!1),[p,g]=i.useState([]),[a,C]=i.useState(Number(o.get("course_id"))),[k,D]=i.useState(String(o.get("title")));I(t=>t.enabledAddonsConfig.value.enabledAddons),i.useEffect(()=>{document.title="课时管理",v(O("课时管理"))},[]),i.useEffect(()=>{C(Number(o.get("course_id"))),D(String(o.get("title")))},[o.get("course_id"),o.get("title")]),i.useEffect(()=>{N()},[a,d,u,x]);const N=()=>{c||(n(!0),Q({page:d,size:u,sort:"published_at",order:"asc",cid:a}).then(t=>{m(t.data.videos.data),w(t.data.videos.total),n(!1)}).catch(t=>{n(!1)}))},E=()=>{if(p.length===0){f.error("请选择需要操作的数据");return}$({title:"操作确认",icon:e.jsx(U,{}),content:"确认删除选中的课时？",centered:!0,okText:"确认",cancelText:"取消",onOk(){c||(n(!0),W({ids:p}).then(()=>{n(!1),f.success("成功"),P()}).catch(t=>{n(!1)}))},onCancel(){console.log("Cancel")}})},P=()=>{h(1),m([]),g([]),_(!x)},T={current:d,pageSize:u,total:b,onChange:(t,s)=>z(t,s),showSizeChanger:!0},z=(t,s)=>{h(t),S(s)},B=[{title:"ID",width:"6%",render:(t,s)=>e.jsx("span",{children:s.id})},{title:"课时",width:"38%",render:(t,s)=>e.jsxs(e.Fragment,{children:[s.chapter&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:s.chapter.title}),e.jsx("span",{className:"mx-5",children:"/"})]}),e.jsx("span",{children:s.title})]})},{title:"课时时长",width:"15%",render:(t,s)=>e.jsx(X,{duration:s.duration})},{title:"上架时间",width:"16%",dataIndex:"published_at",render:t=>e.jsx("span",{children:V(t)})},{title:"是否显示",width:"8%",render:(t,s)=>e.jsxs(e.Fragment,{children:[s.is_show===1&&e.jsx("span",{className:"c-green",children:"· 显示"}),s.is_show!==1&&e.jsx("span",{className:"c-red",children:"· 隐藏"})]})},{title:"操作",width:"14%",fixed:"right",render:(t,s)=>{const F=[{key:"1",label:e.jsx(r,{type:"link",text:"单独订阅",class:"c-primary",icon:null,p:"video.subscribes",onClick:()=>{l("/course/vod/video/subscribe?course_id="+a+"&video_id="+s.id)},disabled:null})}];return e.jsxs(j,{children:[e.jsx(r,{type:"link",text:"学员",class:"c-primary",icon:null,p:"video.watch.records",onClick:()=>{l("/course/vod/video/watch-records?course_id="+a+"&id="+s.id)},disabled:null}),e.jsx(r,{type:"link",text:"编辑",class:"c-primary",icon:null,p:"video.update",onClick:()=>{l("/course/vod/video/update?course_id="+a+"&id="+s.id)},disabled:null}),e.jsx(q,{menu:{items:F},children:e.jsx(G,{type:"link",className:"c-primary",onClick:L=>L.preventDefault(),children:e.jsxs(j,{size:"small",align:"center",children:["更多",e.jsx(H,{})]})})})]})}}],R={selectedRowKeys:p,onChange:(t,s)=>{g(t)}};return e.jsxs("div",{className:"meedu-main-body",children:[e.jsx(Y,{title:k}),e.jsxs("div",{className:"float-left mt-30",children:[e.jsx(r,{type:"primary",text:"新建课时",class:"",icon:null,p:"video.store",onClick:()=>l("/course/vod/video/create?course_id="+a),disabled:null}),e.jsx(r,{type:"primary",text:"章节管理",class:"ml-10",icon:null,p:"course_chapter",onClick:()=>l("/course/vod/chapter/index?course_id="+a),disabled:null}),e.jsx(r,{type:"danger",text:"删除",class:"ml-10",icon:null,p:"video.destroy",onClick:()=>E(),disabled:null})]}),e.jsx("div",{className:"float-left mt-30",children:e.jsx(Z,{rowSelection:{type:"checkbox",...R},loading:c,columns:B,dataSource:y,rowKey:t=>t.id,pagination:T})})]})};export{ge as default};
