import{r as s,j as e,M as C,I as x,S as b,m as w,g as D,u as E,t as N,E as q}from"./index-b4683d61.js";import{b as T,e as _,f as L,g as U,h as V}from"./topic-842c58e2.js";import{B}from"./index-5f967da4.js";import{P as y}from"./index-573a6ce5.js";import{H as S}from"./index-133d6e1c.js";import{F as o}from"./index-d434f3eb.js";import{T as W}from"./Table-76e623b5.js";import"./LeftOutlined-9e6e73a2.js";import"./InfoCircleOutlined-4d24221b.js";import"./row-4ee18533.js";import"./responsiveObserver-dc429d3b.js";import"./addEventListener-a27ae3f4.js";import"./useIcons-e0af7133.js";import"./CheckOutlined-e6bc730e.js";import"./Pagination-d2c763c6.js";import"./useForceUpdate-f2aff5e0.js";import"./index-c09cc6d7.js";import"./index-10f1a096.js";import"./iconUtil-f3f90360.js";const A=t=>{const[a]=o.useForm(),[l,i]=s.useState(!1);s.useEffect(()=>{t.open&&a.setFieldsValue({name:"",sort:""})},[t.open]);const m=d=>{l||(i(!0),T(d).then(f=>{i(!1),w.success("成功！"),t.onSuccess()}).catch(f=>{i(!1)}))},c=d=>{console.log("Failed:",d)};return e.jsx(e.Fragment,{children:t.open?e.jsx(C,{title:"添加分类",onCancel:()=>{t.onCancel()},open:!0,width:800,maskClosable:!1,onOk:()=>{a.submit()},centered:!0,children:e.jsx("div",{className:"float-left mt-30",children:e.jsxs(o,{form:a,name:"live-category-create-dailog",labelCol:{span:3},wrapperCol:{span:21},initialValues:{remember:!0},onFinish:m,onFinishFailed:c,autoComplete:"off",children:[e.jsx(o.Item,{label:"分类名称",name:"name",rules:[{required:!0,message:"请输入分类名称!"}],children:e.jsx(x,{style:{width:300},placeholder:"请输入分类名称",allowClear:!0})}),e.jsx(o.Item,{label:"排序",name:"sort",rules:[{required:!0,message:"填输入排序!"}],children:e.jsxs(b,{align:"baseline",style:{height:32},children:[e.jsx(o.Item,{name:"sort",rules:[{required:!0,message:"填输入排序!"}],children:e.jsx(x,{type:"number",style:{width:300},placeholder:"填输入排序",allowClear:!0})}),e.jsx("div",{className:"ml-10",children:e.jsx(S,{text:"填写整数，数字越小排序越靠前"})})]})})]})})}):null})},O=t=>{const[a]=o.useForm(),[l,i]=s.useState(!0),[m,c]=s.useState(!1);s.useEffect(()=>{t.open&&(i(!0),a.setFieldsValue({name:"",sort:""})),t.id>0&&d()},[t.open,t.id]);const d=async()=>{await f(),i(!1)},f=async()=>{const n=await _(t.id);a.setFieldsValue({name:n.data.name,sort:n.data.sort})},h=n=>{m||(c(!0),L(t.id,n).then(g=>{c(!1),w.success("成功！"),t.onSuccess()}).catch(g=>{c(!1)}))},p=n=>{console.log("Failed:",n)};return e.jsx(e.Fragment,{children:t.open?e.jsxs(C,{title:"编辑分类",onCancel:()=>{t.onCancel()},open:!0,width:800,maskClosable:!1,onOk:()=>{a.submit()},centered:!0,children:[l&&e.jsx("div",{className:"float-left text-center mt-30",children:e.jsx(D,{})}),e.jsx("div",{style:{display:l?"none":"block"},className:"float-left mt-30",children:e.jsxs(o,{form:a,name:"live-category-update-dailog",labelCol:{span:3},wrapperCol:{span:21},initialValues:{remember:!0},onFinish:h,onFinishFailed:p,autoComplete:"off",children:[e.jsx(o.Item,{label:"分类名称",name:"name",rules:[{required:!0,message:"请输入分类名称!"}],children:e.jsx(x,{style:{width:300},placeholder:"请输入分类名称",allowClear:!0})}),e.jsx(o.Item,{label:"排序",name:"sort",rules:[{required:!0,message:"填输入排序!"}],children:e.jsxs(b,{align:"baseline",style:{height:32},children:[e.jsx(o.Item,{name:"sort",rules:[{required:!0,message:"填输入排序!"}],children:e.jsx(x,{type:"number",style:{width:300},placeholder:"填输入排序",allowClear:!0})}),e.jsx("div",{className:"ml-10",children:e.jsx(S,{text:"填写整数，数字越小排序越靠前"})})]})})]})})]}):null})},{confirm:P}=C,oe=()=>{const t=E(),[a,l]=s.useState(!1),[i,m]=s.useState([]),[c,d]=s.useState(!1),[f,h]=s.useState(!1),[p,n]=s.useState(!1),[g,F]=s.useState(0);s.useEffect(()=>{document.title="图文分类管理",t(N("图文分类管理"))},[]),s.useEffect(()=>{k()},[c]);const k=()=>{a||(l(!0),U({}).then(r=>{m(r.data),l(!1)}).catch(r=>{l(!1)}))},I=[{title:"排序",width:150,render:(r,u)=>e.jsx("span",{children:u.sort})},{title:"分类名",render:(r,u)=>e.jsxs("span",{children:[u.name," "]})},{title:"操作",width:160,fixed:"right",render:(r,u)=>e.jsxs(b,{children:[e.jsx(y,{type:"link",text:"编辑",class:"c-primary",icon:null,p:"addons.meedu_topics.category.update",onClick:()=>{F(u.id),n(!0)},disabled:null}),e.jsx(y,{type:"link",text:"删除",class:"c-red",icon:null,p:"addons.meedu_topics.category.delete",onClick:()=>{v(u.id)},disabled:null})]})}],j=()=>{m([]),d(!c)},v=r=>{r!==0&&P({title:"操作确认",icon:e.jsx(q,{}),content:"确认删除此分类？",centered:!0,okText:"确认",cancelText:"取消",onOk(){a||(l(!0),V(r).then(()=>{l(!1),w.success("删除成功"),j()}).catch(u=>{l(!1)}))},onCancel(){console.log("Cancel")}})};return e.jsxs("div",{className:"meedu-main-body",children:[e.jsx(B,{title:"图文分类管理"}),e.jsx(A,{open:f,onCancel:()=>h(!1),onSuccess:()=>{j(),h(!1)}}),e.jsx(O,{id:g,open:p,onCancel:()=>n(!1),onSuccess:()=>{j(),n(!1)}}),e.jsx("div",{className:"float-left  mt-30 mb-30",children:e.jsx(y,{type:"primary",text:"添加分类",class:"",icon:null,p:"addons.meedu_topics.category.store",onClick:()=>h(!0),disabled:null})}),e.jsx("div",{className:"float-left",children:e.jsx(W,{loading:a,columns:I,dataSource:i,rowKey:r=>r.id,pagination:!1})})]})};export{oe as default};
