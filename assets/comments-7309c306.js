import{u as A,r as a,t as F,j as t,B as g,m as S,E as Y,d as K,h as U,M as H}from"./index-b4683d61.js";import{i as O,j as q}from"./course-7dc1c12e.js";import{B as G}from"./index-5f967da4.js";import{P as J}from"./index-573a6ce5.js";import{T as Q}from"./Table-76e623b5.js";import{D as V}from"./index-cc7d88a3.js";import"./LeftOutlined-9e6e73a2.js";import"./addEventListener-a27ae3f4.js";import"./useIcons-e0af7133.js";import"./CheckOutlined-e6bc730e.js";import"./Pagination-d2c763c6.js";import"./useForceUpdate-f2aff5e0.js";import"./responsiveObserver-dc429d3b.js";import"./index-c09cc6d7.js";import"./index-10f1a096.js";import"./iconUtil-f3f90360.js";const{confirm:W}=H,{RangePicker:X}=V,pe=()=>{const _=A(),[c,n]=a.useState(!1),[C,l]=a.useState([]),[d,r]=a.useState(1),[m,x]=a.useState(10),[v,w]=a.useState(0),[i,u]=a.useState(!1),[o,y]=a.useState({}),[k,N]=a.useState(""),[D,f]=a.useState([]),[P,j]=a.useState([]),[h,p]=a.useState([]);a.useEffect(()=>{document.title="课程评论",_(F("课程评论"))},[]),a.useEffect(()=>{b()},[d,m,i]);const b=()=>{c||(n(!0),O({page:d,size:m,user_id:k,course_id:null,created_at:D}).then(e=>{l(e.data.data.data),w(e.data.data.total),y(e.data.users),n(!1)}).catch(e=>{n(!1)}))},B=()=>{if(h.length===0){S.error("请选择需要操作的数据");return}W({title:"操作确认",icon:t.jsx(Y,{}),content:"确认删除选中的评论？",centered:!0,okText:"确认",cancelText:"取消",onOk(){c||(n(!0),q({ids:h}).then(()=>{n(!1),S.success("成功"),I()}).catch(e=>{n(!1)}))},onCancel(){console.log("Cancel")}})},E=()=>{r(1),x(10),l([]),p([]),N(""),j([]),f([]),u(!i)},I=()=>{r(1),l([]),p([]),u(!i)},L={current:d,pageSize:m,total:v,onChange:(e,s)=>M(e,s),showSizeChanger:!0},M=(e,s)=>{r(e),x(s)},R=[{title:"学员",width:240,render:(e,s)=>t.jsxs(t.Fragment,{children:[o[s.user_id]&&t.jsxs("div",{className:"user-item d-flex",children:[t.jsx("div",{className:"avatar",children:t.jsx("img",{src:o[s.user_id].avatar,width:"40",height:"40"})}),t.jsx("div",{className:"ml-10",children:o[s.user_id].nick_name})]}),!o[s.user_id]&&t.jsx("span",{className:"c-red",children:"学员不存在"})]})},{title:"课程",width:300,render:(e,s)=>t.jsx(t.Fragment,{children:s.course&&t.jsx("span",{children:s.course.title})})},{title:"内容",render:(e,s)=>t.jsx("div",{dangerouslySetInnerHTML:{__html:s.render_content}})},{title:"IP",width:150,dataIndex:"ip",render:e=>t.jsx("span",{children:e||"-"})},{title:"省份",width:150,dataIndex:"ip_province",render:e=>t.jsx("span",{children:e||"-"})},{title:"时间",width:200,dataIndex:"created_at",render:e=>t.jsx("span",{children:K(e)})}],T={selectedRowKeys:h,onChange:(e,s)=>{p(e)}},z=e=>e&&e>=U().add(0,"days");return t.jsxs("div",{className:"meedu-main-body",children:[t.jsx(G,{title:"课程评论"}),t.jsxs("div",{className:"float-left j-b-flex mb-30 mt-30",children:[t.jsx("div",{className:"d-flex",children:t.jsx(J,{type:"danger",text:"删除",class:"",icon:null,p:"course_comment.destroy",onClick:()=>B(),disabled:null})}),t.jsxs("div",{className:"d-flex",children:[t.jsx(X,{disabledDate:z,format:"YYYY-MM-DD",value:P,style:{marginLeft:10},onChange:(e,s)=>{s[1]+=" 23:59:59",f(s),j(e)},placeholder:["评论时间-开始","评论时间-结束"]}),t.jsx(g,{className:"ml-10",onClick:E,children:"清空"}),t.jsx(g,{className:"ml-10",type:"primary",onClick:()=>{r(1),u(!i)},children:"筛选"})]})]}),t.jsx("div",{className:"float-left",children:t.jsx(Q,{rowSelection:{type:"checkbox",...T},loading:c,columns:R,dataSource:C,rowKey:e=>e.id,pagination:L})})]})};export{pe as default};
